<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>calculus · moment_kinetics</title><meta name="title" content="calculus · moment_kinetics"/><meta property="og:title" content="calculus · moment_kinetics"/><meta property="twitter:title" content="calculus · moment_kinetics"/><meta name="description" content="Documentation for moment_kinetics."/><meta property="og:description" content="Documentation for moment_kinetics."/><meta property="twitter:description" content="Documentation for moment_kinetics."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">moment_kinetics</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../chebyshev/">Chebyshev tranform via Fourier transform</a></li><li><a class="tocitem" href="../constraints_on_normalized_distribution_function/">Constraints on normalized distribution function</a></li><li><a class="tocitem" href="../debugging-hints/">Debugging</a></li><li><a class="tocitem" href="../developing/">Developing</a></li><li><a class="tocitem" href="../external_sources_notes/">External sources</a></li><li><a class="tocitem" href="../fokker_planck_notes/">Fokker Planck collision operator</a></li><li><a class="tocitem" href="../geometry/">Magnetic Geometry</a></li><li><a class="tocitem" href="../getting_started/">Getting started</a></li><li><a class="tocitem" href="../input_options/">Input Options</a></li><li><a class="tocitem" href="../jacobian_matrices/">Jacobian matrix calculations</a></li><li><a class="tocitem" href="../known_issues/">Known Issues</a></li><li><a class="tocitem" href="../machine_setup_notes/"><code>machine_setup</code> notes</a></li><li><a class="tocitem" href="../manual_setup/">Manual setup</a></li><li><a class="tocitem" href="../manufactured_solution_test_examples/">List of Manufactured Solutions Test TOML inputs</a></li><li><a class="tocitem" href="../moment_kinetic_equations/">Moment kinetic equations</a></li><li><a class="tocitem" href="../moment_kinetic_equations_electrons/">Moment kinetic equations for electrons</a></li><li><a class="tocitem" href="../parameter_scans/">Parameter scans</a></li><li><a class="tocitem" href="../post_processing_notes/">Post processing</a></li><li><a class="tocitem" href="../shared_memory_debugging/">Shared memory debugging</a></li><li><a class="tocitem" href="../timestepping/">Timestepping</a></li><li><a class="tocitem" href="../wall_boundary_conditions/">Wall boundary conditions with moment constraints</a></li><li><a class="tocitem" href="../zz_MKJacobianUtils/"><code>MKJacobianUtils</code></a></li><li><a class="tocitem" href="../zz_advection/"><code>advection</code></a></li><li><a class="tocitem" href="../zz_alpha_advection/"><code>alpha_advection</code></a></li><li><a class="tocitem" href="../zz_analysis/"><code>analysis</code></a></li><li><a class="tocitem" href="../zz_array_allocation/"><code>array_allocation</code></a></li><li><a class="tocitem" href="../zz_bgk/"><code>bgk</code></a></li><li><a class="tocitem" href="../zz_boundary_conditions/"><code>boundary_conditions</code></a></li><li class="is-active"><a class="tocitem" href><code>calculus</code></a></li><li><a class="tocitem" href="../zz_charge_exchange/"><code>charge_exchange</code></a></li><li><a class="tocitem" href="../zz_chebyshev/"><code>chebyshev</code></a></li><li><a class="tocitem" href="../zz_clenshaw_curtis/"><code>clenshaw_curtis</code></a></li><li><a class="tocitem" href="../zz_collision_frequencies/"><code>collision_frequencies</code></a></li><li><a class="tocitem" href="../zz_command_line_options/"><code>command_line_options</code></a></li><li><a class="tocitem" href="../zz_communication/"><code>communication</code></a></li><li><a class="tocitem" href="../zz_constants/"><code>constants</code></a></li><li><a class="tocitem" href="../zz_continuity/"><code>continuity</code></a></li><li><a class="tocitem" href="../zz_coordinates/"><code>coordinates</code></a></li><li><a class="tocitem" href="../zz_debugging/"><code>debugging</code></a></li><li><a class="tocitem" href="../zz_derivatives/"><code>derivatives</code></a></li><li><a class="tocitem" href="../zz_electron_fluid_equations/"><code>electron_fluid_equations</code></a></li><li><a class="tocitem" href="../zz_electron_kinetic_equation/"><code>electron_kinetic_equation</code></a></li><li><a class="tocitem" href="../zz_electron_vpa_advection/"><code>electron_vpa_advection</code></a></li><li><a class="tocitem" href="../zz_electron_z_advection/"><code>electron_z_advection</code></a></li><li><a class="tocitem" href="../zz_em_fields/"><code>em_fields</code></a></li><li><a class="tocitem" href="../zz_energy_equation/"><code>energy_equation</code></a></li><li><a class="tocitem" href="../zz_external_sources/"><code>external_sources</code></a></li><li><a class="tocitem" href="../zz_file_io/"><code>file_io</code></a></li><li><a class="tocitem" href="../zz_finite_differences/"><code>finite_differences</code></a></li><li><a class="tocitem" href="../zz_fokker_planck/"><code>fokker_planck</code></a></li><li><a class="tocitem" href="../zz_fokker_planck_calculus/"><code>fokker_planck_calculus</code></a></li><li><a class="tocitem" href="../zz_fokker_planck_test/"><code>fokker_planck_test</code></a></li><li><a class="tocitem" href="../zz_force_balance/"><code>force_balance</code></a></li><li><a class="tocitem" href="../zz_fourier/"><code>fourier</code></a></li><li><a class="tocitem" href="../zz_gauss_legendre/"><code>gauss_legendre</code></a></li><li><a class="tocitem" href="../zz_geo/"><code>geo</code></a></li><li><a class="tocitem" href="../zz_gyroaverages/"><code>gyroaverages</code></a></li><li><a class="tocitem" href="../zz_initial_conditions/"><code>initial_conditions</code></a></li><li><a class="tocitem" href="../zz_input_structs/"><code>input_structs</code></a></li><li><a class="tocitem" href="../zz_interpolation/"><code>interpolation</code></a></li><li><a class="tocitem" href="../zz_ionization/"><code>ionization</code></a></li><li><a class="tocitem" href="../zz_jacobian_matrices/"><code>jacobian_matrices</code></a></li><li><a class="tocitem" href="../zz_krook_collisions/"><code>krook_collisions</code></a></li><li><a class="tocitem" href="../zz_lagrange_polynomials/"><code>lagrange_polynomials</code></a></li><li><a class="tocitem" href="../zz_load_data/"><code>load_data</code></a></li><li><a class="tocitem" href="../zz_loop_ranges_struct/"><code>loop_ranges_struct</code></a></li><li><a class="tocitem" href="../zz_looping/"><code>looping</code></a></li><li><a class="tocitem" href="../zz_makie_post_processing/"><code>makie_post_processing</code></a></li><li><a class="tocitem" href="../zz_manufactured_solns/"><code>manufactured_solns</code></a></li><li><a class="tocitem" href="../zz_maxwell_diffusion/"><code>maxwell_diffusion</code></a></li><li><a class="tocitem" href="../zz_moment_constraints/"><code>moment_constraints</code></a></li><li><a class="tocitem" href="../zz_moment_kinetics/"><code>moment_kinetics</code></a></li><li><a class="tocitem" href="../zz_moment_kinetics_input/"><code>moment_kinetics_input</code></a></li><li><a class="tocitem" href="../zz_moment_kinetics_structs/"><code>moment_kinetics_structs</code></a></li><li><a class="tocitem" href="../zz_neutral_r_advection/"><code>neutral_r_advection</code></a></li><li><a class="tocitem" href="../zz_neutral_vz_advection/"><code>neutral_vz_advection</code></a></li><li><a class="tocitem" href="../zz_neutral_z_advection/"><code>neutral_z_advection</code></a></li><li><a class="tocitem" href="../zz_nonlinear_solvers/"><code>nonlinear_solvers</code></a></li><li><a class="tocitem" href="../zz_numerical_dissipation/"><code>numerical_dissipation</code></a></li><li><a class="tocitem" href="../zz_plot_MMS_sequence/"><code>plot_MMS_sequence</code></a></li><li><a class="tocitem" href="../zz_plot_sequence/"><code>plot_sequence</code></a></li><li><a class="tocitem" href="../zz_plots_post_processing/"><code>plots_post_processing</code></a></li><li><a class="tocitem" href="../zz_quadrature/"><code>quadrature</code></a></li><li><a class="tocitem" href="../zz_r_advection/"><code>r_advection</code></a></li><li><a class="tocitem" href="../zz_reference_parameters/"><code>reference_parameters</code></a></li><li><a class="tocitem" href="../zz_runge_kutta/"><code>runge_kutta</code></a></li><li><a class="tocitem" href="../zz_source_terms/"><code>source_terms</code></a></li><li><a class="tocitem" href="../zz_species_input/"><code>species_input</code></a></li><li><a class="tocitem" href="../zz_time_advance/"><code>time_advance</code></a></li><li><a class="tocitem" href="../zz_timer_utils/"><code>timer_utils</code></a></li><li><a class="tocitem" href="../zz_type_definitions/"><code>type_definitions</code></a></li><li><a class="tocitem" href="../zz_utils/"><code>utils</code></a></li><li><a class="tocitem" href="../zz_velocity_grid_transforms/"><code>velocity_grid_transforms</code></a></li><li><a class="tocitem" href="../zz_velocity_moments/"><code>velocity_moments</code></a></li><li><a class="tocitem" href="../zz_vpa_advection/"><code>vpa_advection</code></a></li><li><a class="tocitem" href="../zz_vperp_advection/"><code>vperp_advection</code></a></li><li><a class="tocitem" href="../zz_z_advection/"><code>z_advection</code></a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href><code>calculus</code></a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href><code>calculus</code></a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/mabarnes/moment_kinetics" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/mabarnes/moment_kinetics/blob/master/docs/src/zz_calculus.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="calculus"><a class="docs-heading-anchor" href="#calculus"><code>calculus</code></a><a id="calculus-1"></a><a class="docs-heading-anchor-permalink" href="#calculus" title="Permalink"></a></h1><article><details class="docstring" open="true"><summary id="moment_kinetics.calculus"><a class="docstring-binding" href="#moment_kinetics.calculus"><code>moment_kinetics.calculus</code></a> — <span class="docstring-category">Module</span></summary><section><div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/e1bf9b5d71c35dec3ae5701eb7155272d19740ec/moment_kinetics/src/calculus.jl#L1">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.calculus.assign_endpoint!-Union{Tuple{Mdims}, Tuple{Ndims}, Tuple{AbstractArray{Float64, Ndims}, AbstractArray{Float64, Mdims}, String, Any}} where {Ndims, Mdims}"><a class="docstring-binding" href="#moment_kinetics.calculus.assign_endpoint!-Union{Tuple{Mdims}, Tuple{Ndims}, Tuple{AbstractArray{Float64, Ndims}, AbstractArray{Float64, Mdims}, String, Any}} where {Ndims, Mdims}"><code>moment_kinetics.calculus.assign_endpoint!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>extension of the above function to distributed memory MPI function allows for arbitray array sizes ONLY IF the if statements doing the final endpoint assignments are updated to include each physical dimension required in the main code</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/e1bf9b5d71c35dec3ae5701eb7155272d19740ec/moment_kinetics/src/calculus.jl#L485-L491">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.calculus.derivative!-NTuple{4, Any}"><a class="docstring-binding" href="#moment_kinetics.calculus.derivative!-NTuple{4, Any}"><code>moment_kinetics.calculus.derivative!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">derivative!(df, f, coord, spectral)</code></pre><p>Non-upwinding derivative.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/e1bf9b5d71c35dec3ae5701eb7155272d19740ec/moment_kinetics/src/calculus.jl#L109-L113">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.calculus.derivative!-Tuple{Any, Any, Any, Any, moment_kinetics.moment_kinetics_structs.discretization_info}"><a class="docstring-binding" href="#moment_kinetics.calculus.derivative!-Tuple{Any, Any, Any, Any, moment_kinetics.moment_kinetics_structs.discretization_info}"><code>moment_kinetics.calculus.derivative!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">derivative!(df, f, coord, speed, spectral)</code></pre><p>Upwinding derivative.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/e1bf9b5d71c35dec3ae5701eb7155272d19740ec/moment_kinetics/src/calculus.jl#L95-L99">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.calculus.derivative_elements_to_full_grid!-Tuple{Any, Any, Any, AbstractVector{Float64}}"><a class="docstring-binding" href="#moment_kinetics.calculus.derivative_elements_to_full_grid!-Tuple{Any, Any, Any, AbstractVector{Float64}}"><code>moment_kinetics.calculus.derivative_elements_to_full_grid!</code></a> — <span class="docstring-category">Method</span></summary><section><div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/e1bf9b5d71c35dec3ae5701eb7155272d19740ec/moment_kinetics/src/calculus.jl#L337">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.calculus.derivative_elements_to_full_grid!-Tuple{Any, Any, Any}"><a class="docstring-binding" href="#moment_kinetics.calculus.derivative_elements_to_full_grid!-Tuple{Any, Any, Any}"><code>moment_kinetics.calculus.derivative_elements_to_full_grid!</code></a> — <span class="docstring-category">Method</span></summary><section><div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/e1bf9b5d71c35dec3ae5701eb7155272d19740ec/moment_kinetics/src/calculus.jl#L348">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.calculus.elements_to_full_grid_interior_pts!-Tuple{Any, Any, Any}"><a class="docstring-binding" href="#moment_kinetics.calculus.elements_to_full_grid_interior_pts!-Tuple{Any, Any, Any}"><code>moment_kinetics.calculus.elements_to_full_grid_interior_pts!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>maps the derivative at points away from element boundaries from the grid/element representation to the full grid representation</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/e1bf9b5d71c35dec3ae5701eb7155272d19740ec/moment_kinetics/src/calculus.jl#L359-L362">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.calculus.elementwise_derivative!"><a class="docstring-binding" href="#moment_kinetics.calculus.elementwise_derivative!"><code>moment_kinetics.calculus.elementwise_derivative!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">elementwise_derivative!(coord, f, speed, spectral)
elementwise_derivative!(coord, f, spectral)</code></pre><p>Generic function for element-by-element derivatives</p><p>First signature, with <code>speed</code>, calculates an upwind derivative, the second signature calculates a derivative without upwinding information.</p><p>Result is stored in coord.scratch_2d.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/e1bf9b5d71c35dec3ae5701eb7155272d19740ec/moment_kinetics/src/calculus.jl#L27-L37">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.calculus.elementwise_indefinite_integration!"><a class="docstring-binding" href="#moment_kinetics.calculus.elementwise_indefinite_integration!"><code>moment_kinetics.calculus.elementwise_indefinite_integration!</code></a> — <span class="docstring-category">Function</span></summary><section><div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/e1bf9b5d71c35dec3ae5701eb7155272d19740ec/moment_kinetics/src/calculus.jl#L46">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.calculus.elementwise_indefinite_integration!-Tuple{Any, Any, moment_kinetics.moment_kinetics_structs.discretization_info}"><a class="docstring-binding" href="#moment_kinetics.calculus.elementwise_indefinite_integration!-Tuple{Any, Any, moment_kinetics.moment_kinetics_structs.discretization_info}"><code>moment_kinetics.calculus.elementwise_indefinite_integration!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>A function that takes the indefinite integral in each element of <code>coord.grid</code>, leaving the result (element-wise) in <code>coord.scratch_2d</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/e1bf9b5d71c35dec3ae5701eb7155272d19740ec/moment_kinetics/src/calculus.jl#L1604-L1607">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.calculus.indefinite_integral!-Tuple{Any, Any, Any, moment_kinetics.moment_kinetics_structs.discretization_info}"><a class="docstring-binding" href="#moment_kinetics.calculus.indefinite_integral!-Tuple{Any, Any, Any, moment_kinetics.moment_kinetics_structs.discretization_info}"><code>moment_kinetics.calculus.indefinite_integral!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">indefinite_integral!(pf, f, coord, spectral)</code></pre><p>Indefinite line integral. </p><p>This function is designed to work on local-in-memory data only, with distributed-memory MPI not implemented here. A function which integrates along a line which is distributed in memory exists in <a href="../zz_em_fields/#moment_kinetics.em_fields"><code>moment_kinetics.em_fields</code></a> as  <code>calculate_phi_from_Epar!()</code>. The distributed-memory functionality could be ported to a generic function, similiar to how the derivative! functions are generalised in <a href="../zz_derivatives/#moment_kinetics.derivatives"><code>moment_kinetics.derivatives</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/e1bf9b5d71c35dec3ae5701eb7155272d19740ec/moment_kinetics/src/calculus.jl#L50-L62">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.calculus.indefinite_integral_elements_to_full_grid!-Tuple{Any, Any}"><a class="docstring-binding" href="#moment_kinetics.calculus.indefinite_integral_elements_to_full_grid!-Tuple{Any, Any}"><code>moment_kinetics.calculus.indefinite_integral_elements_to_full_grid!</code></a> — <span class="docstring-category">Method</span></summary><section><div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/e1bf9b5d71c35dec3ae5701eb7155272d19740ec/moment_kinetics/src/calculus.jl#L74">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.calculus.integral-NTuple{10, Any}"><a class="docstring-binding" href="#moment_kinetics.calculus.integral-NTuple{10, Any}"><code>moment_kinetics.calculus.integral</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Computes the integral of the 3D integrand, using the input wgts</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/e1bf9b5d71c35dec3ae5701eb7155272d19740ec/moment_kinetics/src/calculus.jl#L1574-L1576">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.calculus.integral-NTuple{4, Any}"><a class="docstring-binding" href="#moment_kinetics.calculus.integral-NTuple{4, Any}"><code>moment_kinetics.calculus.integral</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Computes the integral of the integrand multiplied by v^n, using the input wgts</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/e1bf9b5d71c35dec3ae5701eb7155272d19740ec/moment_kinetics/src/calculus.jl#L1464-L1466">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.calculus.integral-NTuple{7, Any}"><a class="docstring-binding" href="#moment_kinetics.calculus.integral-NTuple{7, Any}"><code>moment_kinetics.calculus.integral</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Computes the integral of the 2D integrand, using the input wgts</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/e1bf9b5d71c35dec3ae5701eb7155272d19740ec/moment_kinetics/src/calculus.jl#L1545-L1547">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.calculus.integral-Tuple{Any, Any, Any}"><a class="docstring-binding" href="#moment_kinetics.calculus.integral-Tuple{Any, Any, Any}"><code>moment_kinetics.calculus.integral</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Computes the integral of the integrand multiplied by v, using the input wgts</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/e1bf9b5d71c35dec3ae5701eb7155272d19740ec/moment_kinetics/src/calculus.jl#L1447-L1449">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.calculus.integral-Tuple{Any, Any}"><a class="docstring-binding" href="#moment_kinetics.calculus.integral-Tuple{Any, Any}"><code>moment_kinetics.calculus.integral</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Computes the integral of the integrand, using the input wgts</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/e1bf9b5d71c35dec3ae5701eb7155272d19740ec/moment_kinetics/src/calculus.jl#L1431-L1433">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.calculus.integral-Tuple{Function, Any, Any, Any}"><a class="docstring-binding" href="#moment_kinetics.calculus.integral-Tuple{Function, Any, Any, Any}"><code>moment_kinetics.calculus.integral</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Compute the 2D integral <code>∫d^2vperp.dvpa prefactor(vperp,vpa)*integrand</code></p><p>In this variant <code>vperp</code> and <code>vpa</code> should be <code>coordinate</code> objects.</p><p>Note that vperp_wgts contains the extra factor of vperp required for the Jacobian.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/e1bf9b5d71c35dec3ae5701eb7155272d19740ec/moment_kinetics/src/calculus.jl#L1497-L1504">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.calculus.integral-Tuple{Function, Any, Any}"><a class="docstring-binding" href="#moment_kinetics.calculus.integral-Tuple{Function, Any, Any}"><code>moment_kinetics.calculus.integral</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Compute the 1D integral <code>∫dv prefactor(v)*integrand</code></p><p>In this variant <code>v</code> should be a <code>coordinate</code> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/e1bf9b5d71c35dec3ae5701eb7155272d19740ec/moment_kinetics/src/calculus.jl#L1481-L1485">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.calculus.integral-Tuple{Function, Vararg{Any, 4}}"><a class="docstring-binding" href="#moment_kinetics.calculus.integral-Tuple{Function, Vararg{Any, 4}}"><code>moment_kinetics.calculus.integral</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Compute the 3D integral <code>∫dvzeta.dvr.dvz prefactor(vzeta,vr,vz)*integrand</code></p><p>In this variant <code>vzeta</code>, <code>vr</code>, and <code>vz</code> should be <code>coordinate</code> objects.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/e1bf9b5d71c35dec3ae5701eb7155272d19740ec/moment_kinetics/src/calculus.jl#L1519-L1523">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.calculus.mass_matrix_solve!"><a class="docstring-binding" href="#moment_kinetics.calculus.mass_matrix_solve!"><code>moment_kinetics.calculus.mass_matrix_solve!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">mass_matrix_solve!(f, b, spectral::weak_discretization_info)</code></pre><p>Solve</p><p class="math-container">\[M.f = b\]</p><p>for <span>$a$</span>, where <span>$M$</span> is the mass matrix of a weak-form finite element method and <span>$b$</span> is an input.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/e1bf9b5d71c35dec3ae5701eb7155272d19740ec/moment_kinetics/src/calculus.jl#L267-L276">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.calculus.reconcile_element_boundaries_upwind!-Tuple{Any, Any, Any, AbstractVector{Float64}}"><a class="docstring-binding" href="#moment_kinetics.calculus.reconcile_element_boundaries_upwind!-Tuple{Any, Any, Any, AbstractVector{Float64}}"><code>moment_kinetics.calculus.reconcile_element_boundaries_upwind!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>if at the boundary point within the element, must carefully choose which value of df to use; this is because df is multi-valued at the overlapping point at the boundary between neighboring elements. here we choose to use the value of df from the upwind element.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/e1bf9b5d71c35dec3ae5701eb7155272d19740ec/moment_kinetics/src/calculus.jl#L381-L387">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../zz_boundary_conditions/">« <code>boundary_conditions</code></a><a class="docs-footer-nextpage" href="../zz_charge_exchange/"><code>charge_exchange</code> »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Tuesday 10 February 2026 11:18">Tuesday 10 February 2026</span>. Using Julia version 1.11.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
