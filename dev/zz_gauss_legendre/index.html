<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>gauss_legendre · moment_kinetics</title><meta name="title" content="gauss_legendre · moment_kinetics"/><meta property="og:title" content="gauss_legendre · moment_kinetics"/><meta property="twitter:title" content="gauss_legendre · moment_kinetics"/><meta name="description" content="Documentation for moment_kinetics."/><meta property="og:description" content="Documentation for moment_kinetics."/><meta property="twitter:description" content="Documentation for moment_kinetics."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">moment_kinetics</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../chebyshev/">Chebyshev tranform via Fourier transform</a></li><li><a class="tocitem" href="../constraints_on_normalized_distribution_function/">Constraints on normalized distribution function</a></li><li><a class="tocitem" href="../debugging-hints/">Debugging</a></li><li><a class="tocitem" href="../developing/">Developing</a></li><li><a class="tocitem" href="../external_sources_notes/">External sources</a></li><li><a class="tocitem" href="../fokker_planck_notes/">Fokker Planck collision operator</a></li><li><a class="tocitem" href="../geometry/">Magnetic Geometry</a></li><li><a class="tocitem" href="../getting_started/">Getting started</a></li><li><a class="tocitem" href="../input_options/">Input Options</a></li><li><a class="tocitem" href="../jacobian_matrices/">Jacobian matrix calculations</a></li><li><a class="tocitem" href="../known_issues/">Known Issues</a></li><li><a class="tocitem" href="../machine_setup_notes/"><code>machine_setup</code> notes</a></li><li><a class="tocitem" href="../manual_setup/">Manual setup</a></li><li><a class="tocitem" href="../manufactured_solution_test_examples/">List of Manufactured Solutions Test TOML inputs</a></li><li><a class="tocitem" href="../moment_kinetic_equations/">Moment kinetic equations</a></li><li><a class="tocitem" href="../moment_kinetic_equations_electrons/">Moment kinetic equations for electrons</a></li><li><a class="tocitem" href="../parameter_scans/">Parameter scans</a></li><li><a class="tocitem" href="../post_processing_notes/">Post processing</a></li><li><a class="tocitem" href="../shared_memory_debugging/">Shared memory debugging</a></li><li><a class="tocitem" href="../timestepping/">Timestepping</a></li><li><a class="tocitem" href="../wall_boundary_conditions/">Wall boundary conditions with moment constraints</a></li><li><a class="tocitem" href="../zz_MKJacobianUtils/"><code>MKJacobianUtils</code></a></li><li><a class="tocitem" href="../zz_advection/"><code>advection</code></a></li><li><a class="tocitem" href="../zz_alpha_advection/"><code>alpha_advection</code></a></li><li><a class="tocitem" href="../zz_analysis/"><code>analysis</code></a></li><li><a class="tocitem" href="../zz_array_allocation/"><code>array_allocation</code></a></li><li><a class="tocitem" href="../zz_bgk/"><code>bgk</code></a></li><li><a class="tocitem" href="../zz_boundary_conditions/"><code>boundary_conditions</code></a></li><li><a class="tocitem" href="../zz_calculus/"><code>calculus</code></a></li><li><a class="tocitem" href="../zz_charge_exchange/"><code>charge_exchange</code></a></li><li><a class="tocitem" href="../zz_chebyshev/"><code>chebyshev</code></a></li><li><a class="tocitem" href="../zz_clenshaw_curtis/"><code>clenshaw_curtis</code></a></li><li><a class="tocitem" href="../zz_collision_frequencies/"><code>collision_frequencies</code></a></li><li><a class="tocitem" href="../zz_command_line_options/"><code>command_line_options</code></a></li><li><a class="tocitem" href="../zz_communication/"><code>communication</code></a></li><li><a class="tocitem" href="../zz_constants/"><code>constants</code></a></li><li><a class="tocitem" href="../zz_continuity/"><code>continuity</code></a></li><li><a class="tocitem" href="../zz_coordinates/"><code>coordinates</code></a></li><li><a class="tocitem" href="../zz_debugging/"><code>debugging</code></a></li><li><a class="tocitem" href="../zz_derivatives/"><code>derivatives</code></a></li><li><a class="tocitem" href="../zz_electron_fluid_equations/"><code>electron_fluid_equations</code></a></li><li><a class="tocitem" href="../zz_electron_kinetic_equation/"><code>electron_kinetic_equation</code></a></li><li><a class="tocitem" href="../zz_electron_vpa_advection/"><code>electron_vpa_advection</code></a></li><li><a class="tocitem" href="../zz_electron_z_advection/"><code>electron_z_advection</code></a></li><li><a class="tocitem" href="../zz_em_fields/"><code>em_fields</code></a></li><li><a class="tocitem" href="../zz_energy_equation/"><code>energy_equation</code></a></li><li><a class="tocitem" href="../zz_external_sources/"><code>external_sources</code></a></li><li><a class="tocitem" href="../zz_file_io/"><code>file_io</code></a></li><li><a class="tocitem" href="../zz_finite_differences/"><code>finite_differences</code></a></li><li><a class="tocitem" href="../zz_fokker_planck/"><code>fokker_planck</code></a></li><li><a class="tocitem" href="../zz_fokker_planck_calculus/"><code>fokker_planck_calculus</code></a></li><li><a class="tocitem" href="../zz_fokker_planck_test/"><code>fokker_planck_test</code></a></li><li><a class="tocitem" href="../zz_force_balance/"><code>force_balance</code></a></li><li><a class="tocitem" href="../zz_fourier/"><code>fourier</code></a></li><li class="is-active"><a class="tocitem" href><code>gauss_legendre</code></a></li><li><a class="tocitem" href="../zz_geo/"><code>geo</code></a></li><li><a class="tocitem" href="../zz_gyroaverages/"><code>gyroaverages</code></a></li><li><a class="tocitem" href="../zz_initial_conditions/"><code>initial_conditions</code></a></li><li><a class="tocitem" href="../zz_input_structs/"><code>input_structs</code></a></li><li><a class="tocitem" href="../zz_interpolation/"><code>interpolation</code></a></li><li><a class="tocitem" href="../zz_ionization/"><code>ionization</code></a></li><li><a class="tocitem" href="../zz_jacobian_matrices/"><code>jacobian_matrices</code></a></li><li><a class="tocitem" href="../zz_krook_collisions/"><code>krook_collisions</code></a></li><li><a class="tocitem" href="../zz_lagrange_polynomials/"><code>lagrange_polynomials</code></a></li><li><a class="tocitem" href="../zz_load_data/"><code>load_data</code></a></li><li><a class="tocitem" href="../zz_loop_ranges_struct/"><code>loop_ranges_struct</code></a></li><li><a class="tocitem" href="../zz_looping/"><code>looping</code></a></li><li><a class="tocitem" href="../zz_makie_post_processing/"><code>makie_post_processing</code></a></li><li><a class="tocitem" href="../zz_manufactured_solns/"><code>manufactured_solns</code></a></li><li><a class="tocitem" href="../zz_maxwell_diffusion/"><code>maxwell_diffusion</code></a></li><li><a class="tocitem" href="../zz_moment_constraints/"><code>moment_constraints</code></a></li><li><a class="tocitem" href="../zz_moment_kinetics/"><code>moment_kinetics</code></a></li><li><a class="tocitem" href="../zz_moment_kinetics_input/"><code>moment_kinetics_input</code></a></li><li><a class="tocitem" href="../zz_moment_kinetics_structs/"><code>moment_kinetics_structs</code></a></li><li><a class="tocitem" href="../zz_neutral_r_advection/"><code>neutral_r_advection</code></a></li><li><a class="tocitem" href="../zz_neutral_vz_advection/"><code>neutral_vz_advection</code></a></li><li><a class="tocitem" href="../zz_neutral_z_advection/"><code>neutral_z_advection</code></a></li><li><a class="tocitem" href="../zz_nonlinear_solvers/"><code>nonlinear_solvers</code></a></li><li><a class="tocitem" href="../zz_numerical_dissipation/"><code>numerical_dissipation</code></a></li><li><a class="tocitem" href="../zz_plot_MMS_sequence/"><code>plot_MMS_sequence</code></a></li><li><a class="tocitem" href="../zz_plot_sequence/"><code>plot_sequence</code></a></li><li><a class="tocitem" href="../zz_plots_post_processing/"><code>plots_post_processing</code></a></li><li><a class="tocitem" href="../zz_quadrature/"><code>quadrature</code></a></li><li><a class="tocitem" href="../zz_r_advection/"><code>r_advection</code></a></li><li><a class="tocitem" href="../zz_reference_parameters/"><code>reference_parameters</code></a></li><li><a class="tocitem" href="../zz_runge_kutta/"><code>runge_kutta</code></a></li><li><a class="tocitem" href="../zz_source_terms/"><code>source_terms</code></a></li><li><a class="tocitem" href="../zz_species_input/"><code>species_input</code></a></li><li><a class="tocitem" href="../zz_time_advance/"><code>time_advance</code></a></li><li><a class="tocitem" href="../zz_timer_utils/"><code>timer_utils</code></a></li><li><a class="tocitem" href="../zz_type_definitions/"><code>type_definitions</code></a></li><li><a class="tocitem" href="../zz_utils/"><code>utils</code></a></li><li><a class="tocitem" href="../zz_velocity_grid_transforms/"><code>velocity_grid_transforms</code></a></li><li><a class="tocitem" href="../zz_velocity_moments/"><code>velocity_moments</code></a></li><li><a class="tocitem" href="../zz_vpa_advection/"><code>vpa_advection</code></a></li><li><a class="tocitem" href="../zz_vperp_advection/"><code>vperp_advection</code></a></li><li><a class="tocitem" href="../zz_z_advection/"><code>z_advection</code></a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href><code>gauss_legendre</code></a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href><code>gauss_legendre</code></a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/mabarnes/moment_kinetics" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/mabarnes/moment_kinetics/blob/master/docs/src/zz_gauss_legendre.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="gauss_legendre"><a class="docs-heading-anchor" href="#gauss_legendre"><code>gauss_legendre</code></a><a id="gauss_legendre-1"></a><a class="docs-heading-anchor-permalink" href="#gauss_legendre" title="Permalink"></a></h1><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre"><code>moment_kinetics.gauss_legendre</code></a> — <span class="docstring-category">Module</span></summary><section><div><p>module for Gauss-Legendre-Lobatto and Gauss-Legendre-Radau spectral element grids</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L1-L3">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.gausslegendre_base_info"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.gausslegendre_base_info"><code>moment_kinetics.gauss_legendre.gausslegendre_base_info</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>A struct for passing around elemental matrices on Gauss-Legendre points in 1D</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L43-L46">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.gausslegendre_info"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.gausslegendre_info"><code>moment_kinetics.gauss_legendre.gausslegendre_info</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>A struct for Gauss-Legendre arrays needed for global operations in 1D, contains the struct of elemental matrices for Lobatto and Radau points, as well as some assembled 1D global matrices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L96-L100">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.calculus.elementwise_derivative!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_info}"><a class="docstring-binding" href="#moment_kinetics.calculus.elementwise_derivative!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_info}"><code>moment_kinetics.calculus.elementwise_derivative!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>A function that takes the first derivative in each element of <code>coord.grid</code>, leaving the result (element-wise) in <code>coord.scratch_2d</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L347-L350">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.calculus.mass_matrix_solve!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_info}"><a class="docstring-binding" href="#moment_kinetics.calculus.mass_matrix_solve!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_info}"><code>moment_kinetics.calculus.mass_matrix_solve!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Function to carry out a 1D (global) mass matrix solve.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L470-L472">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.GaussLegendre_derivative_vector!-NTuple{5, Any}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.GaussLegendre_derivative_vector!-NTuple{5, Any}"><code>moment_kinetics.gauss_legendre.GaussLegendre_derivative_vector!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Gauss-Legendre derivative at arbitrary x values, for boundary condition on Radau points.     D0 – the vector     xj – the x location where the derivative is evaluated      ngrid – number of points in x     x – the grid from -1, 1 Note that D0 is not scaled to the physical grid with a scaling factor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L611-L618">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.GaussLegendre_weak_product_matrix!-Tuple{Array{Float64, 3}, Vararg{Any, 4}}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.GaussLegendre_weak_product_matrix!-Tuple{Array{Float64, 3}, Vararg{Any, 4}}"><code>moment_kinetics.gauss_legendre.GaussLegendre_weak_product_matrix!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Assign abitrary weak (nonlinear) inner product matrix <code>Q</code> on a 1D line with Jacobian equal to 1. matrix <code>Q</code> acts on two vectors <code>x1</code> and <code>x2</code> such that the quadratic form  <code>y = x1 * Q * x2</code> is also a vector. See documentation of corresponding function for linear inner product matrices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L823-L828">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.GaussLegendre_weak_product_matrix!-Tuple{Matrix{Float64}, Vararg{Any, 4}}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.GaussLegendre_weak_product_matrix!-Tuple{Matrix{Float64}, Vararg{Any, 4}}"><code>moment_kinetics.gauss_legendre.GaussLegendre_weak_product_matrix!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Assign abitrary weak inner product matrix <code>Q</code> on a 1D line with Jacobian equal to 1 matrix <code>Q</code> acts on a single vector <code>x</code> such that <code>y = Q * x</code> is also a vector.</p><p>We use a projection onto Gauss-Legendre polynomials to carry out the calculation in two steps (see, e.g, S. A. Teukolsky, Short note on the mass matrix for Gauss–Lobatto grid points, J. Comput. Phys. 283 (2015) 408–413. https://doi.org/10.1016/j.jcp.2014.12.012). First, we write the desired matrix elements in terms of Legendre polynomials</p><p class="math-container">\[   l_i(x) = \sum_j \frac{P_j(x)P_j(x_i)w_i}{\gamma_j}\]</p><p>with <span>$w_i$</span> the weights from an integration on the Gauss-Legendre-Lobatto (or Radau) points <span>$x_i$</span>, i.e., </p><p class="math-container">\[ \int^1_{-1} f(x) d x = \sum_{i} f(x_i)w_i,\]</p><p>and <span>$\gamma_j = \sum_k w_k P_j(x_k)P_j(x_k)$</span> the numerical inner-product. Then, a matrix element can be expressed in integrals over Legendre polynomials rather than Lagrange polynomials, i.e.,</p><p class="math-container">\[   M_{ij} = \int^1_{-1} l_i(x)l_j(x) d x = \sum_{mn} \frac{w_m P_m(x_i) w_n P_n(x_j)}{\gamma_m\gamma_n} \int^{1}_{-1} P_m(x)P_n(x) d x. \]</p><p>Defining </p><p class="math-container">\[  A_{mn} = \int^{1}_{-1} P_m(x)P_n(x) d x, \]</p><p>we can thus write</p><p class="math-container">\[   M_{ij} = \sum_{mn} \frac{w_m P_m(x_i) w_n P_n(x_j)}{\gamma_m\gamma_n} A_{mn}. \]</p><p>We can use a quadrature which yields exact results (to machine precision) to evaluate <span>$A_{mn}$</span> using fast library functions for the Legendre polynomials, and then carry out the sum <span>$\sum_{mn}$</span> to obtain exact results (to machine-precision). Here we use a Gauss-Legendre integration quadrature with exact results up to  polynomials with order <span>$k_{max} = 4N +1$</span>, with <span>$N=$</span><code>ngrid</code> and the highest order polynomial product that we integrate is <span>$P_{N-1}(x)P_{N-1}(x)x^2$</span>, which has order <span>$k=2N &lt; k_{max}$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L653-L690">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.Legendre_h_n-Tuple{Any}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.Legendre_h_n-Tuple{Any}"><code>moment_kinetics.gauss_legendre.Legendre_h_n</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Result of the inner product of Legendre polynomials of order k.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L644-L646">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.gausslobattolegendre_differentiation_matrix!-Tuple{Matrix{Float64}, Vector{Float64}, Int64}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.gausslobattolegendre_differentiation_matrix!-Tuple{Matrix{Float64}, Vector{Float64}, Int64}"><code>moment_kinetics.gauss_legendre.gausslobattolegendre_differentiation_matrix!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Formula for Gauss-Legendre-Lobatto differentiation matrix taken from p196 of Chpt <code>The Spectral Elemtent Method&#39; of</code>Computational Seismology&#39;. Heiner Igel First Edition. Published in 2017 by Oxford University Press. Or https://doc.nektar.info/tutorials/latest/fundamentals/differentiation/fundamentals-differentiationch2.html</p><pre><code class="nohighlight hljs">D -- differentiation matrix 
x -- Gauss-Legendre-Lobatto points in [-1,1]
ngrid -- number of points per element (incl. boundary points)</code></pre><p>Note that D has does not include a scaling factor</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L538-L548">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.gaussradaulegendre_differentiation_matrix!-Tuple{Matrix{Float64}, Vector{Float64}, Int64}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.gaussradaulegendre_differentiation_matrix!-Tuple{Matrix{Float64}, Vector{Float64}, Int64}"><code>moment_kinetics.gauss_legendre.gaussradaulegendre_differentiation_matrix!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Formula for Gauss-Legendre-Radau differentiation matrix taken from https://doc.nektar.info/tutorials/latest/fundamentals/differentiation/fundamentals-differentiationch2.html</p><pre><code class="nohighlight hljs">D -- differentiation matrix 
x -- Gauss-Legendre-Radau points in [-1,1)
ngrid -- number of points per element (incl. boundary points)</code></pre><p>Note that D has does not include a scaling factor</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L571-L580">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.get_KJ_local!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.get_KJ_local!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any}"><code>moment_kinetics.gauss_legendre.get_KJ_local!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>If called for <code>coord.name = vperp</code> elemental matrix <code>KJ</code> on the <span>$i^{th}$</span> element is</p><p class="math-container">\[ (KJ)_{jk} = -\int^{v_\perp^U}_{v_\perp^L} \frac{\partial\varphi_j(v_\perp)}{\partial v_\perp}\frac{\partial\varphi_k(v_\perp)}{\partial v_\perp} v_\perp^2 d v_\perp
 = -\int^1_{-1} (c_i + x s_i)^2l_j^\prime(x)l_k^\prime(x) d x /s_i\]</p><p>with <span>$c_i$</span> and <span>$s_i$</span> the appropriate shift and scale factors, respectively.  Otherwise, if called for any other coordinate elemental matrix <code>KJ</code> is the same as <code>LL</code> (see <code>get_LL_local()!</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L1387-L1395">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.get_KK_local!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.get_KK_local!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any}"><code>moment_kinetics.gauss_legendre.get_KK_local!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>If called for <code>coord.name = vperp</code> elemental matrix <code>KK</code> on the <span>$i^{th}$</span> element is</p><p class="math-container">\[ K_{jk} = -\int^{v_\perp^U}_{v_\perp^L} \left(v_\perp \frac{\partial\varphi_j(v_\perp)}{\partial v_\perp} + \varphi_j(v_\perp) \right)
 \frac{\partial\varphi_k(v_\perp)}{\partial v_\perp} d v_\perp
 = -\int^1_{-1} ((c_i + x s_i)l_j^\prime(x) + l_j(x))l_k^\prime(x) d x /s_i\]</p><p>with <span>$c_i$</span> and <span>$s_i$</span> the appropriate shift and scale factors, respectively.  Otherwise, if called for any other coordinate elemental matrix <code>KK</code> is the same as <code>LL</code> (see <code>get_LL_local!()). If</code>explicit<em>BC</em>terms = true`, boundary terms arising from integration by parts are included at the extreme boundary points.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L1332-L1342">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.get_LL_local!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.get_LL_local!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any}"><code>moment_kinetics.gauss_legendre.get_LL_local!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>If called for <code>coord.name = vperp</code> elemental matrix <code>LL</code> on the <span>$i^{th}$</span> element is</p><p class="math-container">\[ L_{jk} = -\int^{v_\perp^U}_{v_\perp^L} \frac{\partial\varphi_j(v_\perp)}{\partial v_\perp}\frac{\partial\varphi_k(v_\perp)}{\partial v_\perp} v_\perp d v_\perp
 = -\int^1_{-1} (c_i + x s_i)l_j^\prime(x)l_k^\prime(x) d x /s_i\]</p><p>with <span>$c_i$</span> and <span>$s_i$</span> the appropriate shift and scale factors, respectively.  Otherwise, if called for any other coordinate elemental matrix <code>LL</code> is </p><p class="math-container">\[ L_{jk} = -\int^{v_\|^U}_{v_\|^L}  \frac{\partial\varphi_j(v_\|)}{\partial v_\|}\frac{\partial\varphi_k(v_\|)}{\partial v_\|} d v_\| =
 -\int^1_{-1} l_j^\prime(x)l_k^\prime(x) d x /s_i.\]</p><p>If <code>explicit_BC_terms = true</code>, boundary terms arising from integration by parts are included at the extreme boundary points.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L1420-L1433">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.get_MM_local!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.get_MM_local!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any}"><code>moment_kinetics.gauss_legendre.get_MM_local!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>If called for <code>coord.name = vperp</code> elemental matrix <code>MM</code> on the <span>$i^{th}$</span> element is</p><p class="math-container">\[ M_{jk} = \int^{v_\perp^U}_{v_\perp^L}  \varphi_j(v_\perp)\varphi_k(v_\perp) v_\perp d v_\perp = \int^1_{-1} (c_i + x s_i)l_j(x)l_k(x) s_i d x \]</p><p>with <span>$c_i$</span> and <span>$s_i$</span> the appropriate shift and scale factors, respectively.  Otherwise, if called for any other coordinate elemental matrix <code>MM</code> is </p><p class="math-container">\[ M_{jk} = \int^{v_\|^U}_{v_\|^L}  \varphi_j(v_\|)\varphi_k(v_\|) d v_\| = \int^1_{-1} l_j(x)l_k(x) s_i d x.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L1270-L1280">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.get_MN_local!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.get_MN_local!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any}"><code>moment_kinetics.gauss_legendre.get_MN_local!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>If called for <code>coord.name = vperp</code> elemental matrix <code>MN</code> on the <span>$i^{th}$</span> element is</p><p class="math-container">\[ (MN)_{jk} = \int^{v_\perp^U}_{v_\perp^L}  \varphi_j(v_\perp)\varphi_k(v_\perp) d v_\perp = \int^1_{-1} l_j(x)l_k(x) s_i d x \]</p><p>with <span>$c_i$</span> and <span>$s_i$</span> the appropriate shift and scale factors, respectively.  Otherwise, if called for any other coordinate elemental matrix <code>MN</code> is the same as <code>MM</code> (see <code>get_MM_local!()</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L1490-L1497">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.get_MR_local!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.get_MR_local!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any}"><code>moment_kinetics.gauss_legendre.get_MR_local!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>If called for <code>coord.name = vperp</code> elemental matrix <code>MR</code> on the <span>$i^{th}$</span> element is</p><p class="math-container">\[ (MR)_{jk} = \int^{v_\perp^U}_{v_\perp^L}  \varphi_j(v_\perp)\varphi_k(v_\perp) v_\perp^2 d v_\perp = \int^1_{-1} (c_i + s_i x)^2 l_j(x)l_k(x) s_i d x \]</p><p>with <span>$c_i$</span> and <span>$s_i$</span> the appropriate shift and scale factors, respectively.  Otherwise, if called for any other coordinate elemental matrix <code>MR</code> is the same as <code>MM</code> (see <code>get_MM_local!()</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L1517-L1524">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.get_PP_local!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.get_PP_local!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any}"><code>moment_kinetics.gauss_legendre.get_PP_local!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>If called for <code>coord.name = vperp</code> elemental matrix <code>PP</code> on the <span>$i^{th}$</span> element is</p><p class="math-container">\[ P_{jk} = \int^{v_\perp^U}_{v_\perp^L}  \varphi_j(v_\perp)\frac{\partial\varphi_k(v_\perp)}{\partial v_\perp} v_\perp d v_\perp
 = \int^1_{-1} (c_i + x s_i)l_j(x)l_k^\prime(x) d x \]</p><p>with <span>$c_i$</span> and <span>$s_i$</span> the appropriate shift and scale factors, respectively.  Otherwise, if called for any other coordinate elemental matrix <code>PP</code> is </p><p class="math-container">\[ P_{jk} = \int^{v_\|^U}_{v_\|^L}  \varphi_j(v_\|)\frac{\partial\varphi_k(v_\|)}{\partial v_\|} d v_\| = \int^1_{-1} l_j(x)l_k^\prime(x) d x.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L1549-L1560">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.get_PU_local!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.get_PU_local!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any}"><code>moment_kinetics.gauss_legendre.get_PU_local!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>If called for <code>coord.name = vperp</code> elemental matrix <code>PP</code> on the <span>$i^{th}$</span> element is</p><p class="math-container">\[ (PU)_{jk} = \int^{v_\perp^U}_{v_\perp^L}  \varphi_j(v_\perp)\frac{\partial\varphi_k(v_\perp)}{\partial v_\perp} v_\perp^2 d v_\perp
 = \int^1_{-1} (c_i + x s_i)^2l_j(x)l_k^\prime(x) d x \]</p><p>with <span>$c_i$</span> and <span>$s_i$</span> the appropriate shift and scale factors, respectively.  Otherwise, if called for any other coordinate elemental matrix <code>PU</code> is the same as <code>PP</code> see <code>get_PP_local!()</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L1581-L1589">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.get_QQ_local!-Tuple{AbstractArray{Float64, 3}, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any, Any}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.get_QQ_local!-Tuple{AbstractArray{Float64, 3}, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any, Any}"><code>moment_kinetics.gauss_legendre.get_QQ_local!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Construction function for nonlinear diffusion matrices, only used in the assembly of the collision operator</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L1614-L1617">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.get_QQ_local!-Tuple{AbstractMatrix{Float64}, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any, Any}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.get_QQ_local!-Tuple{AbstractMatrix{Float64}, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any, Any}"><code>moment_kinetics.gauss_legendre.get_QQ_local!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Construction function to provide the appropriate elemental  matrix <code>Q</code> to the global matrix assembly functions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L1233-L1236">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.get_YY0_local!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.get_YY0_local!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any}"><code>moment_kinetics.gauss_legendre.get_YY0_local!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>If called for <code>coord.name = vperp</code> elemental matrix <code>YY0</code> on the <span>$i^{th}$</span> element is</p><p class="math-container">\[ (YY0)_{jkm} = \int^{v_\perp^U}_{v_\perp^L}  \varphi_j(v_\perp)\varphi_k(v_\perp)\varphi_m(v_\perp) v_\perp d v_\perp
 = \int^1_{-1} (c_i + x s_i)l_j(x)l_k(x)l_m(x) s_i d x \]</p><p>with <span>$c_i$</span> and <span>$s_i$</span> the appropriate shift and scale factors, respectively.  Otherwise, if called for any other coordinate elemental matrix <code>YY0</code> is </p><p class="math-container">\[ (YY0)_{jkm} = \int^{v_\|^U}_{v_\|^L}  \varphi_j(v_\|)\varphi_k(v_\|)\varphi_m(v_\|) d v_\|
 = \int^1_{-1} l_j(x)l_k(x)l_m(x) s_i d x.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L1635-L1647">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.get_YY1_local!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.get_YY1_local!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any}"><code>moment_kinetics.gauss_legendre.get_YY1_local!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>If called for <code>coord.name = vperp</code> elemental matrix <code>YY1</code> on the <span>$i^{th}$</span> element is</p><p class="math-container">\[ (YY1)_{jkm} = \int^{v_\perp^U}_{v_\perp^L}  \varphi_j(v_\perp)\varphi_k(v_\perp)\frac{\partial\varphi_m(v_\perp)}{\partial v_\perp} v_\perp d v_\perp
 = \int^1_{-1} (c_i + x s_i)l_j(x)l_k(x)l_m^\prime(x) d x \]</p><p>with <span>$c_i$</span> and <span>$s_i$</span> the appropriate shift and scale factors, respectively.  Otherwise, if called for any other coordinate elemental matrix <code>YY1</code> is </p><p class="math-container">\[ (YY1)_{jkm} = \int^{v_\|^U}_{v_\|^L}  \varphi_j(v_\|)\varphi_k(v_\|)\frac{\partial\varphi_m(v_\|)}{\partial v_\|} d v_\|
 = \int^1_{-1} l_j(x)l_k(x)l_m^\prime(x) d x.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L1668-L1680">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.get_YY2_local!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.get_YY2_local!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any}"><code>moment_kinetics.gauss_legendre.get_YY2_local!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>If called for <code>coord.name = vperp</code> elemental matrix <code>YY2</code> on the <span>$i^{th}$</span> element is</p><p class="math-container">\[ (YY2)_{jkm} = \int^{v_\perp^U}_{v_\perp^L}  \varphi_j(v_\perp)\frac{\partial\varphi_k(v_\|)}{\partial v_\|}\frac{\partial\varphi_m(v_\perp)}{\partial v_\perp} v_\perp d v_\perp
 = \int^1_{-1} (c_i + x s_i)l_j(x)l_k^\prime(x)l_m^\prime(x) d x/s_i \]</p><p>with <span>$c_i$</span> and <span>$s_i$</span> the appropriate shift and scale factors, respectively.  Otherwise, if called for any other coordinate elemental matrix <code>YY2</code> is </p><p class="math-container">\[ (YY2)_{jkm} = \int^{v_\|^U}_{v_\|^L}  \varphi_j(v_\|)\frac{\partial\varphi_k(v_\|)}{\partial v_\|}\frac{\partial\varphi_m(v_\|)}{\partial v_\|} d v_\|
 = \int^1_{-1} l_j(x)l_k^\prime(x)l_m^\prime(x) d x /s_i.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L1701-L1713">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.get_YY3_local!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.get_YY3_local!-Tuple{Any, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any}"><code>moment_kinetics.gauss_legendre.get_YY3_local!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>If called for <code>coord.name = vperp</code> elemental matrix <code>YY3</code> on the <span>$i^{th}$</span> element is</p><p class="math-container">\[ (YY3)_{jkm} = \int^{v_\perp^U}_{v_\perp^L}  \varphi_j(v_\perp)\frac{\partial\varphi_k(v_\|)}{\partial v_\|}\varphi_m(v_\perp) v_\perp d v_\perp
 = \int^1_{-1} (c_i + x s_i)l_j(x)l_k^\prime(x)l_m(x) d x \]</p><p>with <span>$c_i$</span> and <span>$s_i$</span> the appropriate shift and scale factors, respectively.  Otherwise, if called for any other coordinate elemental matrix <code>YY3</code> is </p><p class="math-container">\[ (YY3)_{jkm} = \int^{v_\|^U}_{v_\|^L}  \varphi_j(v_\|)\frac{\partial\varphi_k(v_\|)}{\partial v_\|}\varphi_m(v_\|) d v_\|
 = \int^1_{-1} l_j(x)l_k^\prime(x)l_m(x) d x.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L1734-L1746">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.identity_matrix!-Tuple{Any, Any}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.identity_matrix!-Tuple{Any, Any}"><code>moment_kinetics.gauss_legendre.identity_matrix!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Function that fills and <code>n</code> x <code>n</code> array with the values of the identity matrix <code>I</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L174-L176">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.ielement_global_func-Tuple{Any, Any, Any}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.ielement_global_func-Tuple{Any, Any, Any}"><code>moment_kinetics.gauss_legendre.ielement_global_func</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Function for finding the elemental index in the global distributed-memory grid. Distributed-memory for global finite-element operators is not yet supported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L973-L976">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.integration_matrix!-Tuple{Matrix{Float64}, Vector{Float64}, Int64}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.integration_matrix!-Tuple{Matrix{Float64}, Vector{Float64}, Int64}"><code>moment_kinetics.gauss_legendre.integration_matrix!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Function to calculate the elemental anti-differentiation (integration) matrix. This function forms the primitive</p><p class="math-container">\[F(x) = \int^x_{x_{\rm min}} f(x^\prime) d x^\prime\]</p><p>of the function </p><p class="math-container">\[f(x) = \sum_j f_j l_j(x),\]</p><p>where <span>$l_j(x)$</span> is the <span>$j^{\rm th}$</span> Lagrange polynomial on the element and <span>$f_j = f(x_j)$</span>, with <span>$x_j$</span> <span>$j^{\rm th}$</span> collocation point on the element. We find <span>$F(x)$</span> at the collocation points on the element, giving a series of integrals to evaluate:</p><p class="math-container">\[F(x_i) = \int^{x_i}_{-1} f(x^\prime) d x^\prime = \sum_j f_j \int^{x_i}_{-1} l_j(x^\prime) d x^\prime,\]</p><p>where we have used that <span>$x_{\rm min} = -1$</span> on the elemental grid. Changing to a normalised coordinate <span>$y$</span> suitable for Gaussian quadrature </p><p class="math-container">\[x^\prime = \frac{x_i + 1}{2} y + \frac{x_i - 1}{2}\]</p><p>we can write the operation in matrix form:</p><p class="math-container">\[F(x_i) = \sum_{j}A_{ij}f_j,\]</p><p>with the matrix <span>$A_{ij}$</span> defined by</p><p class="math-container">\[A_{ij} = \left(\frac{x_i + 1}{2}\right) \int^1_{-1} l_j \left( \frac{(x_i + 1)y + x_i - 1}{2} \right) dy,\]</p><p>or in discretised form</p><p class="math-container">\[A_{ij} = \left(\frac{x_i + 1}{2}\right) \sum_k l_j \left( \frac{(x_i + 1)y_k + x_i - 1}{2} \right) w_k,\]</p><p>with <span>$y_k$</span> and <span>$w_k$</span> Gauss-quadrature points and weights, respectively.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L479-L513">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.scale_factor_func-Tuple{Any, Any}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.scale_factor_func-Tuple{Any, Any}"><code>moment_kinetics.gauss_legendre.scale_factor_func</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Function for computing the scale factor on a grid with uniformed spaced element boundaries. Unused.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L954-L957">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.scaled_gauss_legendre_lobatto_grid-NTuple{7, Any}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.scaled_gauss_legendre_lobatto_grid-NTuple{7, Any}"><code>moment_kinetics.gauss_legendre.scaled_gauss_legendre_lobatto_grid</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Function for setting up the full Gauss-Legendre-Lobatto grid and collocation point weights.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L981-L984">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.scaled_gauss_legendre_radau_grid-NTuple{8, Any}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.scaled_gauss_legendre_radau_grid-NTuple{8, Any}"><code>moment_kinetics.gauss_legendre.scaled_gauss_legendre_radau_grid</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Function for setting up the full Gauss-Legendre-Radau grid and collocation point weights.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L1011-L1014">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.setup_gausslegendre_pseudospectral-Tuple{Any}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.setup_gausslegendre_pseudospectral-Tuple{Any}"><code>moment_kinetics.gauss_legendre.setup_gausslegendre_pseudospectral</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Function to create <code>gausslegendre_info</code> struct.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L132-L134">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.setup_gausslegendre_pseudospectral_lobatto-Tuple{Any}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.setup_gausslegendre_pseudospectral_lobatto-Tuple{Any}"><code>moment_kinetics.gauss_legendre.setup_gausslegendre_pseudospectral_lobatto</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Function that creates the <code>gausslegendre_base_info</code> struct for Lobatto points. If <code>collision_operator_dim = true</code>, assign the elemental matrices used to implement the Fokker-Planck collision operator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L185-L189">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.setup_gausslegendre_pseudospectral_radau-Tuple{Any}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.setup_gausslegendre_pseudospectral_radau-Tuple{Any}"><code>moment_kinetics.gauss_legendre.setup_gausslegendre_pseudospectral_radau</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Function that creates the <code>gausslegendre_base_info</code> struct for Lobatto points. If <code>collision_operator_dim = true</code>, assign the elemental matrices used to implement the Fokker-Planck collision operator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L265-L269">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.setup_global_strong_form_matrix!-Tuple{Matrix{Float64}, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any, Any}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.setup_global_strong_form_matrix!-Tuple{Matrix{Float64}, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any, Any}"><code>moment_kinetics.gauss_legendre.setup_global_strong_form_matrix!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>A function that assigns the local matrices to a global array QQ_global for later evaluating strong form of required 1D equation.</p><p>The &#39;option&#39; variable is a flag for choosing the type of matrix to be constructed. Currently the function is set up to assemble the elemental matrices without imposing boundary conditions on the first and final rows of the matrix. This means that the operators constructed from this function can only be used for differentiation, and not solving 1D ODEs. The shared points in the element assembly are averaged (instead of simply added) to be consistent with the <code>derivative_elements_to_full_grid!()</code> function in <code>calculus.jl</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L1160-L1174">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.setup_global_weak_form_matrix!-Tuple{Matrix{Float64}, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any, Any}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.setup_global_weak_form_matrix!-Tuple{Matrix{Float64}, moment_kinetics.gauss_legendre.gausslegendre_base_info, moment_kinetics.gauss_legendre.gausslegendre_base_info, Any, Any}"><code>moment_kinetics.gauss_legendre.setup_global_weak_form_matrix!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>A function that assigns the local weak-form matrices to  a global array QQ_global for later solving weak form of required 1D equation.</p><p>The &#39;option&#39; variable is a flag for  choosing the type of matrix to be constructed.  Currently the function is set up to assemble the  elemental matrices without imposing boundary conditions on the  first and final rows of the matrix by default. This means that  the operators constructed from this function can only be used for differentiation, and not solving 1D ODEs. This assembly function assumes that the  coordinate is not distributed. To extend this function to support distributed-memory MPI, addition of off-memory matrix elements to the exterior points would be required.</p><p>The typical use of this function is to assemble matrixes M and K in</p><p>M * d2f = K * f </p><p>where M is the mass matrix and K is the stiffness matrix, and we wish to solve for d2f given f. To solve 1D ODEs</p><p>K * f = b = M * d2f </p><p>for f given boundary data on f with periodic or dirichlet boundary conditions, set </p><p><code>periodic_bc = true</code>, <code>b[end] = 0</code></p><p>or </p><p><code>dirichlet_bc = true</code>, <code>b[1] = f[1]</code> (except for cylindrical coordinates), <code>b[end] = f[end]</code></p><p>in the function call, and create new matrices for this purpose in the <code>gausslegendre_info</code> struct. Currently the Laplacian matrix is supported with boundary conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L1058-L1096">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.gauss_legendre.shift_factor_func-NTuple{5, Any}"><a class="docstring-binding" href="#moment_kinetics.gauss_legendre.shift_factor_func-NTuple{5, Any}"><code>moment_kinetics.gauss_legendre.shift_factor_func</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Function for computing the shift factor on a grid with uniformed spaced element boundaries. Unused.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L962-L965">source</a></section></details></article><article><details class="docstring" open="true"><summary id="moment_kinetics.interpolation.single_element_interpolate!-Tuple{Any, Any, Any, Any, Any, Any, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, Val{0}}"><a class="docstring-binding" href="#moment_kinetics.interpolation.single_element_interpolate!-Tuple{Any, Any, Any, Any, Any, Any, Any, moment_kinetics.gauss_legendre.gausslegendre_base_info, Val{0}}"><code>moment_kinetics.interpolation.single_element_interpolate!</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Function to perform interpolation on a single element.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/246e4396948fb31d3b7a201c0d973286b2589fbd/moment_kinetics/src/gauss_legendre.jl#L399-L401">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../zz_fourier/">« <code>fourier</code></a><a class="docs-footer-nextpage" href="../zz_geo/"><code>geo</code> »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Thursday 22 January 2026 09:14">Thursday 22 January 2026</span>. Using Julia version 1.11.8.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
