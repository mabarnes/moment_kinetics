<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>velocity_moments · moment_kinetics</title><meta name="title" content="velocity_moments · moment_kinetics"/><meta property="og:title" content="velocity_moments · moment_kinetics"/><meta property="twitter:title" content="velocity_moments · moment_kinetics"/><meta name="description" content="Documentation for moment_kinetics."/><meta property="og:description" content="Documentation for moment_kinetics."/><meta property="twitter:description" content="Documentation for moment_kinetics."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">moment_kinetics</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../chebyshev/">Chebyshev tranform via Fourier transform</a></li><li><a class="tocitem" href="../constraints_on_normalized_distribution_function/">Constraints on normalized distribution function</a></li><li><a class="tocitem" href="../debugging-hints/">Debugging</a></li><li><a class="tocitem" href="../developing/">Developing</a></li><li><a class="tocitem" href="../external_sources_notes/">External sources</a></li><li><a class="tocitem" href="../fokker_planck_notes/">Fokker Planck collision operator</a></li><li><a class="tocitem" href="../geometry/">Magnetic Geometry</a></li><li><a class="tocitem" href="../getting_started/">Getting started</a></li><li><a class="tocitem" href="../input_options/">Input Options</a></li><li><a class="tocitem" href="../machine_setup_notes/"><code>machine_setup</code> notes</a></li><li><a class="tocitem" href="../manual_setup/">Manual setup</a></li><li><a class="tocitem" href="../manufactured_solution_test_examples/">List of Manufactured Solutions Test TOML inputs</a></li><li><a class="tocitem" href="../moment_kinetic_equations/">Moment kinetic equations</a></li><li><a class="tocitem" href="../moment_kinetic_equations_electrons/">Moment kinetic equations for electrons</a></li><li><a class="tocitem" href="../parameter_scans/">Parameter scans</a></li><li><a class="tocitem" href="../post_processing_notes/">Post processing</a></li><li><a class="tocitem" href="../shared_memory_debugging/">Shared memory debugging</a></li><li><a class="tocitem" href="../timestepping/">Timestepping</a></li><li><a class="tocitem" href="../wall_boundary_conditions/">Wall boundary conditions with moment constraints</a></li><li><a class="tocitem" href="../zz_MKJacobianUtils/"><code>MKJacobianUtils</code></a></li><li><a class="tocitem" href="../zz_advection/"><code>advection</code></a></li><li><a class="tocitem" href="../zz_analysis/"><code>analysis</code></a></li><li><a class="tocitem" href="../zz_array_allocation/"><code>array_allocation</code></a></li><li><a class="tocitem" href="../zz_bgk/"><code>bgk</code></a></li><li><a class="tocitem" href="../zz_boundary_conditions/"><code>boundary_conditions</code></a></li><li><a class="tocitem" href="../zz_calculus/"><code>calculus</code></a></li><li><a class="tocitem" href="../zz_charge_exchange/"><code>charge_exchange</code></a></li><li><a class="tocitem" href="../zz_chebyshev/"><code>chebyshev</code></a></li><li><a class="tocitem" href="../zz_clenshaw_curtis/"><code>clenshaw_curtis</code></a></li><li><a class="tocitem" href="../zz_collision_frequencies/"><code>collision_frequencies</code></a></li><li><a class="tocitem" href="../zz_command_line_options/"><code>command_line_options</code></a></li><li><a class="tocitem" href="../zz_communication/"><code>communication</code></a></li><li><a class="tocitem" href="../zz_constants/"><code>constants</code></a></li><li><a class="tocitem" href="../zz_continuity/"><code>continuity</code></a></li><li><a class="tocitem" href="../zz_coordinates/"><code>coordinates</code></a></li><li><a class="tocitem" href="../zz_debugging/"><code>debugging</code></a></li><li><a class="tocitem" href="../zz_derivatives/"><code>derivatives</code></a></li><li><a class="tocitem" href="../zz_electron_fluid_equations/"><code>electron_fluid_equations</code></a></li><li><a class="tocitem" href="../zz_electron_kinetic_equation/"><code>electron_kinetic_equation</code></a></li><li><a class="tocitem" href="../zz_electron_vpa_advection/"><code>electron_vpa_advection</code></a></li><li><a class="tocitem" href="../zz_electron_z_advection/"><code>electron_z_advection</code></a></li><li><a class="tocitem" href="../zz_em_fields/"><code>em_fields</code></a></li><li><a class="tocitem" href="../zz_energy_equation/"><code>energy_equation</code></a></li><li><a class="tocitem" href="../zz_external_sources/"><code>external_sources</code></a></li><li><a class="tocitem" href="../zz_file_io/"><code>file_io</code></a></li><li><a class="tocitem" href="../zz_finite_differences/"><code>finite_differences</code></a></li><li><a class="tocitem" href="../zz_fokker_planck/"><code>fokker_planck</code></a></li><li><a class="tocitem" href="../zz_fokker_planck_calculus/"><code>fokker_planck_calculus</code></a></li><li><a class="tocitem" href="../zz_fokker_planck_test/"><code>fokker_planck_test</code></a></li><li><a class="tocitem" href="../zz_force_balance/"><code>force_balance</code></a></li><li><a class="tocitem" href="../zz_gauss_legendre/"><code>gauss_legendre</code></a></li><li><a class="tocitem" href="../zz_geo/"><code>geo</code></a></li><li><a class="tocitem" href="../zz_gyroaverages/"><code>gyroaverages</code></a></li><li><a class="tocitem" href="../zz_initial_conditions/"><code>initial_conditions</code></a></li><li><a class="tocitem" href="../zz_input_structs/"><code>input_structs</code></a></li><li><a class="tocitem" href="../zz_interpolation/"><code>interpolation</code></a></li><li><a class="tocitem" href="../zz_ionization/"><code>ionization</code></a></li><li><a class="tocitem" href="../zz_krook_collisions/"><code>krook_collisions</code></a></li><li><a class="tocitem" href="../zz_lagrange_polynomials/"><code>lagrange_polynomials</code></a></li><li><a class="tocitem" href="../zz_load_data/"><code>load_data</code></a></li><li><a class="tocitem" href="../zz_looping/"><code>looping</code></a></li><li><a class="tocitem" href="../zz_makie_post_processing/"><code>makie_post_processing</code></a></li><li><a class="tocitem" href="../zz_manufactured_solns/"><code>manufactured_solns</code></a></li><li><a class="tocitem" href="../zz_maxwell_diffusion/"><code>maxwell_diffusion</code></a></li><li><a class="tocitem" href="../zz_moment_constraints/"><code>moment_constraints</code></a></li><li><a class="tocitem" href="../zz_moment_kinetics/"><code>moment_kinetics</code></a></li><li><a class="tocitem" href="../zz_moment_kinetics_input/"><code>moment_kinetics_input</code></a></li><li><a class="tocitem" href="../zz_moment_kinetics_structs/"><code>moment_kinetics_structs</code></a></li><li><a class="tocitem" href="../zz_neutral_r_advection/"><code>neutral_r_advection</code></a></li><li><a class="tocitem" href="../zz_neutral_vz_advection/"><code>neutral_vz_advection</code></a></li><li><a class="tocitem" href="../zz_neutral_z_advection/"><code>neutral_z_advection</code></a></li><li><a class="tocitem" href="../zz_nonlinear_solvers/"><code>nonlinear_solvers</code></a></li><li><a class="tocitem" href="../zz_numerical_dissipation/"><code>numerical_dissipation</code></a></li><li><a class="tocitem" href="../zz_plot_MMS_sequence/"><code>plot_MMS_sequence</code></a></li><li><a class="tocitem" href="../zz_plot_sequence/"><code>plot_sequence</code></a></li><li><a class="tocitem" href="../zz_plots_post_processing/"><code>plots_post_processing</code></a></li><li><a class="tocitem" href="../zz_quadrature/"><code>quadrature</code></a></li><li><a class="tocitem" href="../zz_r_advection/"><code>r_advection</code></a></li><li><a class="tocitem" href="../zz_reference_parameters/"><code>reference_parameters</code></a></li><li><a class="tocitem" href="../zz_runge_kutta/"><code>runge_kutta</code></a></li><li><a class="tocitem" href="../zz_source_terms/"><code>source_terms</code></a></li><li><a class="tocitem" href="../zz_species_input/"><code>species_input</code></a></li><li><a class="tocitem" href="../zz_time_advance/"><code>time_advance</code></a></li><li><a class="tocitem" href="../zz_timer_utils/"><code>timer_utils</code></a></li><li><a class="tocitem" href="../zz_type_definitions/"><code>type_definitions</code></a></li><li><a class="tocitem" href="../zz_utils/"><code>utils</code></a></li><li><a class="tocitem" href="../zz_velocity_grid_transforms/"><code>velocity_grid_transforms</code></a></li><li class="is-active"><a class="tocitem" href><code>velocity_moments</code></a></li><li><a class="tocitem" href="../zz_vpa_advection/"><code>vpa_advection</code></a></li><li><a class="tocitem" href="../zz_z_advection/"><code>z_advection</code></a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href><code>velocity_moments</code></a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href><code>velocity_moments</code></a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/mabarnes/moment_kinetics" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/mabarnes/moment_kinetics/blob/master/docs/src/zz_velocity_moments.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="velocity_moments"><a class="docs-heading-anchor" href="#velocity_moments"><code>velocity_moments</code></a><a id="velocity_moments-1"></a><a class="docs-heading-anchor-permalink" href="#velocity_moments" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments" href="#moment_kinetics.velocity_moments"><code>moment_kinetics.velocity_moments</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.calculate_electron_moment_derivatives!-NTuple{7, Any}" href="#moment_kinetics.velocity_moments.calculate_electron_moment_derivatives!-NTuple{7, Any}"><code>moment_kinetics.velocity_moments.calculate_electron_moment_derivatives!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Pre-calculate spatial derivatives of the electron moments that will be needed for the time advance</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L1456-L1458">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.calculate_electron_moment_derivatives_no_r!-NTuple{9, Any}" href="#moment_kinetics.velocity_moments.calculate_electron_moment_derivatives_no_r!-NTuple{9, Any}"><code>moment_kinetics.velocity_moments.calculate_electron_moment_derivatives_no_r!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate spatial derivatives of the electron moments.</p><p>This version, for use in implicit solvers for electrons, works with a single point in <code>r</code>, given by <code>ir</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L1501-L1506">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.calculate_ion_moment_derivatives!-NTuple{6, Any}" href="#moment_kinetics.velocity_moments.calculate_ion_moment_derivatives!-NTuple{6, Any}"><code>moment_kinetics.velocity_moments.calculate_ion_moment_derivatives!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Pre-calculate spatial derivatives of the moments that will be needed for the time advance</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L1364-L1366">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.calculate_ion_qpar_from_coll_krook!-NTuple{12, Any}" href="#moment_kinetics.velocity_moments.calculate_ion_qpar_from_coll_krook!-NTuple{12, Any}"><code>moment_kinetics.velocity_moments.calculate_ion_qpar_from_coll_krook!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>calculate parallel heat flux if ion composition flag is coll_krook fluid ions</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L1044-L1046">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.calculate_ion_qpar_from_pdf!-NTuple{12, Any}" href="#moment_kinetics.velocity_moments.calculate_ion_qpar_from_pdf!-NTuple{12, Any}"><code>moment_kinetics.velocity_moments.calculate_ion_qpar_from_pdf!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>calculate parallel heat flux if ion composition flag is kinetic ions</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L1002-L1004">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.calculate_neutral_moment_derivatives!-NTuple{6, Any}" href="#moment_kinetics.velocity_moments.calculate_neutral_moment_derivatives!-NTuple{6, Any}"><code>moment_kinetics.velocity_moments.calculate_neutral_moment_derivatives!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Pre-calculate spatial derivatives of the neutral moments that will be needed for the time advance</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L2252-L2255">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.create_moments_electron-NTuple{5, Any}" href="#moment_kinetics.velocity_moments.create_moments_electron-NTuple{5, Any}"><code>moment_kinetics.velocity_moments.create_moments_electron</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>create a moment struct containing information about the electron moments</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L248-L250">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.create_moments_ion-NTuple{8, Any}" href="#moment_kinetics.velocity_moments.create_moments_ion-NTuple{8, Any}"><code>moment_kinetics.velocity_moments.create_moments_ion</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L56">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.integrate_over_negative_vpa-NTuple{6, Any}" href="#moment_kinetics.velocity_moments.integrate_over_negative_vpa-NTuple{6, Any}"><code>moment_kinetics.velocity_moments.integrate_over_negative_vpa</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>computes the integral over vpa &lt;= 0 of the integrand, using the input vpa_wgts this could be made more efficient for the case that dz/dt = vpa is time-independent, but it has been left general for the cases where, e.g., dz/dt = wpa*vth + upar varies in time</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L2550-L2555">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.integrate_over_positive_vpa-NTuple{6, Any}" href="#moment_kinetics.velocity_moments.integrate_over_positive_vpa-NTuple{6, Any}"><code>moment_kinetics.velocity_moments.integrate_over_positive_vpa</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>computes the integral over vpa &gt;= 0 of the integrand, using the input vpa_wgts this could be made more efficient for the case that dz/dt = vpa is time-independent, but it has been left general for the cases where, e.g., dz/dt = wpa*vth + upar varies in time</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L2452-L2457">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.reset_moments_status!-Tuple{Any}" href="#moment_kinetics.velocity_moments.reset_moments_status!-Tuple{Any}"><code>moment_kinetics.velocity_moments.reset_moments_status!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L2645">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_chodura!-NTuple{11, Any}" href="#moment_kinetics.velocity_moments.update_chodura!-NTuple{11, Any}"><code>moment_kinetics.velocity_moments.update_chodura!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>runtime diagnostic routine for computing the Chodura ratio in a single species plasma with Z = 1</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L1278-L1281">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_chodura_integral_species!-NTuple{14, Any}" href="#moment_kinetics.velocity_moments.update_chodura_integral_species!-NTuple{14, Any}"><code>moment_kinetics.velocity_moments.update_chodura_integral_species!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>compute the integral needed for the generalised Chodura condition</p><p>IChodura = (Z^2 vBohm^2 / cref^2) * int ( f bz^2 / vz^2 + dfdr*rhostar/vz )  vBohm = sqrt(Z Te/mi)  with Z = 1 and mref = mi  cref = sqrt(2Ti/mi) and normalise to the local ion density, appropriate to assessing the  Chodura condition </p><pre><code class="nohighlight hljs">IChodura &lt;= (Te/e)d ne / dphi |(sheath entrance) = ni</code></pre><p>to a single species plasma with Z = 1</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L1324-L1337">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_density!-NTuple{8, Any}" href="#moment_kinetics.velocity_moments.update_density!-NTuple{8, Any}"><code>moment_kinetics.velocity_moments.update_density!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>NB: if this function is called and if dens_updated is false, then the incoming pdf is the un-normalized pdf that satisfies int dv pdf = density</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L613-L616">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_density_species!-NTuple{6, Any}" href="#moment_kinetics.velocity_moments.update_density_species!-NTuple{6, Any}"><code>moment_kinetics.velocity_moments.update_density_species!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>calculate the updated density (dens) for a given species; should only be called when evolve<em>density = false, in which case the vpa coordinate is vpa/c</em>s</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L631-L635">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_derived_electron_moment_time_derivatives!-Tuple{Any, Any, Any}" href="#moment_kinetics.velocity_moments.update_derived_electron_moment_time_derivatives!-Tuple{Any, Any, Any}"><code>moment_kinetics.velocity_moments.update_derived_electron_moment_time_derivatives!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>&#39;Primary&#39; time derivatives are calculated when doing the time advance for moment quantities. Moment kinetic equations require in addition some &#39;derived&#39; time derivatives, which we can calculate by applying the chain rule.</p><p>For electrons the kinetic equation that is solved for the shape function is simplified by using <span>$\sqrt{m_e/m_i}$</span> as a small parameter <em>after</em> substituting in the moment equations. Therefore it is not possible (or at least not convenient) to use <code>dp_dt</code> as calculated from the moment equation. The electron moment time derivatives may still be useful as diagnostics, so we calculate them anyway, including the derived versions (calculated in this function), similar to the ion moment time derivatives.</p><p>Note that due to the implicit/explicit splitting of terms in the timestep, which means that the density (which is equal to the ion density) does not update during the implicit electron timestep, the time derivative of density dn/dt does not contribute to the chain rule calculations in this function, even though analytically it would contribute (although the contribution would be small in sqrt(me/mi)). Another way of saying this is that due to the operator splitting, the time derivatives during the implicit step are done with the explicit variables (density in particular) held fixed, and so <code>dvth_dt|_n = 0.5 * vth * dp_dt / p</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L1183-L1203">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_derived_ion_moment_time_derivatives!-Tuple{Any, Any}" href="#moment_kinetics.velocity_moments.update_derived_ion_moment_time_derivatives!-Tuple{Any, Any}"><code>moment_kinetics.velocity_moments.update_derived_ion_moment_time_derivatives!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>&#39;Primary&#39; time derivatives are calculated when doing the time advance for moment quantities. Moment kinetic equations require in addition some &#39;derived&#39; time derivatives, which we can calculate by applying the chain rule.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L1146-L1150">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_derived_moments!-NTuple{14, Any}" href="#moment_kinetics.velocity_moments.update_derived_moments!-NTuple{14, Any}"><code>moment_kinetics.velocity_moments.update_derived_moments!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>update velocity moments that are calculable from the evolved ion pdf</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L2342-L2344">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_derived_moments_neutral!-NTuple{8, Any}" href="#moment_kinetics.velocity_moments.update_derived_moments_neutral!-NTuple{8, Any}"><code>moment_kinetics.velocity_moments.update_derived_moments_neutral!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>update velocity moments that are calculable from the evolved neutral pdf</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L2409-L2411">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_derived_neutral_moment_time_derivatives!-Tuple{Any, Any}" href="#moment_kinetics.velocity_moments.update_derived_neutral_moment_time_derivatives!-Tuple{Any, Any}"><code>moment_kinetics.velocity_moments.update_derived_neutral_moment_time_derivatives!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>&#39;Primary&#39; time derivatives are calculated when doing the time advance for moment quantities. Moment kinetic equations require in addition some &#39;derived&#39; time derivatives, which we can calculate by applying the chain rule.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L1241-L1245">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_ion_qpar!-NTuple{17, Any}" href="#moment_kinetics.velocity_moments.update_ion_qpar!-NTuple{17, Any}"><code>moment_kinetics.velocity_moments.update_ion_qpar!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>NB: the incoming pdf is the normalized pdf</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L965-L967">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_ion_qpar_species!-NTuple{15, Any}" href="#moment_kinetics.velocity_moments.update_ion_qpar_species!-NTuple{15, Any}"><code>moment_kinetics.velocity_moments.update_ion_qpar_species!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>calculate the updated parallel heat flux (qpar) for a given species</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L985-L987">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_moments!-Tuple{Any, Any, moment_kinetics.gyroaverages.gyro_operators, Vararg{Any, 10}}" href="#moment_kinetics.velocity_moments.update_moments!-Tuple{Any, Any, moment_kinetics.gyroaverages.gyro_operators, Vararg{Any, 10}}"><code>moment_kinetics.velocity_moments.update_moments!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>calculate the updated density (dens) and parallel pressure (ppar) for all species this function is only used once after initialisation the function used to update moments at run time is update<em>derived</em>moments! in time_advance.jl</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L544-L548">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_moments_neutral!-NTuple{8, Any}" href="#moment_kinetics.velocity_moments.update_moments_neutral!-NTuple{8, Any}"><code>moment_kinetics.velocity_moments.update_moments_neutral!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>update velocity moments of the evolved neutral pdf</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L1548-L1550">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_neutral_density!-NTuple{9, Any}" href="#moment_kinetics.velocity_moments.update_neutral_density!-NTuple{9, Any}"><code>moment_kinetics.velocity_moments.update_neutral_density!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>calculate the neutral density from the neutral pdf</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L1644-L1646">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_neutral_density_species!-NTuple{7, Any}" href="#moment_kinetics.velocity_moments.update_neutral_density_species!-NTuple{7, Any}"><code>moment_kinetics.velocity_moments.update_neutral_density_species!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>calculate the updated density (dens) for a given species</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L1661-L1663">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_neutral_p_species!-NTuple{15, Any}" href="#moment_kinetics.velocity_moments.update_neutral_p_species!-NTuple{15, Any}"><code>moment_kinetics.velocity_moments.update_neutral_p_species!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>calculate the updated pressure (p) for a given species</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L1870-L1872">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_neutral_pr_species!-NTuple{13, Any}" href="#moment_kinetics.velocity_moments.update_neutral_pr_species!-NTuple{13, Any}"><code>moment_kinetics.velocity_moments.update_neutral_pr_species!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>calculate the updated pressure in rr direction (pr) for a given species</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L2049-L2051">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_neutral_pz_species!-NTuple{13, Any}" href="#moment_kinetics.velocity_moments.update_neutral_pz_species!-NTuple{13, Any}"><code>moment_kinetics.velocity_moments.update_neutral_pz_species!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>calculate the updated pressure in zz direction (pz) for a given species</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L1965-L1967">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_neutral_pzeta_species!-NTuple{13, Any}" href="#moment_kinetics.velocity_moments.update_neutral_pzeta_species!-NTuple{13, Any}"><code>moment_kinetics.velocity_moments.update_neutral_pzeta_species!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>calculate the updated pressure in zeta-zeta direction (pzeta) for a given species</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L2122-L2124">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_neutral_qz_species!-NTuple{13, Any}" href="#moment_kinetics.velocity_moments.update_neutral_qz_species!-NTuple{13, Any}"><code>moment_kinetics.velocity_moments.update_neutral_qz_species!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>calculate the updated heat flux zzz direction (qz) for a given species</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L2206-L2208">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_neutral_ur_species!-NTuple{11, Any}" href="#moment_kinetics.velocity_moments.update_neutral_ur_species!-NTuple{11, Any}"><code>moment_kinetics.velocity_moments.update_neutral_ur_species!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>calculate the updated ur (mean velocity in r) for a given species</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L1772-L1774">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_neutral_uz_species!-NTuple{11, Any}" href="#moment_kinetics.velocity_moments.update_neutral_uz_species!-NTuple{11, Any}"><code>moment_kinetics.velocity_moments.update_neutral_uz_species!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>calculate the updated uz (mean velocity in z) for a given species</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L1701-L1703">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_neutral_uzeta_species!-NTuple{11, Any}" href="#moment_kinetics.velocity_moments.update_neutral_uzeta_species!-NTuple{11, Any}"><code>moment_kinetics.velocity_moments.update_neutral_uzeta_species!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>calculate the updated uzeta (mean velocity in zeta) for a given species</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L1819-L1821">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_p!-NTuple{12, Any}" href="#moment_kinetics.velocity_moments.update_p!-NTuple{12, Any}"><code>moment_kinetics.velocity_moments.update_p!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>NB: if this function is called and if p_updated is false, then the incoming pdf is the un-normalized pdf that satisfies int dv pdf = density</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L734-L737">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_p_species!-NTuple{10, Any}" href="#moment_kinetics.velocity_moments.update_p_species!-NTuple{10, Any}"><code>moment_kinetics.velocity_moments.update_p_species!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>calculate the updated energy density (or pressure, p) for a given species; which of these is calculated depends on the definition of the vpa coordinate</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L756-L759">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_ppar!-NTuple{13, Any}" href="#moment_kinetics.velocity_moments.update_ppar!-NTuple{13, Any}"><code>moment_kinetics.velocity_moments.update_ppar!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate the parallel pressure p<em>∥=∫d^3v (v</em>∥ - u_∥)^2 f</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L814-L816">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_ppar_species!-NTuple{12, Any}" href="#moment_kinetics.velocity_moments.update_ppar_species!-NTuple{12, Any}"><code>moment_kinetics.velocity_moments.update_ppar_species!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>calculate the updated energy density (or parallel pressure, ppar) for a given species; which of these is calculated depends on the definition of the vpa coordinate</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L832-L835">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_pperp_species!-NTuple{5, Any}" href="#moment_kinetics.velocity_moments.update_pperp_species!-NTuple{5, Any}"><code>moment_kinetics.velocity_moments.update_pperp_species!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>calculate the updated perpendicular pressure (pperp) for a given species</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L934-L936">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_upar!-NTuple{12, Any}" href="#moment_kinetics.velocity_moments.update_upar!-NTuple{12, Any}"><code>moment_kinetics.velocity_moments.update_upar!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>NB: if this function is called and if upar_updated is false, then the incoming pdf is the un-normalized pdf that satisfies int dv pdf = density</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L657-L660">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.velocity_moments.update_upar_species!-NTuple{10, Any}" href="#moment_kinetics.velocity_moments.update_upar_species!-NTuple{10, Any}"><code>moment_kinetics.velocity_moments.update_upar_species!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>calculate the updated parallel flow (upar) for a given species</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/08c83a03232286db835b6f72e01e2b309acd3f31/moment_kinetics/src/velocity_moments.jl#L677-L679">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../zz_velocity_grid_transforms/">« <code>velocity_grid_transforms</code></a><a class="docs-footer-nextpage" href="../zz_vpa_advection/"><code>vpa_advection</code> »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Friday 30 May 2025 13:25">Friday 30 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
