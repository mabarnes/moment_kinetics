<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Manual setup · moment_kinetics</title><meta name="title" content="Manual setup · moment_kinetics"/><meta property="og:title" content="Manual setup · moment_kinetics"/><meta property="twitter:title" content="Manual setup · moment_kinetics"/><meta name="description" content="Documentation for moment_kinetics."/><meta property="og:description" content="Documentation for moment_kinetics."/><meta property="twitter:description" content="Documentation for moment_kinetics."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">moment_kinetics</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../chebyshev/">Chebyshev tranform via Fourier transform</a></li><li><a class="tocitem" href="../constraints_on_normalized_distribution_function/">Constraints on normalized distribution function</a></li><li><a class="tocitem" href="../debugging-hints/">Debugging</a></li><li><a class="tocitem" href="../developing/">Developing</a></li><li><a class="tocitem" href="../external_sources_notes/">External sources</a></li><li><a class="tocitem" href="../fokker_planck_notes/">Fokker Planck collision operator</a></li><li><a class="tocitem" href="../geometry/">Magnetic Geometry</a></li><li><a class="tocitem" href="../getting_started/">Getting started</a></li><li><a class="tocitem" href="../input_options/">Input Options</a></li><li><a class="tocitem" href="../machine_setup_notes/"><code>machine_setup</code> notes</a></li><li class="is-active"><a class="tocitem" href>Manual setup</a><ul class="internal"><li><a class="tocitem" href="#Install-Julia"><span>Install Julia</span></a></li><li><a class="tocitem" href="#Add-moment_kinetics-packages"><span>Add <code>moment_kinetics</code> packages</span></a></li><li><a class="tocitem" href="#Set-up-MPI"><span>Set up MPI</span></a></li><li><a class="tocitem" href="#Using-the-native-Julia-MPI"><span>Using the native Julia MPI</span></a></li><li><a class="tocitem" href="#Miscellaneous-required-packages"><span>Miscellaneous required packages</span></a></li><li><a class="tocitem" href="#Link-HDF5"><span>Link HDF5</span></a></li><li><a class="tocitem" href="#Enable-MMS-features"><span>Enable MMS features</span></a></li><li><a class="tocitem" href="#Enable-NetCDF-output"><span>Enable NetCDF output</span></a></li><li><a class="tocitem" href="#Set-up-Plots-based-plotting-routines"><span>Set up <code>Plots</code>-based plotting routines</span></a></li><li><a class="tocitem" href="#An-example-manual-setup-script"><span>An example manual setup script</span></a></li></ul></li><li><a class="tocitem" href="../manufactured_solution_test_examples/">List of Manufactured Solutions Test TOML inputs</a></li><li><a class="tocitem" href="../moment_kinetic_equations/">Moment kinetic equations</a></li><li><a class="tocitem" href="../parameter_scans/">Parameter scans</a></li><li><a class="tocitem" href="../post_processing_notes/">Post processing</a></li><li><a class="tocitem" href="../shared_memory_debugging/">Shared memory debugging</a></li><li><a class="tocitem" href="../timestepping/">Timestepping</a></li><li><a class="tocitem" href="../wall_boundary_conditions/">Wall boundary conditions with moment constraints</a></li><li><a class="tocitem" href="../zz_MKJacobianUtils/"><code>MKJacobianUtils</code></a></li><li><a class="tocitem" href="../zz_advection/"><code>advection</code></a></li><li><a class="tocitem" href="../zz_analysis/"><code>analysis</code></a></li><li><a class="tocitem" href="../zz_array_allocation/"><code>array_allocation</code></a></li><li><a class="tocitem" href="../zz_bgk/"><code>bgk</code></a></li><li><a class="tocitem" href="../zz_boundary_conditions/"><code>boundary_conditions</code></a></li><li><a class="tocitem" href="../zz_calculus/"><code>calculus</code></a></li><li><a class="tocitem" href="../zz_charge_exchange/"><code>charge_exchange</code></a></li><li><a class="tocitem" href="../zz_chebyshev/"><code>chebyshev</code></a></li><li><a class="tocitem" href="../zz_clenshaw_curtis/"><code>clenshaw_curtis</code></a></li><li><a class="tocitem" href="../zz_collision_frequencies/"><code>collision_frequencies</code></a></li><li><a class="tocitem" href="../zz_command_line_options/"><code>command_line_options</code></a></li><li><a class="tocitem" href="../zz_communication/"><code>communication</code></a></li><li><a class="tocitem" href="../zz_constants/"><code>constants</code></a></li><li><a class="tocitem" href="../zz_continuity/"><code>continuity</code></a></li><li><a class="tocitem" href="../zz_coordinates/"><code>coordinates</code></a></li><li><a class="tocitem" href="../zz_debugging/"><code>debugging</code></a></li><li><a class="tocitem" href="../zz_derivatives/"><code>derivatives</code></a></li><li><a class="tocitem" href="../zz_electron_fluid_equations/"><code>electron_fluid_equations</code></a></li><li><a class="tocitem" href="../zz_electron_kinetic_equation/"><code>electron_kinetic_equation</code></a></li><li><a class="tocitem" href="../zz_electron_vpa_advection/"><code>electron_vpa_advection</code></a></li><li><a class="tocitem" href="../zz_electron_z_advection/"><code>electron_z_advection</code></a></li><li><a class="tocitem" href="../zz_em_fields/"><code>em_fields</code></a></li><li><a class="tocitem" href="../zz_energy_equation/"><code>energy_equation</code></a></li><li><a class="tocitem" href="../zz_external_sources/"><code>external_sources</code></a></li><li><a class="tocitem" href="../zz_file_io/"><code>file_io</code></a></li><li><a class="tocitem" href="../zz_finite_differences/"><code>finite_differences</code></a></li><li><a class="tocitem" href="../zz_fokker_planck/"><code>fokker_planck</code></a></li><li><a class="tocitem" href="../zz_fokker_planck_calculus/"><code>fokker_planck_calculus</code></a></li><li><a class="tocitem" href="../zz_fokker_planck_test/"><code>fokker_planck_test</code></a></li><li><a class="tocitem" href="../zz_force_balance/"><code>force_balance</code></a></li><li><a class="tocitem" href="../zz_gauss_legendre/"><code>gauss_legendre</code></a></li><li><a class="tocitem" href="../zz_geo/"><code>geo</code></a></li><li><a class="tocitem" href="../zz_gyroaverages/"><code>gyroaverages</code></a></li><li><a class="tocitem" href="../zz_initial_conditions/"><code>initial_conditions</code></a></li><li><a class="tocitem" href="../zz_input_structs/"><code>input_structs</code></a></li><li><a class="tocitem" href="../zz_interpolation/"><code>interpolation</code></a></li><li><a class="tocitem" href="../zz_ionization/"><code>ionization</code></a></li><li><a class="tocitem" href="../zz_krook_collisions/"><code>krook_collisions</code></a></li><li><a class="tocitem" href="../zz_lagrange_polynomials/"><code>lagrange_polynomials</code></a></li><li><a class="tocitem" href="../zz_load_data/"><code>load_data</code></a></li><li><a class="tocitem" href="../zz_looping/"><code>looping</code></a></li><li><a class="tocitem" href="../zz_makie_post_processing/"><code>makie_post_processing</code></a></li><li><a class="tocitem" href="../zz_manufactured_solns/"><code>manufactured_solns</code></a></li><li><a class="tocitem" href="../zz_maxwell_diffusion/"><code>maxwell_diffusion</code></a></li><li><a class="tocitem" href="../zz_moment_constraints/"><code>moment_constraints</code></a></li><li><a class="tocitem" href="../zz_moment_kinetics/"><code>moment_kinetics</code></a></li><li><a class="tocitem" href="../zz_moment_kinetics_input/"><code>moment_kinetics_input</code></a></li><li><a class="tocitem" href="../zz_moment_kinetics_structs/"><code>moment_kinetics_structs</code></a></li><li><a class="tocitem" href="../zz_neutral_r_advection/"><code>neutral_r_advection</code></a></li><li><a class="tocitem" href="../zz_neutral_vz_advection/"><code>neutral_vz_advection</code></a></li><li><a class="tocitem" href="../zz_neutral_z_advection/"><code>neutral_z_advection</code></a></li><li><a class="tocitem" href="../zz_nonlinear_solvers/"><code>nonlinear_solvers</code></a></li><li><a class="tocitem" href="../zz_numerical_dissipation/"><code>numerical_dissipation</code></a></li><li><a class="tocitem" href="../zz_plot_MMS_sequence/"><code>plot_MMS_sequence</code></a></li><li><a class="tocitem" href="../zz_plot_sequence/"><code>plot_sequence</code></a></li><li><a class="tocitem" href="../zz_plots_post_processing/"><code>plots_post_processing</code></a></li><li><a class="tocitem" href="../zz_quadrature/"><code>quadrature</code></a></li><li><a class="tocitem" href="../zz_r_advection/"><code>r_advection</code></a></li><li><a class="tocitem" href="../zz_reference_parameters/"><code>reference_parameters</code></a></li><li><a class="tocitem" href="../zz_runge_kutta/"><code>runge_kutta</code></a></li><li><a class="tocitem" href="../zz_source_terms/"><code>source_terms</code></a></li><li><a class="tocitem" href="../zz_species_input/"><code>species_input</code></a></li><li><a class="tocitem" href="../zz_time_advance/"><code>time_advance</code></a></li><li><a class="tocitem" href="../zz_timer_utils/"><code>timer_utils</code></a></li><li><a class="tocitem" href="../zz_type_definitions/"><code>type_definitions</code></a></li><li><a class="tocitem" href="../zz_utils/"><code>utils</code></a></li><li><a class="tocitem" href="../zz_velocity_grid_transforms/"><code>velocity_grid_transforms</code></a></li><li><a class="tocitem" href="../zz_velocity_moments/"><code>velocity_moments</code></a></li><li><a class="tocitem" href="../zz_vpa_advection/"><code>vpa_advection</code></a></li><li><a class="tocitem" href="../zz_z_advection/"><code>z_advection</code></a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Manual setup</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Manual setup</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/mabarnes/moment_kinetics" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/mabarnes/moment_kinetics/blob/master/docs/src/manual_setup.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Manual-setup"><a class="docs-heading-anchor" href="#Manual-setup">Manual setup</a><a id="Manual-setup-1"></a><a class="docs-heading-anchor-permalink" href="#Manual-setup" title="Permalink"></a></h1><p>If you want or need to set up <code>moment_kinetics</code> without using <code>machines/machine_setup.sh</code>, you will need to follow at least the steps in the following sections.</p><h2 id="Install-Julia"><a class="docs-heading-anchor" href="#Install-Julia">Install Julia</a><a id="Install-Julia-1"></a><a class="docs-heading-anchor-permalink" href="#Install-Julia" title="Permalink"></a></h2><p>Download Julia from <a href="https://julialang.org/downloads/">https://julialang.org/downloads/</a>, and add it to your <code>$PATH</code> so you can execute it from the command line.</p><h2 id="Add-moment_kinetics-packages"><a class="docs-heading-anchor" href="#Add-moment_kinetics-packages">Add <code>moment_kinetics</code> packages</a><a id="Add-moment_kinetics-packages-1"></a><a class="docs-heading-anchor-permalink" href="#Add-moment_kinetics-packages" title="Permalink"></a></h2><p>Create a &#39;project&#39; in the top-level directory by creating an empty <code>Project.toml</code> file, e.g.</p><pre><code class="nohighlight hljs">$ touch Project.toml</code></pre><p>Without this <code>Project.toml</code> file, running <code>julia --project</code> will activate a global project, not one linked specificially to the repo you are in, which is likely to cause confusion if you have more than one copy of the <code>moment_kinetics</code> repo (experience suggests you are likely to end up with multiple copies eventually!).</p><p>To add the <code>moment_kinetics</code> package to your project, start Julia, enter &#39;Package mode&#39; by pressing &#39;]&#39; at the prompt and use <code>develop</code> (to exit &#39;Package mode&#39; and return to the usual <code>julia&gt;</code> prompt, press backspace):</p><pre><code class="language-julia hljs">$ julia --project
julia&gt; ]
pkg&gt; develop ./moment_kinetics/</code></pre><p>To allow post-processing add one or both of the post processing packages</p><pre><code class="language-julia hljs">pkg&gt; develop ./makie_post_processing/makie_post_processing/</code></pre><p>and/or</p><pre><code class="language-julia hljs">pkg&gt; develop ./plots_post_processing/plots_post_processing/</code></pre><p>To use the <code>run_moment_kinetics.jl</code> script, you will need to install <code>MPI</code> into the top-level project</p><pre><code class="language-julia hljs">pkg&gt; add MPI</code></pre><h2 id="Set-up-MPI"><a class="docs-heading-anchor" href="#Set-up-MPI">Set up MPI</a><a id="Set-up-MPI-1"></a><a class="docs-heading-anchor-permalink" href="#Set-up-MPI" title="Permalink"></a></h2><p>You probably want to use your system&#39;s MPI rather than a Julia-provided version. To do this add (in &#39;Package mode&#39;) the <code>MPIPreferences</code> package (<a href="https://juliaparallel.org/MPI.jl/stable/configuration/#using_system_mpi">documentation here</a>) and then use its <code>use_system_binary()</code> function.</p><pre><code class="language-julia hljs">pkg&gt; add MPIPreferences
pkg&gt; &lt;press &#39;backspace&#39;&gt;
julia&gt; using MPIPreferences
julia&gt; MPIPreferences.use_system_binary()</code></pre><p>Normally this should &#39;just work&#39;. Sometimes, for example if the MPI library file is named something other than <code>libmpi.so</code>, you might have to pass some keyword arguments to <code>use_system_binary()</code> - see <a href="https://juliaparallel.org/MPI.jl/stable/reference/mpipreferences/#MPIPreferences.use_system_binary">https://juliaparallel.org/MPI.jl/stable/reference/mpipreferences/#MPIPreferences.use_system_binary</a>.</p><h2 id="Using-the-native-Julia-MPI"><a class="docs-heading-anchor" href="#Using-the-native-Julia-MPI">Using the native Julia MPI</a><a id="Using-the-native-Julia-MPI-1"></a><a class="docs-heading-anchor-permalink" href="#Using-the-native-Julia-MPI" title="Permalink"></a></h2><p>As an alternative, you can also use the MPI that is shipped with Julia.</p><pre><code class="language-julia hljs">julia&gt; using MPI; MPI.install_mpiexecjl(force=true)
julia&gt; using MPIPreferences; MPIPreferences.use_jll_binary()</code></pre><p>The executable for the Julia MPI can be called from the root folder of the project with</p><pre><code class="nohighlight hljs">.julia/bin/mpiexecjl --project=./ -n N julia --project -O3 run_your_script.jl</code></pre><p>where <code>N</code> is the number of cores used.</p><h2 id="Miscellaneous-required-packages"><a class="docs-heading-anchor" href="#Miscellaneous-required-packages">Miscellaneous required packages</a><a id="Miscellaneous-required-packages-1"></a><a class="docs-heading-anchor-permalink" href="#Miscellaneous-required-packages" title="Permalink"></a></h2><p>For full functionality, including precompilation with</p><pre><code class="nohighlight hljs">$ julia --project -O3 precompile.jl</code></pre><p>and running of tests by</p><pre><code class="nohighlight hljs">$ julia --project -O3 -e &#39;include(&quot;moment_kinetics/test/runtests.jl&quot;)&#39;</code></pre><p>we require to install the following packages</p><pre><code class="nohighlight hljs">$ julia --project -O3
julia&gt; ]
pkg&gt; add PackageCompiler StatsBase SpecialFunctions Test </code></pre><h2 id="Link-HDF5"><a class="docs-heading-anchor" href="#Link-HDF5">Link HDF5</a><a id="Link-HDF5-1"></a><a class="docs-heading-anchor-permalink" href="#Link-HDF5" title="Permalink"></a></h2><p>To enable parallel I/O, you need to get HDF5.jl to use the system HDF5 library (which must be MPI-enabled and compiled using the same MPI as you run Julia with). To do this (see <a href="https://juliaio.github.io/HDF5.jl/stable/#Using-custom-or-system-provided-HDF5-binaries">the HDF5.jl docs</a>) add the <code>HDF5</code> package and use its <code>HDF5.API.set_libraries!()</code> function</p><pre><code class="language-julia hljs">pkg&gt; add HDF5
pkg&gt; &lt;press backspace&gt;
julia&gt; using HDF5
julia&gt; HDF5.API.set_libraries!(&quot;/path/to/your/hdf5/directory/libhdf5.so&quot;, &quot;/path/to/your/hdf5/directory/libhdf5_hl.so&quot;)</code></pre><p>JTO also found that (on a Linux laptop) it was necessary to compile HDF5 from source. The system-provided, MPI-linked libhdf5 depended on libcurl, and Julia links to an incompatible libcurl, causing an error. When compiled from source (enabling MPI!), HDF5 does not require libcurl (guess it is an optional dependency), avoiding the problem.</p><h2 id="Enable-MMS-features"><a class="docs-heading-anchor" href="#Enable-MMS-features">Enable MMS features</a><a id="Enable-MMS-features-1"></a><a class="docs-heading-anchor-permalink" href="#Enable-MMS-features" title="Permalink"></a></h2><p>To enable the &quot;method of manufactured solutions&quot; (MMS) features, install the <code>Symbolics</code> package (for more explanation, see <a href="../developing/#Optional-dependencies">Optional dependencies</a>)</p><pre><code class="language-julia hljs">pkg&gt; add Symbolics</code></pre><h2 id="Enable-NetCDF-output"><a class="docs-heading-anchor" href="#Enable-NetCDF-output">Enable NetCDF output</a><a id="Enable-NetCDF-output-1"></a><a class="docs-heading-anchor-permalink" href="#Enable-NetCDF-output" title="Permalink"></a></h2><p>If you want the option to output to NetCDF instead of HDF5, install the <code>NCDatasets</code> package (for more explanation, see <a href="../developing/#Optional-dependencies">Optional dependencies</a>)</p><pre><code class="language-julia hljs">pkg&gt; add NCDatasets</code></pre><h2 id="Set-up-Plots-based-plotting-routines"><a class="docs-heading-anchor" href="#Set-up-Plots-based-plotting-routines">Set up <code>Plots</code>-based plotting routines</a><a id="Set-up-Plots-based-plotting-routines-1"></a><a class="docs-heading-anchor-permalink" href="#Set-up-Plots-based-plotting-routines" title="Permalink"></a></h2><p>The <code>plots_post_processing</code> package has some functions that have to use <code>PyPlot</code> directly to access features not available through the <code>Plots</code> wrapper. This means that Julia has to be able to access an instance of Python which has <code>matplotlib</code> available. If you are going to use <code>plots_post_processing</code> you may well want to use the same Python that you use outside Julia (e.g. a system-provided Python) - to do so:</p><ul><li>Check that <code>matplotlib</code> is installed, e.g. check that<pre><code class="language-python hljs">$ python
&gt;&gt;&gt; import matplotlib</code></pre>completes without an error. If not, install matplotlib, for example with a command like<pre><code class="language-shell hljs">pip install --user matplotlib</code></pre></li><li>Set up Julia to use your chosen Python<pre><code class="language-julia hljs">$ which python
/your/python/location
$ julia -O3 --project
julia&gt; ENV[&quot;PYTHON&quot;]=&quot;/your/python/location&quot;
julia&gt; using Pkg; Pkg.build(&quot;PyCall&quot;)</code></pre></li></ul><h2 id="An-example-manual-setup-script"><a class="docs-heading-anchor" href="#An-example-manual-setup-script">An example manual setup script</a><a id="An-example-manual-setup-script-1"></a><a class="docs-heading-anchor-permalink" href="#An-example-manual-setup-script" title="Permalink"></a></h2><p>We include an example manual setup script below to show the process of carrying out the above steps together, for a case where no post processing is required, and we only desire to verify the install with an MPI test. We use the  native Julia MPI, and do not link to HDF5.</p><pre><code class="nohighlight hljs">#!/bin/bash
# simple moment_kinetics install script
# not supporting parallel HDF5
# not supporting diagnostics

# first time use, uncomment this
# otherwise, use from the moment_kinetics_install (root) folder 
git clone https://github.com/mabarnes/moment_kinetics.git moment_kinetics_test_install
cd moment_kinetics_test_install

# set up modules and environment variables
# need this everytime you use Julia
# e.g. module load julia/1.10.2
# this will be specific to your system
# JULIA_DEPOT_PATH must be set to be the same for each use of a specific install
export JULIA_DEPOT_PATH=$(pwd)/.julia

# develop moment_kinetics, no plots, no symbolic function tests
touch Project.toml
julia --project -O3 -e &#39;using Pkg; Pkg.develop(path=&quot;./moment_kinetics&quot;)&#39;
julia --project -O3 -e &#39;using Pkg; Pkg.add(&quot;MPIPreferences&quot;)&#39;
julia --project -O3 -e &#39;using Pkg; Pkg.add(&quot;MPI&quot;)&#39;
julia --project -O3 -e &#39;using Pkg; Pkg.add(&quot;Test&quot;)&#39;
julia --project -O3 -e &#39;using Pkg; Pkg.add(&quot;SpecialFunctions&quot;)&#39;
julia --project -O3 -e &#39;using Pkg; Pkg.add(&quot;PackageCompiler&quot;)&#39;
julia --project -O3 -e &#39;using Pkg; Pkg.add(&quot;StatsBase&quot;)&#39;

# setup MPI preferences and binary
julia --project -O3 -e &#39;using Pkg; Pkg.instantiate()&#39;
julia --project -O3 -e &#39;using Pkg; Pkg.resolve()&#39;
julia --project -O3 -e &#39;using MPI; MPI.install_mpiexecjl(force=true)&#39;
julia --project -O3 -e &#39;using MPIPreferences; MPIPreferences.use_jll_binary()
julia --project -O3 -e &#39;using Pkg; Pkg.instantiate()&#39;
julia --project -O3 -e &#39;using Pkg; Pkg.resolve()&#39;

# generate moment_kinetics.so
julia --project -O3 precompile.jl

# check install with tests
echo &quot;MPI test with precompiled moment_kinetics.so&quot;
.julia/bin/mpiexecjl --project=./ -n 2 julia --project -O3 -Jmoment_kinetics.so -e &#39;include(&quot;moment_kinetics/test/runtests.jl&quot;)&#39;</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../machine_setup_notes/">« <code>machine_setup</code> notes</a><a class="docs-footer-nextpage" href="../manufactured_solution_test_examples/">List of Manufactured Solutions Test TOML inputs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Thursday 10 April 2025 12:52">Thursday 10 April 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
