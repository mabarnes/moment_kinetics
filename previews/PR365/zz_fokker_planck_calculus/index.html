<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>fokker_planck_calculus · moment_kinetics</title><meta name="title" content="fokker_planck_calculus · moment_kinetics"/><meta property="og:title" content="fokker_planck_calculus · moment_kinetics"/><meta property="twitter:title" content="fokker_planck_calculus · moment_kinetics"/><meta name="description" content="Documentation for moment_kinetics."/><meta property="og:description" content="Documentation for moment_kinetics."/><meta property="twitter:description" content="Documentation for moment_kinetics."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">moment_kinetics</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../chebyshev/">Chebyshev tranform via Fourier transform</a></li><li><a class="tocitem" href="../constraints_on_normalized_distribution_function/">Constraints on normalized distribution function</a></li><li><a class="tocitem" href="../debugging-hints/">Debugging</a></li><li><a class="tocitem" href="../developing/">Developing</a></li><li><a class="tocitem" href="../external_sources_notes/">External sources</a></li><li><a class="tocitem" href="../fokker_planck_notes/">Fokker Planck collision operator</a></li><li><a class="tocitem" href="../geometry/">Magnetic Geometry</a></li><li><a class="tocitem" href="../getting_started/">Getting started</a></li><li><a class="tocitem" href="../input_options/">Input Options</a></li><li><a class="tocitem" href="../machine_setup_notes/"><code>machine_setup</code> notes</a></li><li><a class="tocitem" href="../manual_setup/">Manual setup</a></li><li><a class="tocitem" href="../manufactured_solution_test_examples/">List of Manufactured Solutions Test TOML inputs</a></li><li><a class="tocitem" href="../moment_kinetic_equations/">Moment kinetic equations</a></li><li><a class="tocitem" href="../parameter_scans/">Parameter scans</a></li><li><a class="tocitem" href="../post_processing_notes/">Post processing</a></li><li><a class="tocitem" href="../shared_memory_debugging/">Shared memory debugging</a></li><li><a class="tocitem" href="../timestepping/">Timestepping</a></li><li><a class="tocitem" href="../wall_boundary_conditions/">Wall boundary conditions with moment constraints</a></li><li><a class="tocitem" href="../zz_MKJacobianUtils/"><code>MKJacobianUtils</code></a></li><li><a class="tocitem" href="../zz_advection/"><code>advection</code></a></li><li><a class="tocitem" href="../zz_analysis/"><code>analysis</code></a></li><li><a class="tocitem" href="../zz_array_allocation/"><code>array_allocation</code></a></li><li><a class="tocitem" href="../zz_bgk/"><code>bgk</code></a></li><li><a class="tocitem" href="../zz_boundary_conditions/"><code>boundary_conditions</code></a></li><li><a class="tocitem" href="../zz_calculus/"><code>calculus</code></a></li><li><a class="tocitem" href="../zz_charge_exchange/"><code>charge_exchange</code></a></li><li><a class="tocitem" href="../zz_chebyshev/"><code>chebyshev</code></a></li><li><a class="tocitem" href="../zz_clenshaw_curtis/"><code>clenshaw_curtis</code></a></li><li><a class="tocitem" href="../zz_collision_frequencies/"><code>collision_frequencies</code></a></li><li><a class="tocitem" href="../zz_command_line_options/"><code>command_line_options</code></a></li><li><a class="tocitem" href="../zz_communication/"><code>communication</code></a></li><li><a class="tocitem" href="../zz_constants/"><code>constants</code></a></li><li><a class="tocitem" href="../zz_continuity/"><code>continuity</code></a></li><li><a class="tocitem" href="../zz_coordinates/"><code>coordinates</code></a></li><li><a class="tocitem" href="../zz_debugging/"><code>debugging</code></a></li><li><a class="tocitem" href="../zz_derivatives/"><code>derivatives</code></a></li><li><a class="tocitem" href="../zz_electron_fluid_equations/"><code>electron_fluid_equations</code></a></li><li><a class="tocitem" href="../zz_electron_kinetic_equation/"><code>electron_kinetic_equation</code></a></li><li><a class="tocitem" href="../zz_electron_vpa_advection/"><code>electron_vpa_advection</code></a></li><li><a class="tocitem" href="../zz_electron_z_advection/"><code>electron_z_advection</code></a></li><li><a class="tocitem" href="../zz_em_fields/"><code>em_fields</code></a></li><li><a class="tocitem" href="../zz_energy_equation/"><code>energy_equation</code></a></li><li><a class="tocitem" href="../zz_external_sources/"><code>external_sources</code></a></li><li><a class="tocitem" href="../zz_file_io/"><code>file_io</code></a></li><li><a class="tocitem" href="../zz_finite_differences/"><code>finite_differences</code></a></li><li><a class="tocitem" href="../zz_fokker_planck/"><code>fokker_planck</code></a></li><li class="is-active"><a class="tocitem" href><code>fokker_planck_calculus</code></a></li><li><a class="tocitem" href="../zz_fokker_planck_test/"><code>fokker_planck_test</code></a></li><li><a class="tocitem" href="../zz_force_balance/"><code>force_balance</code></a></li><li><a class="tocitem" href="../zz_gauss_legendre/"><code>gauss_legendre</code></a></li><li><a class="tocitem" href="../zz_geo/"><code>geo</code></a></li><li><a class="tocitem" href="../zz_gyroaverages/"><code>gyroaverages</code></a></li><li><a class="tocitem" href="../zz_initial_conditions/"><code>initial_conditions</code></a></li><li><a class="tocitem" href="../zz_input_structs/"><code>input_structs</code></a></li><li><a class="tocitem" href="../zz_interpolation/"><code>interpolation</code></a></li><li><a class="tocitem" href="../zz_ionization/"><code>ionization</code></a></li><li><a class="tocitem" href="../zz_krook_collisions/"><code>krook_collisions</code></a></li><li><a class="tocitem" href="../zz_lagrange_polynomials/"><code>lagrange_polynomials</code></a></li><li><a class="tocitem" href="../zz_load_data/"><code>load_data</code></a></li><li><a class="tocitem" href="../zz_looping/"><code>looping</code></a></li><li><a class="tocitem" href="../zz_makie_post_processing/"><code>makie_post_processing</code></a></li><li><a class="tocitem" href="../zz_manufactured_solns/"><code>manufactured_solns</code></a></li><li><a class="tocitem" href="../zz_maxwell_diffusion/"><code>maxwell_diffusion</code></a></li><li><a class="tocitem" href="../zz_moment_constraints/"><code>moment_constraints</code></a></li><li><a class="tocitem" href="../zz_moment_kinetics/"><code>moment_kinetics</code></a></li><li><a class="tocitem" href="../zz_moment_kinetics_input/"><code>moment_kinetics_input</code></a></li><li><a class="tocitem" href="../zz_moment_kinetics_structs/"><code>moment_kinetics_structs</code></a></li><li><a class="tocitem" href="../zz_neutral_r_advection/"><code>neutral_r_advection</code></a></li><li><a class="tocitem" href="../zz_neutral_vz_advection/"><code>neutral_vz_advection</code></a></li><li><a class="tocitem" href="../zz_neutral_z_advection/"><code>neutral_z_advection</code></a></li><li><a class="tocitem" href="../zz_nonlinear_solvers/"><code>nonlinear_solvers</code></a></li><li><a class="tocitem" href="../zz_numerical_dissipation/"><code>numerical_dissipation</code></a></li><li><a class="tocitem" href="../zz_plot_MMS_sequence/"><code>plot_MMS_sequence</code></a></li><li><a class="tocitem" href="../zz_plot_sequence/"><code>plot_sequence</code></a></li><li><a class="tocitem" href="../zz_plots_post_processing/"><code>plots_post_processing</code></a></li><li><a class="tocitem" href="../zz_quadrature/"><code>quadrature</code></a></li><li><a class="tocitem" href="../zz_r_advection/"><code>r_advection</code></a></li><li><a class="tocitem" href="../zz_reference_parameters/"><code>reference_parameters</code></a></li><li><a class="tocitem" href="../zz_runge_kutta/"><code>runge_kutta</code></a></li><li><a class="tocitem" href="../zz_source_terms/"><code>source_terms</code></a></li><li><a class="tocitem" href="../zz_species_input/"><code>species_input</code></a></li><li><a class="tocitem" href="../zz_time_advance/"><code>time_advance</code></a></li><li><a class="tocitem" href="../zz_timer_utils/"><code>timer_utils</code></a></li><li><a class="tocitem" href="../zz_type_definitions/"><code>type_definitions</code></a></li><li><a class="tocitem" href="../zz_utils/"><code>utils</code></a></li><li><a class="tocitem" href="../zz_velocity_grid_transforms/"><code>velocity_grid_transforms</code></a></li><li><a class="tocitem" href="../zz_velocity_moments/"><code>velocity_moments</code></a></li><li><a class="tocitem" href="../zz_vpa_advection/"><code>vpa_advection</code></a></li><li><a class="tocitem" href="../zz_z_advection/"><code>z_advection</code></a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href><code>fokker_planck_calculus</code></a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href><code>fokker_planck_calculus</code></a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/mabarnes/moment_kinetics" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/mabarnes/moment_kinetics/blob/master/docs/src/zz_fokker_planck_calculus.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="fokker_planck_calculus"><a class="docs-heading-anchor" href="#fokker_planck_calculus"><code>fokker_planck_calculus</code></a><a id="fokker_planck_calculus-1"></a><a class="docs-heading-anchor-permalink" href="#fokker_planck_calculus" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus" href="#moment_kinetics.fokker_planck_calculus"><code>moment_kinetics.fokker_planck_calculus</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Module for functions used  in calculating the integrals and doing  the numerical differentiation for  the implementation of the  the full-F Fokker-Planck collision operator <a href="../zz_fokker_planck/#moment_kinetics.fokker_planck"><code>moment_kinetics.fokker_planck</code></a>.</p><p>Parallelisation of the collision operator uses a special &#39;anyv&#39; region type, see <a href="../developing/#Collision-operator-and-anyv-region">Collision operator and <code>anyv</code> region</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L1-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.YY_collision_operator_arrays" href="#moment_kinetics.fokker_planck_calculus.YY_collision_operator_arrays"><code>moment_kinetics.fokker_planck_calculus.YY_collision_operator_arrays</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Struct to store the elemental nonlinear stiffness matrices used to express the finite-element weak form of the collision operator. The arrays are indexed so that the contraction in the assembly step is carried out over the fastest accessed indices, i.e., for <code>YY0perp[i,j,k,iel]</code>, we contract over <code>i</code> and <code>j</code> to give data for the field position index <code>k</code>, all for the 1D element indexed by <code>iel</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L233-L241">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.boundary_integration_weights_struct" href="#moment_kinetics.fokker_planck_calculus.boundary_integration_weights_struct"><code>moment_kinetics.fokker_planck_calculus.boundary_integration_weights_struct</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Struct to contain the integration weights for the boundary points in the <code>(vpa,vperp)</code> domain.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L182-L185">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.fokkerplanck_arrays_direct_integration_struct" href="#moment_kinetics.fokker_planck_calculus.fokkerplanck_arrays_direct_integration_struct"><code>moment_kinetics.fokker_planck_calculus.fokkerplanck_arrays_direct_integration_struct</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Struct of dummy arrays and precalculated coefficients for the Fokker-Planck collision operator when the Rosenbluth potentials are computed everywhere in <code>(vpa,vperp)</code> by direct integration. Used for testing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L149-L154">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.fokkerplanck_boundary_data_arrays_struct" href="#moment_kinetics.fokker_planck_calculus.fokkerplanck_boundary_data_arrays_struct"><code>moment_kinetics.fokker_planck_calculus.fokkerplanck_boundary_data_arrays_struct</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Struct used for storing the integration weights for the  boundary of the velocity space domain in <code>(vpa,vperp)</code> coordinates.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L192-L195">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.fokkerplanck_weakform_arrays_struct" href="#moment_kinetics.fokker_planck_calculus.fokkerplanck_weakform_arrays_struct"><code>moment_kinetics.fokker_planck_calculus.fokkerplanck_weakform_arrays_struct</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Struct of dummy arrays and precalculated coefficients for the finite-element weak-form Fokker-Planck collision operator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L272-L275">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.rosenbluth_potential_boundary_data" href="#moment_kinetics.fokker_planck_calculus.rosenbluth_potential_boundary_data"><code>moment_kinetics.fokker_planck_calculus.rosenbluth_potential_boundary_data</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Struct to store the boundary data for all of the Rosenbluth potentials required for the calculation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L218-L221">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.sparse_matrix_constructor" href="#moment_kinetics.fokker_planck_calculus.sparse_matrix_constructor"><code>moment_kinetics.fokker_planck_calculus.sparse_matrix_constructor</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Struct to contain data needed to create a sparse matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L85-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data" href="#moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data"><code>moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Struct to store the <code>(vpa,vperp)</code> boundary data for an individual Rosenbluth potential.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L208-L211">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.algebraic_solve!-Tuple{Any, Any, Any, moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data, Vararg{Any, 6}}" href="#moment_kinetics.fokker_planck_calculus.algebraic_solve!-Tuple{Any, Any, Any, moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data, Vararg{Any, 6}}"><code>moment_kinetics.fokker_planck_calculus.algebraic_solve!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Same as <code>elliptic_solve!()</code> above but no Dirichlet boundary conditions are imposed, because the function is only used where the <code>lu_object_lhs</code> is derived from a mass matrix. The source is made of two different terms with different weak matrices because of the form of the only algebraic equation that we consider.</p><p>Note: <code>algebraic_solve!()</code> run only in serial. They do not handle shared-memory parallelism themselves. The calling site must ensure that <code>algebraic_solve!()</code> is only called by one process in a shared-memory block.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L3288-L3297">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.allocate_boundary_data-Tuple{Any, Any}" href="#moment_kinetics.fokker_planck_calculus.allocate_boundary_data-Tuple{Any, Any}"><code>moment_kinetics.fokker_planck_calculus.allocate_boundary_data</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to allocate an instance of <code>vpa_vperp_boundary_data</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L1129-L1131">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.allocate_boundary_integration_weight-Tuple{Any, Any}" href="#moment_kinetics.fokker_planck_calculus.allocate_boundary_integration_weight-Tuple{Any, Any}"><code>moment_kinetics.fokker_planck_calculus.allocate_boundary_integration_weight</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to allocate a <code>boundary_integration_weights_struct</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L339-L341">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.allocate_boundary_integration_weights-Tuple{Any, Any}" href="#moment_kinetics.fokker_planck_calculus.allocate_boundary_integration_weights-Tuple{Any, Any}"><code>moment_kinetics.fokker_planck_calculus.allocate_boundary_integration_weights</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to allocate at <code>fokkerplanck_boundary_data_arrays_struct</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L352-L354">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.allocate_rosenbluth_potential_boundary_data-Tuple{Any, Any}" href="#moment_kinetics.fokker_planck_calculus.allocate_rosenbluth_potential_boundary_data-Tuple{Any, Any}"><code>moment_kinetics.fokker_planck_calculus.allocate_rosenbluth_potential_boundary_data</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to allocate an instance of <code>rosenbluth_potential_boundary_data</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L1168-L1170">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.allocate_sparse_matrix_constructor-Tuple{Int64}" href="#moment_kinetics.fokker_planck_calculus.allocate_sparse_matrix_constructor-Tuple{Int64}"><code>moment_kinetics.fokker_planck_calculus.allocate_sparse_matrix_constructor</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to allocate an instance of <code>sparse_matrix_constructor</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L97-L99">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.assemble_constructor_data!-Tuple{moment_kinetics.fokker_planck_calculus.sparse_matrix_constructor, Int64, Int64, Int64, Float64}" href="#moment_kinetics.fokker_planck_calculus.assemble_constructor_data!-Tuple{moment_kinetics.fokker_planck_calculus.sparse_matrix_constructor, Int64, Int64, Int64, Float64}"><code>moment_kinetics.fokker_planck_calculus.assemble_constructor_data!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to assemble data in an instance of <code>sparse_matrix_constructor</code>. Instead of writing <code>data.SS[icsc] = ss</code>, as in <code>assign_constructor_data!()</code> we write <code>data.SS[icsc] += ss</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L120-L123">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.assemble_explicit_collision_operator_rhs_parallel!-Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, moment_kinetics.fokker_planck_calculus.YY_collision_operator_arrays}" href="#moment_kinetics.fokker_planck_calculus.assemble_explicit_collision_operator_rhs_parallel!-Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, moment_kinetics.fokker_planck_calculus.YY_collision_operator_arrays}"><code>moment_kinetics.fokker_planck_calculus.assemble_explicit_collision_operator_rhs_parallel!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to assemble the RHS of the kinetic equation due to the collision operator, in weak form. Once the array <code>rhsvpavperp</code> contains the assembled weak-form collision operator, a mass matrix solve still must be carried out to find the time derivative of the distribution function due to collisions. This function uses a purely parallel algorithm and may be tested by comparing to  <code>assemble_explicit_collision_operator_rhs_serial!()</code>. The inner-most loop of the function is  in <code>assemble_explicit_collision_operator_rhs_parallel_inner_loop()</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L3028-L3035">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.assemble_explicit_collision_operator_rhs_parallel_analytical_inputs!-Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, moment_kinetics.fokker_planck_calculus.YY_collision_operator_arrays}" href="#moment_kinetics.fokker_planck_calculus.assemble_explicit_collision_operator_rhs_parallel_analytical_inputs!-Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, moment_kinetics.fokker_planck_calculus.YY_collision_operator_arrays}"><code>moment_kinetics.fokker_planck_calculus.assemble_explicit_collision_operator_rhs_parallel_analytical_inputs!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to assemble the RHS of the kinetic equation due to the collision operator, in weak form, when the distribution function appearing the derivatives is known analytically. The inner-most loop of the function is  in <code>assemble_explicit_collision_operator_rhs_parallel_analytical_inputs_inner_loop()</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L3127-L3132">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.assemble_explicit_collision_operator_rhs_parallel_inner_loop-NTuple{21, Any}" href="#moment_kinetics.fokker_planck_calculus.assemble_explicit_collision_operator_rhs_parallel_inner_loop-NTuple{21, Any}"><code>moment_kinetics.fokker_planck_calculus.assemble_explicit_collision_operator_rhs_parallel_inner_loop</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>The inner-most loop of the parallel collision operator assembly. Called in <code>assemble_explicit_collision_operator_rhs_parallel!()</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L3083-L3085">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.assemble_explicit_collision_operator_rhs_serial!-Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, moment_kinetics.fokker_planck_calculus.YY_collision_operator_arrays}" href="#moment_kinetics.fokker_planck_calculus.assemble_explicit_collision_operator_rhs_serial!-Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, moment_kinetics.fokker_planck_calculus.YY_collision_operator_arrays}"><code>moment_kinetics.fokker_planck_calculus.assemble_explicit_collision_operator_rhs_serial!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to assemble the RHS of the kinetic equation due to the collision operator, in weak form. Once the array <code>rhsvpavperp</code> contains the assembled weak-form collision operator, a mass matrix solve still must be carried out to find the time derivative of the distribution function due to collisions. This function uses a purely serial algorithm for testing purposes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L2960-L2965">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.assemble_matrix_operators_dirichlet_bc-NTuple{4, Any}" href="#moment_kinetics.fokker_planck_calculus.assemble_matrix_operators_dirichlet_bc-NTuple{4, Any}"><code>moment_kinetics.fokker_planck_calculus.assemble_matrix_operators_dirichlet_bc</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to contruct the global sparse matrices used to solve the elliptic PDEs for the Rosenbluth potentials. Uses a dense matrix construction method. The matrices are 2D in the compound index <code>ic</code>  which indexes the velocity space labelled by <code>ivpa,ivperp</code>. Dirichlet boundary conditions are imposed in the appropriate stiffness matrices by setting the boundary row to be the Kronecker delta  (0 except where <code>ivpa = ivpap</code> and <code>ivperp = ivperpp</code>).  Used for testing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L2069-L2078">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.assemble_matrix_operators_dirichlet_bc_sparse-NTuple{4, Any}" href="#moment_kinetics.fokker_planck_calculus.assemble_matrix_operators_dirichlet_bc_sparse-NTuple{4, Any}"><code>moment_kinetics.fokker_planck_calculus.assemble_matrix_operators_dirichlet_bc_sparse</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to contruct the global sparse matrices used to solve the elliptic PDEs for the Rosenbluth potentials. Uses a sparse matrix construction method. The matrices are 2D in the compound index <code>ic</code>  which indexes the velocity space labelled by <code>ivpa,ivperp</code>. Dirichlet boundary conditions are imposed in the appropriate stiffness matrices by setting the boundary row to be the Kronecker delta  (0 except where <code>ivpa = ivpap</code> and <code>ivperp = ivperpp</code>). See also <code>assemble_matrix_operators_dirichlet_bc()</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L2302-L2311">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.assign_constructor_data!-Tuple{moment_kinetics.fokker_planck_calculus.sparse_matrix_constructor, Int64, Int64, Int64, Float64}" href="#moment_kinetics.fokker_planck_calculus.assign_constructor_data!-Tuple{moment_kinetics.fokker_planck_calculus.sparse_matrix_constructor, Int64, Int64, Int64, Float64}"><code>moment_kinetics.fokker_planck_calculus.assign_constructor_data!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to assign data to an instance of <code>sparse_matrix_constructor</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L110-L112">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.assign_exact_boundary_data!-Tuple{moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data, Any, Any, Any}" href="#moment_kinetics.fokker_planck_calculus.assign_exact_boundary_data!-Tuple{moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data, Any, Any, Any}"><code>moment_kinetics.fokker_planck_calculus.assign_exact_boundary_data!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to assign precomputed (exact) data to an instance of <code>vpa_vperp_boundary_data</code>. Used in testing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L1147-L1150">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.calculate_YY_arrays-NTuple{4, Any}" href="#moment_kinetics.fokker_planck_calculus.calculate_YY_arrays-NTuple{4, Any}"><code>moment_kinetics.fokker_planck_calculus.calculate_YY_arrays</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to allocated an instance of <code>YY_collision_operator_arrays</code>. Calls <code>get_QQ_local!()</code> from <code>gauss_legendre</code>. Definitions of these nonlinear stiffness matrices can be found in the docs for <code>get_QQ_local!()</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L2918-L2922">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.calculate_boundary_data!-Tuple{moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data, Array{Float64, 4}, Any, Any, Any}" href="#moment_kinetics.fokker_planck_calculus.calculate_boundary_data!-Tuple{moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data, Array{Float64, 4}, Any, Any, Any}"><code>moment_kinetics.fokker_planck_calculus.calculate_boundary_data!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to carry out the direct integration of a formal definition of one of the Rosenbluth potentials, on the boundaries of the <code>(vpa,vperp)</code> domain,  using the precomputed integration weights with dimension 4. The result is stored in an instance of <code>vpa_vperp_boundary_data</code>. Used in testing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L1204-L1210">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.calculate_boundary_data!-Tuple{moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data, moment_kinetics.fokker_planck_calculus.boundary_integration_weights_struct, Any, Any, Any}" href="#moment_kinetics.fokker_planck_calculus.calculate_boundary_data!-Tuple{moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data, moment_kinetics.fokker_planck_calculus.boundary_integration_weights_struct, Any, Any, Any}"><code>moment_kinetics.fokker_planck_calculus.calculate_boundary_data!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to carry out the direct integration of a formal definition of one of the Rosenbluth potentials, on the boundaries of the <code>(vpa,vperp)</code> domain,  using the precomputed integration weights with dimension 3. The result is stored in an instance of <code>vpa_vperp_boundary_data</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L1239-L1244">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.calculate_boundary_data_multipole_G!-Tuple{moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data, Any, Any, Any}" href="#moment_kinetics.fokker_planck_calculus.calculate_boundary_data_multipole_G!-Tuple{moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data, Any, Any, Any}"><code>moment_kinetics.fokker_planck_calculus.calculate_boundary_data_multipole_G!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L1668">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.calculate_boundary_data_multipole_H!-Tuple{moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data, Any, Any, Any}" href="#moment_kinetics.fokker_planck_calculus.calculate_boundary_data_multipole_H!-Tuple{moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data, Any, Any, Any}"><code>moment_kinetics.fokker_planck_calculus.calculate_boundary_data_multipole_H!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L1613">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.calculate_boundary_data_multipole_d2Gdvpa2!-Tuple{moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data, Any, Any, Any}" href="#moment_kinetics.fokker_planck_calculus.calculate_boundary_data_multipole_d2Gdvpa2!-Tuple{moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data, Any, Any, Any}"><code>moment_kinetics.fokker_planck_calculus.calculate_boundary_data_multipole_d2Gdvpa2!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L1740">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.calculate_boundary_data_multipole_d2Gdvperp2!-Tuple{moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data, Any, Any, Any}" href="#moment_kinetics.fokker_planck_calculus.calculate_boundary_data_multipole_d2Gdvperp2!-Tuple{moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data, Any, Any, Any}"><code>moment_kinetics.fokker_planck_calculus.calculate_boundary_data_multipole_d2Gdvperp2!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L1704">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.calculate_boundary_data_multipole_d2Gdvperpdvpa!-Tuple{moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data, Any, Any, Any}" href="#moment_kinetics.fokker_planck_calculus.calculate_boundary_data_multipole_d2Gdvperpdvpa!-Tuple{moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data, Any, Any, Any}"><code>moment_kinetics.fokker_planck_calculus.calculate_boundary_data_multipole_d2Gdvperpdvpa!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L1722">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.calculate_boundary_data_multipole_dGdvperp!-Tuple{moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data, Any, Any, Any}" href="#moment_kinetics.fokker_planck_calculus.calculate_boundary_data_multipole_dGdvperp!-Tuple{moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data, Any, Any, Any}"><code>moment_kinetics.fokker_planck_calculus.calculate_boundary_data_multipole_dGdvperp!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L1686">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.calculate_boundary_data_multipole_dHdvpa!-Tuple{moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data, Any, Any, Any}" href="#moment_kinetics.fokker_planck_calculus.calculate_boundary_data_multipole_dHdvpa!-Tuple{moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data, Any, Any, Any}"><code>moment_kinetics.fokker_planck_calculus.calculate_boundary_data_multipole_dHdvpa!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L1632">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.calculate_boundary_data_multipole_dHdvperp!-Tuple{moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data, Any, Any, Any}" href="#moment_kinetics.fokker_planck_calculus.calculate_boundary_data_multipole_dHdvperp!-Tuple{moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data, Any, Any, Any}"><code>moment_kinetics.fokker_planck_calculus.calculate_boundary_data_multipole_dHdvperp!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L1650">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.calculate_rosenbluth_integrals!-NTuple{20, Any}" href="#moment_kinetics.fokker_planck_calculus.calculate_rosenbluth_integrals!-NTuple{20, Any}"><code>moment_kinetics.fokker_planck_calculus.calculate_rosenbluth_integrals!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to carry out the integration of the revelant distribution functions to form the required coefficients for the full-F operator. We assume that the weights are precalculated. The function takes as arguments the arrays of coefficients (which we fill), the required distributions, the precomputed weights, the indicies of the `field&#39; velocities, and the sizes of the primed vpa and vperp coordinates arrays.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L3536-L3544">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.calculate_rosenbluth_potential_boundary_data!-Tuple{moment_kinetics.fokker_planck_calculus.rosenbluth_potential_boundary_data, Union{moment_kinetics.fokker_planck_calculus.fokkerplanck_arrays_direct_integration_struct, moment_kinetics.fokker_planck_calculus.fokkerplanck_boundary_data_arrays_struct}, Vararg{Any, 5}}" href="#moment_kinetics.fokker_planck_calculus.calculate_rosenbluth_potential_boundary_data!-Tuple{moment_kinetics.fokker_planck_calculus.rosenbluth_potential_boundary_data, Union{moment_kinetics.fokker_planck_calculus.fokkerplanck_arrays_direct_integration_struct, moment_kinetics.fokker_planck_calculus.fokkerplanck_boundary_data_arrays_struct}, Vararg{Any, 5}}"><code>moment_kinetics.fokker_planck_calculus.calculate_rosenbluth_potential_boundary_data!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to call direct integration function <code>calculate_boundary_data!()</code> and  assign data to an instance of <code>rosenbluth_potential_boundary_data</code>, in place, without allocation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L1275-L1279">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.calculate_rosenbluth_potential_boundary_data_delta_f_multipole!-Tuple{moment_kinetics.fokker_planck_calculus.rosenbluth_potential_boundary_data, Vararg{Any, 6}}" href="#moment_kinetics.fokker_planck_calculus.calculate_rosenbluth_potential_boundary_data_delta_f_multipole!-Tuple{moment_kinetics.fokker_planck_calculus.rosenbluth_potential_boundary_data, Vararg{Any, 6}}"><code>moment_kinetics.fokker_planck_calculus.calculate_rosenbluth_potential_boundary_data_delta_f_multipole!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to use the multipole expansion of the Rosenbluth potentials to calculate and assign boundary data to an instance of <code>rosenbluth_potential_boundary_data</code>, in place, without allocation. Use the exact results for the part of F that can be described with  a Maxwellian, and the multipole expansion for the remainder.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L1835-L1840">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.calculate_rosenbluth_potential_boundary_data_exact!-Tuple{moment_kinetics.fokker_planck_calculus.rosenbluth_potential_boundary_data, Vararg{Any, 10}}" href="#moment_kinetics.fokker_planck_calculus.calculate_rosenbluth_potential_boundary_data_exact!-Tuple{moment_kinetics.fokker_planck_calculus.rosenbluth_potential_boundary_data, Vararg{Any, 10}}"><code>moment_kinetics.fokker_planck_calculus.calculate_rosenbluth_potential_boundary_data_exact!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to assign data to an instance of <code>rosenbluth_potential_boundary_data</code>, in place, without allocation. Used in testing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L1185-L1188">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.calculate_rosenbluth_potential_boundary_data_multipole!-Tuple{moment_kinetics.fokker_planck_calculus.rosenbluth_potential_boundary_data, Vararg{Any, 5}}" href="#moment_kinetics.fokker_planck_calculus.calculate_rosenbluth_potential_boundary_data_multipole!-Tuple{moment_kinetics.fokker_planck_calculus.rosenbluth_potential_boundary_data, Vararg{Any, 5}}"><code>moment_kinetics.fokker_planck_calculus.calculate_rosenbluth_potential_boundary_data_multipole!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to use the multipole expansion of the Rosenbluth potentials to calculate and assign boundary data to an instance of <code>rosenbluth_potential_boundary_data</code>, in place, without allocation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L1758-L1762">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.calculate_rosenbluth_potentials_via_analytical_Maxwellian!-NTuple{11, Any}" href="#moment_kinetics.fokker_planck_calculus.calculate_rosenbluth_potentials_via_analytical_Maxwellian!-NTuple{11, Any}"><code>moment_kinetics.fokker_planck_calculus.calculate_rosenbluth_potentials_via_analytical_Maxwellian!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to calculate Rosenbluth potentials for shifted Maxwellians using an analytical specification</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L3508-L3511">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.calculate_rosenbluth_potentials_via_elliptic_solve!-Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, moment_kinetics.fokker_planck_calculus.fokkerplanck_weakform_arrays_struct}" href="#moment_kinetics.fokker_planck_calculus.calculate_rosenbluth_potentials_via_elliptic_solve!-Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, moment_kinetics.fokker_planck_calculus.fokkerplanck_weakform_arrays_struct}"><code>moment_kinetics.fokker_planck_calculus.calculate_rosenbluth_potentials_via_elliptic_solve!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to solve the appropriate elliptic PDEs to find the Rosenbluth potentials. First, we calculate the Rosenbluth potentials at the boundary with the direct integration method. Then, we use this data to solve the elliptic PDEs with the boundary data providing an accurate Dirichlet boundary condition on the maximum <code>vpa</code> and <code>vperp</code> of the domain. We use the sparse LU decomposition from the LinearAlgebra package to solve the PDE matrix equations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L3323-L3331">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.create_sparse_matrix-Tuple{moment_kinetics.fokker_planck_calculus.sparse_matrix_constructor}" href="#moment_kinetics.fokker_planck_calculus.create_sparse_matrix-Tuple{moment_kinetics.fokker_planck_calculus.sparse_matrix_constructor}"><code>moment_kinetics.fokker_planck_calculus.create_sparse_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Wrapper function to create a sparse matrix with an instance of <code>sparse_matrix_constructor</code> and <code>sparse()</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L141-L144">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.elliptic_solve!-Tuple{Any, Any, moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data, Vararg{Any, 5}}" href="#moment_kinetics.fokker_planck_calculus.elliptic_solve!-Tuple{Any, Any, moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data, Vararg{Any, 5}}"><code>moment_kinetics.fokker_planck_calculus.elliptic_solve!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Elliptic solve function. </p><pre><code class="nohighlight hljs">field: the solution
source: the source function on the RHS
boundary data: the known values of field at infinity
lu_object_lhs: the object for the differential operator that defines field
matrix_rhs: the weak matrix acting on the source vector
vpa, vperp: coordinate structs</code></pre><p>Note: all variants of <code>elliptic_solve!()</code> run only in serial. They do not handle shared-memory parallelism themselves. The calling site must ensure that <code>elliptic_solve!()</code> is only called by one process in a shared-memory block.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L3227-L3240">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.enforce_dirichlet_bc!-NTuple{4, Any}" href="#moment_kinetics.fokker_planck_calculus.enforce_dirichlet_bc!-NTuple{4, Any}"><code>moment_kinetics.fokker_planck_calculus.enforce_dirichlet_bc!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Sets <code>f(vpa,vperp)</code> to a specied value <code>f_bc</code> at the boundaries in <code>(vpa,vperp)</code>. <code>f_bc</code> is a 2D array of <code>(vpa,vperp)</code> where only boundary data is used. Used for testing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L2018-L2022">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.enforce_dirichlet_bc!-Tuple{Any, Any, Any, moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data}" href="#moment_kinetics.fokker_planck_calculus.enforce_dirichlet_bc!-Tuple{Any, Any, Any, moment_kinetics.fokker_planck_calculus.vpa_vperp_boundary_data}"><code>moment_kinetics.fokker_planck_calculus.enforce_dirichlet_bc!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Sets <code>f(vpa,vperp)</code> to a specied value <code>f_bc</code> at the boundaries in <code>(vpa,vperp)</code>. <code>f_bc</code> is an instance of <code>vpa_vperp_boundary_data</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L2047-L2050">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.enforce_vpavperp_BCs!-NTuple{5, Any}" href="#moment_kinetics.fokker_planck_calculus.enforce_vpavperp_BCs!-NTuple{5, Any}"><code>moment_kinetics.fokker_planck_calculus.enforce_vpavperp_BCs!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to enforce boundary conditions on the collision operator result to be consistent with the boundary conditions imposed on the distribution function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L3578-L3582">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.enforce_zero_bc!-Tuple{Any, Any, Any}" href="#moment_kinetics.fokker_planck_calculus.enforce_zero_bc!-Tuple{Any, Any, Any}"><code>moment_kinetics.fokker_planck_calculus.enforce_zero_bc!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Unused function. Sets <code>f(vpa,vperp)</code> to zero at the boundaries in <code>(vpa,vperp)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L1990-L1993">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.get_element_limit_indices-NTuple{4, Any}" href="#moment_kinetics.fokker_planck_calculus.get_element_limit_indices-NTuple{4, Any}"><code>moment_kinetics.fokker_planck_calculus.get_element_limit_indices</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function for getting the indices used to choose the integration quadrature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L466-L468">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.get_global_compound_index-NTuple{6, Any}" href="#moment_kinetics.fokker_planck_calculus.get_global_compound_index-NTuple{6, Any}"><code>moment_kinetics.fokker_planck_calculus.get_global_compound_index</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_global_compound_index(vpa,vperp,ielement_vpa,ielement_vperp,ivpa_local,ivperp_local)</code></pre><p>For local (within the single element specified by <code>ielement_vpa</code> and <code>ielement_vperp</code>) indices <code>ivpa_local</code> and <code>ivperp_local</code>, get the global index in the &#39;linear-indexed&#39; 2d space of size <code>(vperp.n, vpa.n)</code> (as returned by <a href="#moment_kinetics.fokker_planck_calculus.ic_func-Tuple{Int64, Int64, Int64}"><code>ic_func</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L1974-L1980">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.get_scaled_x_w_no_divergences!-NTuple{6, Any}" href="#moment_kinetics.fokker_planck_calculus.get_scaled_x_w_no_divergences!-NTuple{6, Any}"><code>moment_kinetics.fokker_planck_calculus.get_scaled_x_w_no_divergences!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to get the local grid and integration weights assuming  no divergences of the function on the 1D element. Gauss-Legendre quadrature is used for the entire element.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L734-L738">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.get_scaled_x_w_with_divergences!-NTuple{11, Any}" href="#moment_kinetics.fokker_planck_calculus.get_scaled_x_w_with_divergences!-NTuple{11, Any}"><code>moment_kinetics.fokker_planck_calculus.get_scaled_x_w_with_divergences!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to get the local integration grid and quadrature weights to integrate a 1D element in the 2D representation of the  velocity space distribution functions. This function assumes that there is a divergence at the point <code>coord_val</code>, and splits the grid  and integration weights appropriately, using Gauss-Laguerre points near the divergence and Gauss-Legendre points away from the divergence. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L635-L642">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.ic_func-Tuple{Int64, Int64, Int64}" href="#moment_kinetics.fokker_planck_calculus.ic_func-Tuple{Int64, Int64, Int64}"><code>moment_kinetics.fokker_planck_calculus.ic_func</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ic_func(ivpa::mk_int,ivperp::mk_int,nvpa::mk_int)</code></pre><p>Get the &#39;linear index&#39; corresponding to <code>ivpa</code> and <code>ivperp</code>. Defined so that the linear index corresponds to the underlying layout in memory of a 2d array indexed by <code>[ivpa,ivperp]</code>, i.e. for a 2d array <code>f2d</code>:</p><ul><li><code>size(f2d) == (vpa.n, vperp.n)</code></li><li>For a reference to <code>f2d</code> that is reshaped to a vector (a 1d array) <code>f1d = vec(f2d)</code> than for any <code>ivpa</code> and <code>ivperp</code> it is true that <code>f1d[ic_func(ivpa,ivperp)] == f2d[ivpa,ivperp]</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L1063-L1073">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.icsc_func-NTuple{10, Int64}" href="#moment_kinetics.fokker_planck_calculus.icsc_func-NTuple{10, Int64}"><code>moment_kinetics.fokker_planck_calculus.icsc_func</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function that returns the sparse matrix index used to directly construct the nonzero entries of a 2D assembled sparse matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L1107-L1111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.ielement_loopup-Tuple{Any, Any}" href="#moment_kinetics.fokker_planck_calculus.ielement_loopup-Tuple{Any, Any}"><code>moment_kinetics.fokker_planck_calculus.ielement_loopup</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to find the element in which x sits.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L3722-L3724">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.init_Rosenbluth_potential_boundary_integration_weights!-NTuple{8, Any}" href="#moment_kinetics.fokker_planck_calculus.init_Rosenbluth_potential_boundary_integration_weights!-NTuple{8, Any}"><code>moment_kinetics.fokker_planck_calculus.init_Rosenbluth_potential_boundary_integration_weights!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function that precomputes the required integration weights only along the velocity space boundaries. Used as the default option as part of the strategy to compute the Rosenbluth potentials at the boundaries with direct integration and in the rest of <code>(vpa,vperp)</code> by solving elliptic PDEs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L485-L489">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.init_Rosenbluth_potential_integration_weights!-NTuple{8, Any}" href="#moment_kinetics.fokker_planck_calculus.init_Rosenbluth_potential_integration_weights!-NTuple{8, Any}"><code>moment_kinetics.fokker_planck_calculus.init_Rosenbluth_potential_integration_weights!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function that precomputes the required integration weights in the whole of <code>(vpa,vperp)</code> for the direct integration method of computing the Rosenbluth potentials.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L384-L387">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.interpolate_2D_vspace!-NTuple{5, Any}" href="#moment_kinetics.fokker_planck_calculus.interpolate_2D_vspace!-NTuple{5, Any}"><code>moment_kinetics.fokker_planck_calculus.interpolate_2D_vspace!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to interpolate <code>f(vpa,vperp)</code> from one  velocity grid to another, assuming that both  grids are represented by <code>(vpa,vperp)</code> in normalised units, but have different normalisation factors  defining the meaning of these grids in physical units. E.g.,</p><pre><code class="nohighlight hljs"> vpai, vperpi = ci * vpa, ci * vperp
 vpae, vperpe = ce * vpa, ce * vperp</code></pre><p>with <code>ci = sqrt(Ti/mi)</code>, <code>ce = sqrt(Te/mi)</code></p><p><code>scalefac = ci / ce</code> is the ratio of the two reference speeds.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L3634-L3648">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.ivpa_func-Tuple{Int64, Int64}" href="#moment_kinetics.fokker_planck_calculus.ivpa_func-Tuple{Int64, Int64}"><code>moment_kinetics.fokker_planck_calculus.ivpa_func</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ivpa_func(ic::mk_int,nvpa::mk_int)</code></pre><p>Get the <code>vpa</code> index <code>ivpa</code> that corresponds to a &#39;linear index&#39; <code>ic</code> that spans a 2d velocity space.</p><p>Defined so that <code>ivpa_func(inc_func(ivpa,ivperp,nvpa), nvpa) == ivpa</code>.</p><p>See also <a href="#moment_kinetics.fokker_planck_calculus.ic_func-Tuple{Int64, Int64, Int64}"><code>ic_func</code></a>, <a href="#moment_kinetics.fokker_planck_calculus.ivperp_func-Tuple{Int64, Int64}"><code>ivperp_func</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L1092-L1101">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.ivperp_func-Tuple{Int64, Int64}" href="#moment_kinetics.fokker_planck_calculus.ivperp_func-Tuple{Int64, Int64}"><code>moment_kinetics.fokker_planck_calculus.ivperp_func</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ivperp_func(ic::mk_int,nvpa::mk_int)</code></pre><p>Get the <code>vperp</code> index <code>ivperp</code> that corresponds to a &#39;linear index&#39; <code>ic</code> that spans a 2d velocity space.</p><p>Defined so that <code>ivperp_func(inc_func(ivpa,ivperp,nvpa), nvpa) == ivperp</code>.</p><p>See also <a href="#moment_kinetics.fokker_planck_calculus.ic_func-Tuple{Int64, Int64, Int64}"><code>ic_func</code></a>, <a href="#moment_kinetics.fokker_planck_calculus.ivpa_func-Tuple{Int64, Int64}"><code>ivpa_func</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L1078-L1087">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.local_element_integration!-NTuple{18, Any}" href="#moment_kinetics.fokker_planck_calculus.local_element_integration!-NTuple{18, Any}"><code>moment_kinetics.fokker_planck_calculus.local_element_integration!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Base level function for computing the integration kernals for the Rosenbluth potential integration. Note the definitions of <code>ellipe(m)</code> (<span>$E(m)$</span>) and <code>ellipk(m)</code> (<span>$K(m)$</span>). <code>https://specialfunctions.juliamath.org/stable/functions_list/#SpecialFunctions.ellipe</code> <code>https://specialfunctions.juliamath.org/stable/functions_list/#SpecialFunctions.ellipk</code></p><p class="math-container">\[E(m) = \int^{\pi/2}_0 \sqrt{ 1 - m \sin^2(\theta)} d \theta\]</p><p class="math-container">\[K(m) = \int^{\pi/2}_0 \frac{1}{\sqrt{ 1 - m \sin^2(\theta)}} d \theta\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L781-L792">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.loop_over_vpa_elements!-NTuple{23, Any}" href="#moment_kinetics.fokker_planck_calculus.loop_over_vpa_elements!-NTuple{23, Any}"><code>moment_kinetics.fokker_planck_calculus.loop_over_vpa_elements!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function for computing the quadratures and carrying out the loop over the  primed <code>vpa</code> coordinate in doing the numerical integration. Splits the integrand into three pieces – two which use Gauss-Legendre quadrature assuming no divergences in the integrand, and one which assumes a logarithmic divergence and uses a Gauss-Laguerre quadrature with an (exponential) change of variables to mitigate this divergence.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L883-L889">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.loop_over_vpa_elements_no_divergences!-NTuple{21, Any}" href="#moment_kinetics.fokker_planck_calculus.loop_over_vpa_elements_no_divergences!-NTuple{21, Any}"><code>moment_kinetics.fokker_planck_calculus.loop_over_vpa_elements_no_divergences!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function for computing the quadratures and carrying out the loop over the  primed <code>vpa</code> coordinate in doing the numerical integration.  Uses a Gauss-Legendre quadrature assuming no divergences in the integrand.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L943-L947">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.loop_over_vperp_vpa_elements!-NTuple{24, Any}" href="#moment_kinetics.fokker_planck_calculus.loop_over_vperp_vpa_elements!-NTuple{24, Any}"><code>moment_kinetics.fokker_planck_calculus.loop_over_vperp_vpa_elements!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function for computing the quadratures and carrying out the loop over the  primed <code>vperp</code> coordinate in doing the numerical integration. Splits the integrand into three pieces – two which use Gauss-Legendre quadrature assuming no divergences in the integrand, and one which assumes a logarithmic divergence and uses a Gauss-Laguerre quadrature with an (exponential) change of variables to mitigate this divergence. This function calls <code>loop_over_vpa_elements_no_divergences!()</code> and <code>loop_over_vpa_elements!()</code> to carry out the primed <code>vpa</code> loop within the primed <code>vperp</code> loop.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L971-L979">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.loop_over_vperp_vpa_elements_no_divergences!-NTuple{22, Any}" href="#moment_kinetics.fokker_planck_calculus.loop_over_vperp_vpa_elements_no_divergences!-NTuple{22, Any}"><code>moment_kinetics.fokker_planck_calculus.loop_over_vperp_vpa_elements_no_divergences!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>The function <code>loop_over_vperp_vpa_elements_no_divergences!()</code> was used for debugging. By changing the source where <code>loop_over_vperp_vpa_elements!()</code> is called to instead call this function we can verify that the Gauss-Legendre quadrature is adequate for integrating a divergence-free integrand. This function should be  kept until we understand the problems preventing machine-precision accurary in the pure integration method of computing the Rosenbluth potentials.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L1031-L1038">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.nel_hi-Tuple{Any, Any}" href="#moment_kinetics.fokker_planck_calculus.nel_hi-Tuple{Any, Any}"><code>moment_kinetics.fokker_planck_calculus.nel_hi</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function returns <code>1</code> for <code>nelement &gt; ielement &gt;= 1</code>, <code>0</code> for <code>ielement = nelement</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L774-L776">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.nel_low-Tuple{Any, Any}" href="#moment_kinetics.fokker_planck_calculus.nel_low-Tuple{Any, Any}"><code>moment_kinetics.fokker_planck_calculus.nel_low</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function returns <code>1</code> for <code>nelement &gt;= ielement &gt; 1</code>, <code>0</code> for <code>ielement = 1</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L767-L769">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.ng_hi-Tuple{Any, Any}" href="#moment_kinetics.fokker_planck_calculus.ng_hi-Tuple{Any, Any}"><code>moment_kinetics.fokker_planck_calculus.ng_hi</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function returns <code>1</code> if <code>igrid = ngrid</code> or <code>0</code> if <code>1 =&lt; igrid &lt; ngrid</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L760-L762">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.ng_low-Tuple{Any, Any}" href="#moment_kinetics.fokker_planck_calculus.ng_low-Tuple{Any, Any}"><code>moment_kinetics.fokker_planck_calculus.ng_low</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function returns <code>1</code> if <code>igrid = 1</code> or <code>0</code> if <code>1 &lt; igrid &lt;= ngrid</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L753-L755">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.setup_basic_quadratures-Tuple{Any, Any}" href="#moment_kinetics.fokker_planck_calculus.setup_basic_quadratures-Tuple{Any, Any}"><code>moment_kinetics.fokker_planck_calculus.setup_basic_quadratures</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function for getting the basic quadratures used for the  numerical integration of the Lagrange polynomials and the  integration kernals.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L439-L443">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.test_boundary_data-NTuple{9, Any}" href="#moment_kinetics.fokker_planck_calculus.test_boundary_data-NTuple{9, Any}"><code>moment_kinetics.fokker_planck_calculus.test_boundary_data</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to compute the maximum error <span>${\rm MAX}|f_{\rm numerical}-f_{\rm exact}|$</span> for instances of <code>vpa_vperp_boundary_data</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L1947-L1950">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="moment_kinetics.fokker_planck_calculus.test_rosenbluth_potential_boundary_data-Tuple{moment_kinetics.fokker_planck_calculus.rosenbluth_potential_boundary_data, moment_kinetics.fokker_planck_calculus.rosenbluth_potential_boundary_data, Any, Any}" href="#moment_kinetics.fokker_planck_calculus.test_rosenbluth_potential_boundary_data-Tuple{moment_kinetics.fokker_planck_calculus.rosenbluth_potential_boundary_data, moment_kinetics.fokker_planck_calculus.rosenbluth_potential_boundary_data, Any, Any}"><code>moment_kinetics.fokker_planck_calculus.test_rosenbluth_potential_boundary_data</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Function to compare two instances of <code>rosenbluth_potential_boundary_data</code> – one assumed to contain exact results, and the other numerically computed results – and compute the maximum value of the error. Calls <code>test_boundary_data()</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/5769693237a7ac9767c3a32d6bdc8a910d387fbd/moment_kinetics/src/fokker_planck_calculus.jl#L1924-L1928">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../zz_fokker_planck/">« <code>fokker_planck</code></a><a class="docs-footer-nextpage" href="../zz_fokker_planck_test/"><code>fokker_planck_test</code> »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.0 on <span class="colophon-date" title="Friday 9 May 2025 12:45">Friday 9 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
