<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Chebyshev tranform via Fourier transform Â· moment_kinetics</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">moment_kinetics</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Chebyshev tranform via Fourier transform</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Gauss-Chebyshev-Lobotto-points"><span>Gauss-Chebyshev-Lobotto points</span></a></li><li class="toplevel"><a class="tocitem" href="#Gauss-Chebyshev-Radau-points"><span>Gauss-Chebyshev-Radau points</span></a></li><li class="toplevel"><a class="tocitem" href="#Chebyshev-coefficients-of-derivatives-of-a-function"><span>Chebyshev coefficients of derivatives of a function</span></a></li><li class="toplevel"><a class="tocitem" href="#Clenshaw-Curtis-integration-weights"><span>Clenshaw-Curtis integration weights</span></a></li><li class="toplevel"><a class="tocitem" href="#Weights-on-Gauss-Chebyshev-Lobotto-points"><span>Weights on Gauss-Chebyshev-Lobotto points</span></a></li><li class="toplevel"><a class="tocitem" href="#Weights-on-Gauss-Chebyshev-Radau-points"><span>Weights on Gauss-Chebyshev-Radau points</span></a></li></ul></li><li><a class="tocitem" href="../constraints_on_normalized_distribution_function/">Constraints on normalized distribution function</a></li><li><a class="tocitem" href="../debugging-hints/">Debugging</a></li><li><a class="tocitem" href="../developing/">Developing</a></li><li><a class="tocitem" href="../external_sources_notes/">External sources</a></li><li><a class="tocitem" href="../fokker_planck_notes/">Fokker Planck collision operator</a></li><li><a class="tocitem" href="../geometry/">Magnetic Geometry</a></li><li><a class="tocitem" href="../getting_started/">Getting started</a></li><li><a class="tocitem" href="../input_options/">Input Options</a></li><li><a class="tocitem" href="../machine_setup_notes/"><code>machine_setup</code> notes</a></li><li><a class="tocitem" href="../manual_setup/">Manual setup</a></li><li><a class="tocitem" href="../manufactured_solution_test_examples/">List of Manufactured Solutions Test TOML inputs</a></li><li><a class="tocitem" href="../moment_kinetic_equations/">Moment kinetic equations</a></li><li><a class="tocitem" href="../parameter_scans/">Parameter scans</a></li><li><a class="tocitem" href="../post_processing_notes/">Post processing</a></li><li><a class="tocitem" href="../shared_memory_debugging/">Shared memory debugging</a></li><li><a class="tocitem" href="../timestepping/">Timestepping</a></li><li><a class="tocitem" href="../wall_boundary_conditions/">Wall boundary conditions with moment constraints</a></li><li><a class="tocitem" href="../zz_advection/"><code>advection</code></a></li><li><a class="tocitem" href="../zz_analysis/"><code>analysis</code></a></li><li><a class="tocitem" href="../zz_array_allocation/"><code>array_allocation</code></a></li><li><a class="tocitem" href="../zz_bgk/"><code>bgk</code></a></li><li><a class="tocitem" href="../zz_boundary_conditions/"><code>boundary_conditions</code></a></li><li><a class="tocitem" href="../zz_calculus/"><code>calculus</code></a></li><li><a class="tocitem" href="../zz_charge_exchange/"><code>charge_exchange</code></a></li><li><a class="tocitem" href="../zz_chebyshev/"><code>chebyshev</code></a></li><li><a class="tocitem" href="../zz_clenshaw_curtis/"><code>clenshaw_curtis</code></a></li><li><a class="tocitem" href="../zz_command_line_options/"><code>command_line_options</code></a></li><li><a class="tocitem" href="../zz_communication/"><code>communication</code></a></li><li><a class="tocitem" href="../zz_constants/"><code>constants</code></a></li><li><a class="tocitem" href="../zz_continuity/"><code>continuity</code></a></li><li><a class="tocitem" href="../zz_coordinates/"><code>coordinates</code></a></li><li><a class="tocitem" href="../zz_debugging/"><code>debugging</code></a></li><li><a class="tocitem" href="../zz_derivatives/"><code>derivatives</code></a></li><li><a class="tocitem" href="../zz_electron_fluid_equations/"><code>electron_fluid_equations</code></a></li><li><a class="tocitem" href="../zz_electron_kinetic_equation/"><code>electron_kinetic_equation</code></a></li><li><a class="tocitem" href="../zz_electron_vpa_advection/"><code>electron_vpa_advection</code></a></li><li><a class="tocitem" href="../zz_electron_z_advection/"><code>electron_z_advection</code></a></li><li><a class="tocitem" href="../zz_em_fields/"><code>em_fields</code></a></li><li><a class="tocitem" href="../zz_energy_equation/"><code>energy_equation</code></a></li><li><a class="tocitem" href="../zz_external_sources/"><code>external_sources</code></a></li><li><a class="tocitem" href="../zz_file_io/"><code>file_io</code></a></li><li><a class="tocitem" href="../zz_finite_differences/"><code>finite_differences</code></a></li><li><a class="tocitem" href="../zz_fokker_planck/"><code>fokker_planck</code></a></li><li><a class="tocitem" href="../zz_fokker_planck_calculus/"><code>fokker_planck_calculus</code></a></li><li><a class="tocitem" href="../zz_fokker_planck_test/"><code>fokker_planck_test</code></a></li><li><a class="tocitem" href="../zz_force_balance/"><code>force_balance</code></a></li><li><a class="tocitem" href="../zz_gauss_legendre/"><code>gauss_legendre</code></a></li><li><a class="tocitem" href="../zz_geo/"><code>geo</code></a></li><li><a class="tocitem" href="../zz_gyroaverages/"><code>gyroaverages</code></a></li><li><a class="tocitem" href="../zz_initial_conditions/"><code>initial_conditions</code></a></li><li><a class="tocitem" href="../zz_input_structs/"><code>input_structs</code></a></li><li><a class="tocitem" href="../zz_interpolation/"><code>interpolation</code></a></li><li><a class="tocitem" href="../zz_ionization/"><code>ionization</code></a></li><li><a class="tocitem" href="../zz_krook_collisions/"><code>krook_collisions</code></a></li><li><a class="tocitem" href="../zz_lagrange_polynomials/"><code>lagrange_polynomials</code></a></li><li><a class="tocitem" href="../zz_load_data/"><code>load_data</code></a></li><li><a class="tocitem" href="../zz_looping/"><code>looping</code></a></li><li><a class="tocitem" href="../zz_makie_post_processing/"><code>makie_post_processing</code></a></li><li><a class="tocitem" href="../zz_manufactured_solns/"><code>manufactured_solns</code></a></li><li><a class="tocitem" href="../zz_maxwell_diffusion/"><code>maxwell_diffusion</code></a></li><li><a class="tocitem" href="../zz_moment_constraints/"><code>moment_constraints</code></a></li><li><a class="tocitem" href="../zz_moment_kinetics/"><code>moment_kinetics</code></a></li><li><a class="tocitem" href="../zz_moment_kinetics_input/"><code>moment_kinetics_input</code></a></li><li><a class="tocitem" href="../zz_moment_kinetics_structs/"><code>moment_kinetics_structs</code></a></li><li><a class="tocitem" href="../zz_neutral_r_advection/"><code>neutral_r_advection</code></a></li><li><a class="tocitem" href="../zz_neutral_vz_advection/"><code>neutral_vz_advection</code></a></li><li><a class="tocitem" href="../zz_neutral_z_advection/"><code>neutral_z_advection</code></a></li><li><a class="tocitem" href="../zz_nonlinear_solvers/"><code>nonlinear_solvers</code></a></li><li><a class="tocitem" href="../zz_numerical_dissipation/"><code>numerical_dissipation</code></a></li><li><a class="tocitem" href="../zz_plot_MMS_sequence/"><code>plot_MMS_sequence</code></a></li><li><a class="tocitem" href="../zz_plot_sequence/"><code>plot_sequence</code></a></li><li><a class="tocitem" href="../zz_plots_post_processing/"><code>plots_post_processing</code></a></li><li><a class="tocitem" href="../zz_quadrature/"><code>quadrature</code></a></li><li><a class="tocitem" href="../zz_r_advection/"><code>r_advection</code></a></li><li><a class="tocitem" href="../zz_reference_parameters/"><code>reference_parameters</code></a></li><li><a class="tocitem" href="../zz_runge_kutta/"><code>runge_kutta</code></a></li><li><a class="tocitem" href="../zz_source_terms/"><code>source_terms</code></a></li><li><a class="tocitem" href="../zz_species_input/"><code>species_input</code></a></li><li><a class="tocitem" href="../zz_time_advance/"><code>time_advance</code></a></li><li><a class="tocitem" href="../zz_timer_utils/"><code>timer_utils</code></a></li><li><a class="tocitem" href="../zz_type_definitions/"><code>type_definitions</code></a></li><li><a class="tocitem" href="../zz_utils/"><code>utils</code></a></li><li><a class="tocitem" href="../zz_velocity_grid_transforms/"><code>velocity_grid_transforms</code></a></li><li><a class="tocitem" href="../zz_velocity_moments/"><code>velocity_moments</code></a></li><li><a class="tocitem" href="../zz_vpa_advection/"><code>vpa_advection</code></a></li><li><a class="tocitem" href="../zz_z_advection/"><code>z_advection</code></a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Chebyshev tranform via Fourier transform</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Chebyshev tranform via Fourier transform</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/mabarnes/moment_kinetics/blob/master/docs/src/chebyshev.md" title="Edit on GitHub"><span class="docs-icon fab">ï</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Chebyshev-tranform-via-Fourier-transform"><a class="docs-heading-anchor" href="#Chebyshev-tranform-via-Fourier-transform">Chebyshev tranform via Fourier transform</a><a id="Chebyshev-tranform-via-Fourier-transform-1"></a><a class="docs-heading-anchor-permalink" href="#Chebyshev-tranform-via-Fourier-transform" title="Permalink"></a></h1><p>We express a function <span>$f$</span> as a sum of Chebyshev polynomials</p><p class="math-container">\[\begin{equation}
f(x) = \sum^N_{n=0} a_{n}T_n(x) \tag{1}
\end{equation}\]</p><p>The Chebyshev polynomials are defined by </p><p class="math-container">\[\begin{equation}
T_n(\cos \theta) = \cos n \theta, {\rm~with~}x = \cos \theta.
\end{equation}\]</p><p>We can see how to find <span>$\{a_{n}\}$</span> given <span>$\{f(x_j)\}$</span> via Fourier transform.  The Fourier series representation of <span>$f$</span> on a uniform grid indexed by <span>$j$</span> is defined by </p><p class="math-container">\[\begin{equation}
f_j = \sum_{k=0}^{M-1} b_{k}\exp\left[i \frac{2\pi k j}{M}\right].\tag{2}
\end{equation}\]</p><h1 id="Gauss-Chebyshev-Lobotto-points"><a class="docs-heading-anchor" href="#Gauss-Chebyshev-Lobotto-points">Gauss-Chebyshev-Lobotto points</a><a id="Gauss-Chebyshev-Lobotto-points-1"></a><a class="docs-heading-anchor-permalink" href="#Gauss-Chebyshev-Lobotto-points" title="Permalink"></a></h1><p>We pick points </p><p class="math-container">\[\begin{equation}
x_j = \cos \theta_j, \quad \theta_j = \frac{j \pi}{N} \quad 0 \leq j \leq N.
\end{equation}\]</p><p>Then </p><p class="math-container">\[\begin{equation}
T_n(x_j) = \cos \frac{n j \pi}{N}.
\end{equation}\]</p><p>Assuming that <span>$M = 2N$</span>, with <span>$N$</span> an integer, and <span>$b_{k} = b_{M-k}$</span> for <span>$k&gt;0$</span>, we have that </p><p class="math-container">\[\begin{equation}
f_j = b_{0} + b_{N}(-1)^j + \sum_{n=1}^{N-1}
b_{n}\left(\exp\left[i \frac{\pi n j}{N}\right]+\exp\left[-i \frac{\pi n j}{N}\right]\right).
\end{equation}\]</p><p>Comparing this to the expression for <span>$f(x_j)$</span> in the Chebyshev representation,</p><p class="math-container">\[\begin{equation}
f_j = a_{0} + a_{N}(-1)^j + \frac{1}{2}\sum_{n=1}^{N-1}
a_{n}\left(\exp\left[i \frac{\pi n j}{N}\right]+\exp\left[-i \frac{\pi n j}{N}\right]\right),
\end{equation}\]</p><p>we find that the Chebyshev representation on the Chebyshev points is equivalent  to the Fourier representation on the uniform grid points, if we identify</p><p class="math-container">\[\begin{equation}
b_{0} = a_{0}, \quad  b_{N} = a_{N}, \quad b_{j} = \frac{a_{j}}{2} {\rm~for~} 1 \leq j \leq N-1.
\end{equation}\]</p><p>This fact allows us to carry out the Chebyshev tranform by Fourier transforming the <span>$\{f_j\}$</span> data and carrying out the correct normalisation of the resulting coefficients. </p><h1 id="Gauss-Chebyshev-Radau-points"><a class="docs-heading-anchor" href="#Gauss-Chebyshev-Radau-points">Gauss-Chebyshev-Radau points</a><a id="Gauss-Chebyshev-Radau-points-1"></a><a class="docs-heading-anchor-permalink" href="#Gauss-Chebyshev-Radau-points" title="Permalink"></a></h1><p>The last subsection dealt with grids which contain both endpoints on the <span>$[-1,1]$</span> domain.  Certain problems require domains which contain a single endpoint, i.e., <span>$x \in (-1,1]$</span>. For  these cases we choose the points </p><p class="math-container">\[\begin{equation}
x_j = \cos \theta_j, \quad \theta_j = \frac{2 j \pi}{2 N + 1} \quad 0 \leq j \leq N.
\end{equation}\]</p><p>Writing out the Chebyshev series (1), we have that </p><p class="math-container">\[\begin{equation}
\begin{split}f(x_j) = &amp; \sum^N_{n=0} a_{n} \cos \frac{2 n j \pi}{2 N + 1} \\ &amp;
= a_{0} + \sum^N_{n=1} \frac{a_{n}}{2}\left(\exp\left[i \frac{2\pi n j}{2N +1}\right] + \exp\left[-i \frac{2\pi n j}{2N +1}\right]\right).\end{split}
\tag{3}
\end{equation}\]</p><p>The form of the series (3) is identical to the form of  a Fourier series on an odd number of points, i.e., taking <span>$M = 2 N + 1$</span> in equation (2), and assuming <span>$b_{k} = b_{M -k}$</span> for <span>$k&gt;1$</span>, we have that </p><p class="math-container">\[\begin{equation}
f_j = b_{0} + \sum_{k=1}^{N} b_{k}\left(\exp\left[i \frac{2\pi k j}{2N+1}\right] + \exp\left[-i \frac{2\pi k j}{2N+1} \right]\right).
\end{equation}\]</p><p>We can thus take a Chebyshev transform using a Fourier transform on Gauss-Chebyshev-Radau points if we identify </p><p class="math-container">\[\begin{equation}
b_{0} = a_{0}, \quad b_{j} = \frac{a_{j}}{2} {\rm~for~} 1 \leq j \leq N.
\end{equation}\]</p><h1 id="Chebyshev-coefficients-of-derivatives-of-a-function"><a class="docs-heading-anchor" href="#Chebyshev-coefficients-of-derivatives-of-a-function">Chebyshev coefficients of derivatives of a function</a><a id="Chebyshev-coefficients-of-derivatives-of-a-function-1"></a><a class="docs-heading-anchor-permalink" href="#Chebyshev-coefficients-of-derivatives-of-a-function" title="Permalink"></a></h1><p>Starting from the expression of <span>$f$</span> as a sum Chebyshev polynomials, equation (1), we can obtain an expression for the derivative</p><p class="math-container">\[\begin{equation}
\frac{d f}{d x} = \sum^N_{n=0} a_{n}\frac{d T_{n}}{d x}.\tag{4}
\end{equation}\]</p><p>We note that we must be able to express <span>${d f}/{d x}$</span> as a sum  of Chebyshev polynomials of up to order <span>$N-1$</span>, i.e.,</p><p class="math-container">\[\begin{equation}
\frac{d f}{d x} = \sum^{N-1}_{n=0} d_{n}T_{n}.
\end{equation}\]</p><p>We must determine the set <span>$\{d_{n}\}$</span> in terms of the set <span>$\{a_{n}\}$</span>. First, we equate the two expressions to find that </p><p class="math-container">\[\begin{equation}
\sum^N_{k=0} a_{k}\frac{d T_{k}}{d x} = \sum^{N-1}_{n=0} d_{n}T_{n}.\tag{5}
\end{equation}\]</p><p>We use the Chebyshev polynomials of the second kind <span>$U_n{x}$</span> to aid us in the calculation of the set <span>$\{d_{n}\}$</span>.  These polynomials are defined by </p><p class="math-container">\[\begin{equation}
U_{0}(x) = 1, \quad U_{1}(x) = 2x, \quad U_{n+1} = 2 x U_{n}(x) - U_{n-1}(x).
\end{equation}\]</p><p>Note the useful relations </p><p class="math-container">\[\begin{equation}
\frac{d T_{n}}{d x} = n U_{n-1}, {\rm~for~}n\geq 1, \quad \frac{d T_{0}}{d x} = 0,
\end{equation}\]</p><p class="math-container">\[\begin{equation}
T_{n} = \frac{1}{2}\left(U_{n} - U_{n -2}\right), T_{0} = U_{0}\quad, {\rm ~and~} \quad 2 T_{1} = U_{1}.
\end{equation}\]</p><p>Using these identities, which may be obtained from the trigonometric definition of <span>$U_{n}(\cos \theta)$</span></p><p class="math-container">\[\begin{equation}
U_{n}(\cos \theta) \sin \theta = \sin \left((n+1)\theta\right),
\end{equation}\]</p><p>we find that equation (5) becomes </p><p class="math-container">\[\begin{equation}
\begin{split}\sum^N_{n=1} a_{n} n U_{n-1}(x) =&amp; \frac{d_{N-1}}{2}U_{N-1}+\frac{d_{N-2}}{2}U_{N-2} 
\\ &amp; + \sum^{N-3}_{k=1} \frac{d_{k}-d_{k+2}}{2}U_{k} + \left(d_{0} - \frac{d_{2}}{2}\right)U_{0}. \end{split}\tag{6}
\end{equation}\]</p><p>Using the orthogonality relation </p><p class="math-container">\[\begin{equation}
\int^1_{-1} U_{m}(x)U_{n}(x)\sqrt{1-x^2} \; d x = 
\left\{\begin{array}{l} 0 {\rm ~if~} n\neq m  \\ \pi/2 {\rm ~if~} n=m \\ \end{array} \right.
\end{equation}\]</p><p>we obtain the (unqiuely-determined) relations </p><p class="math-container">\[\begin{equation}
\begin{split} &amp;d_{N-1} = 2Na_{N},\quad d_{N-2} = 2(N-1)a_{N-1}, \\ 
&amp; d_{k} = 2(k+1) a_{k+1} + d_{k+2}, \quad d_{0} = \frac{d_{2}}{2} + a_{1}.\end{split}\tag{7}
\end{equation}\]</p><h1 id="Clenshaw-Curtis-integration-weights"><a class="docs-heading-anchor" href="#Clenshaw-Curtis-integration-weights">Clenshaw-Curtis integration weights</a><a id="Clenshaw-Curtis-integration-weights-1"></a><a class="docs-heading-anchor-permalink" href="#Clenshaw-Curtis-integration-weights" title="Permalink"></a></h1><p>We require the integration weights for the set of points <span>$\{x_j\}$</span> chosen  in our numerical scheme. The weights <span>$w_{j}$</span> are defined implicitly by </p><p class="math-container">\[\begin{equation}
\int^{1}_{-1} f(x) \; d x = \sum_{j=0}^N f(x_j) w_{j}.\tag{8}
\end{equation}\]</p><p>In the Chebyshev scheme we use the change of variables <span>$x = \cos \theta$</span> to write </p><p class="math-container">\[\begin{equation}
\int^{1}_{-1} f(x) \; d x = \int^\pi_0 f(\cos\theta) \sin \theta \; d \theta .\tag{9}
\end{equation}\]</p><p>Using the series expansion (1) in equation (9)  we find that </p><p class="math-container">\[\begin{equation}
\int^{1}_{-1} f(x) \; d x = \sum^N_{n=0} a_{n}\int^\pi_0 \cos (n \theta) \sin \theta \; d \theta
.\tag{10}
\end{equation}\]</p><p>Note the integral identity</p><p class="math-container">\[\begin{equation}
\int^\pi_0 \cos(n \theta) \sin \theta \; d \theta = \frac{\cos(n \pi) +1}{1 - n^2} {\rm~for~} n \geq 0.
\end{equation}\]</p><p>Also note that </p><p class="math-container">\[\begin{equation}
\frac{\cos(n \pi) +1}{1 - n^2} = \left\{\begin{array}{l} 0 {\rm ~if~} n = 2 r + 1, ~r \in \mathbb{Z}  \\ 2/(1 - n^2) {\rm ~if~} n=2r,~r. \in \mathbb{Z}  \end{array}\right.
\end{equation}\]</p><p>We define </p><p class="math-container">\[\begin{equation}
J_{n} = \frac{\cos(n \pi) +1}{1 - n^2}.
\end{equation}\]</p><p>Using this definition, we can write the integral of <span>$f(x)$</span> can be written  in terms of a sum over of the Chebyshev coefficients:</p><p class="math-container">\[\begin{equation}
\int^{1}_{-1} f(x) \; d x = \sum_{n=0}^N J_{n} a_{n}.\tag{11}
\end{equation}\]</p><p>To avoid computing the set of coefficients <span>$\{a_{n}\}$</span> every time we wish to integrate <span>$f(x_j)$</span>, we use the inverse transforms. This transform allows us to rewrite equation (11) in the form (8). Since the inverse transform differs between the Gauss-Chebyshev-Lobotto and Gauss-Chebyshev-Radau cases, we treat each  case separately below. </p><h1 id="Weights-on-Gauss-Chebyshev-Lobotto-points"><a class="docs-heading-anchor" href="#Weights-on-Gauss-Chebyshev-Lobotto-points">Weights on Gauss-Chebyshev-Lobotto points</a><a id="Weights-on-Gauss-Chebyshev-Lobotto-points-1"></a><a class="docs-heading-anchor-permalink" href="#Weights-on-Gauss-Chebyshev-Lobotto-points" title="Permalink"></a></h1><p>We use the inverse transformation </p><p class="math-container">\[\begin{equation}
a_{n} = \frac{q_{n}}{2N}\sum^{2N-1}_{j=0} \hat{f}_j \exp\left[- i \frac{2\pi n j}{2N}\right], \tag{12}
\end{equation}\]</p><p>where </p><p class="math-container">\[\begin{equation}
q_{n} = \left\{\begin{array}{l} 2 {\rm ~if~} n\neq0,N  \\ 1 {\rm ~if~} n=0,N  \end{array}\right.
\end{equation}\]</p><p>and <span>$\hat{f}_j$</span> is <span>$f(x_j)$</span> on the extended domain in FFT order, i.e.,</p><p class="math-container">\[\begin{equation}
\hat{f}_j = f(x_{j}) {\rm~for~} 0 \leq j \leq N ,\quad \hat{f}_j = f(x_{2N-j}){\rm~for~} N+1 \leq j \leq 2N-1.
\end{equation}\]</p><p>With this inverse tranformation, we can write </p><p class="math-container">\[\begin{equation}
\begin{split}\sum_{n=0}^N J_{n} a_{n} &amp; =  \sum^{2N-1}_{n=0} \frac{a_{n}J_{n}}{q_{n}} \\
&amp; = \sum^{2N-1}_{j=0}\sum^{2N-1}_{n=0} \frac{\hat{f}_j J_{n}}{2N} \exp\left[-i \frac{2\pi n j}{2N}\right] \\ 
&amp; = \sum^{2N-1}_{j=0} \hat{f}_j v_{j} = \sum^{N}_{j=0} \hat{f}_j q_{j}v_{j},\end{split}\tag{13}
\end{equation}\]</p><p>where in the first step we have extended the sum from <span>$N$</span> to <span>$2N-1$</span> and used FFT-order definitions of <span>$J_{n}$</span> and <span>$a_{n}$</span></p><p class="math-container">\[\begin{equation}
J_{j} = J_{2N-j}, {\rm~for~} N+1 \leq j \leq 2N-1,
\end{equation}\]</p><p class="math-container">\[\begin{equation}
a_{j} = a_{2N-j}, {\rm~for~} N+1 \leq j \leq 2N-1.
\end{equation}\]</p><p>In the second step we use the definition of the inverse transform (14) , and  in the third step we define </p><p class="math-container">\[\begin{equation}
v_{j} = \sum_{n=0}^{2N-1}\frac{J_{n}}{2N}\exp\left[-i \frac{2\pi n j}{2N}\right].
\end{equation}\]</p><p>Finally, we can compare equations (8) and (13) and deduce that </p><p class="math-container">\[\begin{equation}
w_{j} = q_{j}v_{j} {\rm~for~} 0 \leq j \leq N.
\end{equation}\]</p><p>We can write <span>$v_{j}$</span> in terms of a discrete cosine transform, i.e.,</p><p class="math-container">\[\begin{equation}
v_{j} = \frac{1}{2N}\left(J_{0} + (-1)^jJ_{N} + 2\sum_{n=1}^{N-1}J_{n}\cos\left(\frac{\pi n j}{N}\right)\right).
\end{equation}\]</p><h1 id="Weights-on-Gauss-Chebyshev-Radau-points"><a class="docs-heading-anchor" href="#Weights-on-Gauss-Chebyshev-Radau-points">Weights on Gauss-Chebyshev-Radau points</a><a id="Weights-on-Gauss-Chebyshev-Radau-points-1"></a><a class="docs-heading-anchor-permalink" href="#Weights-on-Gauss-Chebyshev-Radau-points" title="Permalink"></a></h1><p>We use the inverse transformation </p><p class="math-container">\[\begin{equation}
a_{n} = \frac{q_{n}}{2N+1}\sum^{2N}_{j=0} \hat{f}_j \exp\left[- i \frac{2\pi n j}{2N+1}\right],\tag{14}
\end{equation}\]</p><p>where </p><p class="math-container">\[\begin{equation}
q_{n} = \left\{\begin{array}{l} 2 {\rm ~if~} n &gt; 0  \\ 1 {\rm ~if~} n=0  \end{array}\right.
\end{equation}\]</p><p>and <span>$\hat{f}_j$</span> is <span>$f(x_j)$</span> on the extended domain in FFT order, i.e.,</p><p class="math-container">\[\begin{equation}
\hat{f}_j = f(x_{j}) {\rm~for~} 0 \leq j \leq N ,\quad \hat{f}_j = f(x_{2N-j+1}){\rm~for~} N+1 \leq j \leq 2N.
\end{equation}\]</p><p>Note that the details of what is the appropriate FFT order depends on the order in which the points <span>$x_j$</span> are stored. The key detail in the Chebyshev-Radau scheme is that (in the notation above) <span>$x_0 = 1$</span> is not a repeated point, and must occupy <span>$\hat{f}_0$</span>.  With this inverse tranformation, we can write </p><p class="math-container">\[\begin{equation}
\begin{split}\sum_{n=0}^N J_{n} a_{n} &amp; =  \sum^{2N}_{n=0} \frac{a_{n}J_{n}}{q_{n}} \\
&amp; = \sum^{2N}_{j=0}\sum^{2N}_{n=0} \frac{\hat{f}_j J_{n}}{2N+1} \exp\left[-i \frac{2\pi n j}{2N+1}\right] \\ 
&amp; = \sum^{2N}_{j=0} \hat{f}_j v_{j} = \sum^{N}_{j=0} \hat{f}_j q_{j}v_{j},\end{split}\tag{15}\end{equation}\]</p><p>where in the first step we have extended the sum from <span>$N$</span> to <span>$2N$</span> and used FFT-order definitions of <span>$J_{n}$</span> and <span>$a_{n}$</span></p><p class="math-container">\[\begin{equation}
J_{j} = J_{2N+1-j}, {\rm~for~} N+1 \leq j \leq 2N,
\end{equation}\]</p><p class="math-container">\[\begin{equation}
a_{j} = a_{2N+1-j}, {\rm~for~} N+1 \leq j \leq 2N.
\end{equation}\]</p><p>In the second step we use the definition of the inverse transform (14), and  in the third step we define </p><p class="math-container">\[\begin{equation}
v_{j} = \sum_{n=0}^{2N}\frac{J_{n}}{2N+1}\exp\left[-i \frac{2\pi n j}{2N+1}\right].
\end{equation}\]</p><p>Finally, we can compare equations (8) and (15) and deduce that </p><p class="math-container">\[\begin{equation}
w_{j} = q_{j}v_{j} {\rm~for~} 0 \leq j \leq N.
\end{equation}\]</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">Â« Home</a><a class="docs-footer-nextpage" href="../constraints_on_normalized_distribution_function/">Constraints on normalized distribution function Â»</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Monday 13 January 2025 12:32">Monday 13 January 2025</span>. Using Julia version 1.10.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
