<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>time_advance · moment_kinetics</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">moment_kinetics</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../constraints_on_normalized_distribution_function/">Constraints on normalized distribution function</a></li><li><a class="tocitem" href="../debugging-hints/">Debugging</a></li><li><a class="tocitem" href="../developing/">Developing</a></li><li><a class="tocitem" href="../external_sources_notes/">External sources</a></li><li><a class="tocitem" href="../geometry/">Magnetic Geometry</a></li><li><a class="tocitem" href="../getting_started/">Getting started</a></li><li><a class="tocitem" href="../input_options/">Input Options</a></li><li><a class="tocitem" href="../machine_setup_notes/"><code>machine_setup</code> notes</a></li><li><a class="tocitem" href="../manual_setup/">Manual setup</a></li><li><a class="tocitem" href="../moment_kinetic_equations/">Moment kinetic equations</a></li><li><a class="tocitem" href="../parameter_scans/">Parameter scans</a></li><li><a class="tocitem" href="../post_processing_notes/">Post processing</a></li><li><a class="tocitem" href="../shared_memory_debugging/">Shared memory debugging</a></li><li><a class="tocitem" href="../timestepping/">Timestepping</a></li><li><a class="tocitem" href="../wall_boundary_conditions/">Wall boundary conditions with moment constraints</a></li><li><a class="tocitem" href="../zz_advection/"><code>advection</code></a></li><li><a class="tocitem" href="../zz_analysis/"><code>analysis</code></a></li><li><a class="tocitem" href="../zz_array_allocation/"><code>array_allocation</code></a></li><li><a class="tocitem" href="../zz_bgk/"><code>bgk</code></a></li><li><a class="tocitem" href="../zz_calculus/"><code>calculus</code></a></li><li><a class="tocitem" href="../zz_charge_exchange/"><code>charge_exchange</code></a></li><li><a class="tocitem" href="../zz_chebyshev/"><code>chebyshev</code></a></li><li><a class="tocitem" href="../zz_clenshaw_curtis/"><code>clenshaw_curtis</code></a></li><li><a class="tocitem" href="../zz_command_line_options/"><code>command_line_options</code></a></li><li><a class="tocitem" href="../zz_communication/"><code>communication</code></a></li><li><a class="tocitem" href="../zz_constants/"><code>constants</code></a></li><li><a class="tocitem" href="../zz_continuity/"><code>continuity</code></a></li><li><a class="tocitem" href="../zz_coordinates/"><code>coordinates</code></a></li><li><a class="tocitem" href="../zz_debugging/"><code>debugging</code></a></li><li><a class="tocitem" href="../zz_derivatives/"><code>derivatives</code></a></li><li><a class="tocitem" href="../zz_em_fields/"><code>em_fields</code></a></li><li><a class="tocitem" href="../zz_energy_equation/"><code>energy_equation</code></a></li><li><a class="tocitem" href="../zz_external_sources/"><code>external_sources</code></a></li><li><a class="tocitem" href="../zz_file_io/"><code>file_io</code></a></li><li><a class="tocitem" href="../zz_finite_differences/"><code>finite_differences</code></a></li><li><a class="tocitem" href="../zz_fokker_planck/"><code>fokker_planck</code></a></li><li><a class="tocitem" href="../zz_fokker_planck_calculus/"><code>fokker_planck_calculus</code></a></li><li><a class="tocitem" href="../zz_fokker_planck_test/"><code>fokker_planck_test</code></a></li><li><a class="tocitem" href="../zz_force_balance/"><code>force_balance</code></a></li><li><a class="tocitem" href="../zz_gauss_legendre/"><code>gauss_legendre</code></a></li><li><a class="tocitem" href="../zz_geo/"><code>geo</code></a></li><li><a class="tocitem" href="../zz_initial_conditions/"><code>initial_conditions</code></a></li><li><a class="tocitem" href="../zz_input_structs/"><code>input_structs</code></a></li><li><a class="tocitem" href="../zz_interpolation/"><code>interpolation</code></a></li><li><a class="tocitem" href="../zz_ionization/"><code>ionization</code></a></li><li><a class="tocitem" href="../zz_krook_collisions/"><code>krook_collisions</code></a></li><li><a class="tocitem" href="../zz_load_data/"><code>load_data</code></a></li><li><a class="tocitem" href="../zz_looping/"><code>looping</code></a></li><li><a class="tocitem" href="../zz_makie_post_processing/"><code>makie_post_processing</code></a></li><li><a class="tocitem" href="../zz_manufactured_solns/"><code>manufactured_solns</code></a></li><li><a class="tocitem" href="../zz_moment_constraints/"><code>moment_constraints</code></a></li><li><a class="tocitem" href="../zz_moment_kinetics/"><code>moment_kinetics</code></a></li><li><a class="tocitem" href="../zz_moment_kinetics_input/"><code>moment_kinetics_input</code></a></li><li><a class="tocitem" href="../zz_moment_kinetics_structs/"><code>moment_kinetics_structs</code></a></li><li><a class="tocitem" href="../zz_neutral_r_advection/"><code>neutral_r_advection</code></a></li><li><a class="tocitem" href="../zz_neutral_vz_advection/"><code>neutral_vz_advection</code></a></li><li><a class="tocitem" href="../zz_neutral_z_advection/"><code>neutral_z_advection</code></a></li><li><a class="tocitem" href="../zz_numerical_dissipation/"><code>numerical_dissipation</code></a></li><li><a class="tocitem" href="../zz_plot_MMS_sequence/"><code>plot_MMS_sequence</code></a></li><li><a class="tocitem" href="../zz_plot_sequence/"><code>plot_sequence</code></a></li><li><a class="tocitem" href="../zz_plots_post_processing/"><code>plots_post_processing</code></a></li><li><a class="tocitem" href="../zz_quadrature/"><code>quadrature</code></a></li><li><a class="tocitem" href="../zz_r_advection/"><code>r_advection</code></a></li><li><a class="tocitem" href="../zz_reference_parameters/"><code>reference_parameters</code></a></li><li><a class="tocitem" href="../zz_runge_kutta/"><code>runge_kutta</code></a></li><li><a class="tocitem" href="../zz_source_terms/"><code>source_terms</code></a></li><li class="is-active"><a class="tocitem" href><code>time_advance</code></a></li><li><a class="tocitem" href="../zz_type_definitions/"><code>type_definitions</code></a></li><li><a class="tocitem" href="../zz_utils/"><code>utils</code></a></li><li><a class="tocitem" href="../zz_velocity_grid_transforms/"><code>velocity_grid_transforms</code></a></li><li><a class="tocitem" href="../zz_velocity_moments/"><code>velocity_moments</code></a></li><li><a class="tocitem" href="../zz_vpa_advection/"><code>vpa_advection</code></a></li><li><a class="tocitem" href="../zz_z_advection/"><code>z_advection</code></a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href><code>time_advance</code></a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href><code>time_advance</code></a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/mabarnes/moment_kinetics/blob/master/docs/src/zz_time_advance.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="time_advance"><a class="docs-heading-anchor" href="#time_advance"><code>time_advance</code></a><a id="time_advance-1"></a><a class="docs-heading-anchor-permalink" href="#time_advance" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="moment_kinetics.time_advance" href="#moment_kinetics.time_advance"><code>moment_kinetics.time_advance</code></a> — <span class="docstring-category">Module</span></header><section><div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/54a0773e1e5cda18c995dace7b4578db6eb599fb/moment_kinetics/src/time_advance.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="moment_kinetics.time_advance.adaptive_timestep_update!-NTuple{17, Any}" href="#moment_kinetics.time_advance.adaptive_timestep_update!-NTuple{17, Any}"><code>moment_kinetics.time_advance.adaptive_timestep_update!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">adaptive_timestep_update!(scratch, t_params, rk_coefs, moments, n_neutral_species)</code></pre><p>Check the error estimate for the embedded RK method and adjust the timestep if appropriate.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/54a0773e1e5cda18c995dace7b4578db6eb599fb/moment_kinetics/src/time_advance.jl#L1543-L1548">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="moment_kinetics.time_advance.euler_time_advance!-NTuple{27, Any}" href="#moment_kinetics.time_advance.euler_time_advance!-NTuple{27, Any}"><code>moment_kinetics.time_advance.euler_time_advance!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>euler<em>time</em>advance! advances the vector equation dfvec/dt = G[f] that includes the kinetic equation + any evolved moment equations using the forward Euler method: fvec<em>out = fvec</em>in + dt*fvec<em>in, with fvec</em>in an input and fvec_out the output</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/54a0773e1e5cda18c995dace7b4578db6eb599fb/moment_kinetics/src/time_advance.jl#L1965-L1970">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="moment_kinetics.time_advance.normalize_pdf!-Tuple{Any, Any, Any}" href="#moment_kinetics.time_advance.normalize_pdf!-Tuple{Any, Any, Any}"><code>moment_kinetics.time_advance.normalize_pdf!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>if evolving the density via continuity equation, redefine the normalised f → f/n if evolving the parallel pressure via energy equation, redefine f -&gt; f * vth / n &#39;scratch&#39; should be a (nz,nspecies) array</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/54a0773e1e5cda18c995dace7b4578db6eb599fb/moment_kinetics/src/time_advance.jl#L807-L811">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="moment_kinetics.time_advance.rk_update!-NTuple{27, Any}" href="#moment_kinetics.time_advance.rk_update!-NTuple{27, Any}"><code>moment_kinetics.time_advance.rk_update!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>use information obtained from the Runge-Kutta stages to compute the updated pdf; for the quantities (density, upar, ppar, vth, qpar and phi) that are derived from the &#39;true&#39;, un-modified pdf, either: update them using info from Runge Kutta stages, if the quantities are evolved separately from the modified pdf; or update them by taking the appropriate velocity moment of the evolved pdf</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/54a0773e1e5cda18c995dace7b4578db6eb599fb/moment_kinetics/src/time_advance.jl#L1364-L1370">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="moment_kinetics.time_advance.setup_advance_flags-NTuple{14, Any}" href="#moment_kinetics.time_advance.setup_advance_flags-NTuple{14, Any}"><code>moment_kinetics.time_advance.setup_advance_flags</code></a> — <span class="docstring-category">Method</span></header><section><div><p>create the &#39;advance_info&#39; struct to be used in later Euler advance to indicate which parts of the equations are to be advanced concurrently. if no splitting of operators, all terms advanced concurrently; else, will advance one term at a time.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/54a0773e1e5cda18c995dace7b4578db6eb599fb/moment_kinetics/src/time_advance.jl#L546-L551">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="moment_kinetics.time_advance.setup_scratch_arrays-NTuple{4, Any}" href="#moment_kinetics.time_advance.setup_scratch_arrays-NTuple{4, Any}"><code>moment_kinetics.time_advance.setup_scratch_arrays</code></a> — <span class="docstring-category">Method</span></header><section><div><p>create an array of structs containing scratch arrays for the normalised pdf and low-order moments that may be evolved separately via fluid equations</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/54a0773e1e5cda18c995dace7b4578db6eb599fb/moment_kinetics/src/time_advance.jl#L831-L834">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="moment_kinetics.time_advance.setup_time_advance!-NTuple{31, Any}" href="#moment_kinetics.time_advance.setup_time_advance!-NTuple{31, Any}"><code>moment_kinetics.time_advance.setup_time_advance!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>create arrays and do other work needed to setup the main time advance loop. this includes creating and populating structs for Chebyshev transforms, velocity space moments, EM fields, and advection terms</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/54a0773e1e5cda18c995dace7b4578db6eb599fb/moment_kinetics/src/time_advance.jl#L180-L186">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="moment_kinetics.time_advance.ssp_rk!-NTuple{29, Any}" href="#moment_kinetics.time_advance.ssp_rk!-NTuple{29, Any}"><code>moment_kinetics.time_advance.ssp_rk!</code></a> — <span class="docstring-category">Method</span></header><section><div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/54a0773e1e5cda18c995dace7b4578db6eb599fb/moment_kinetics/src/time_advance.jl#L1836">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="moment_kinetics.time_advance.time_advance!-NTuple{30, Any}" href="#moment_kinetics.time_advance.time_advance!-NTuple{30, Any}"><code>moment_kinetics.time_advance.time_advance!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>solve ∂f/∂t + v(z,t)⋅∂f/∂z + dvpa/dt ⋅ ∂f/∂vpa= 0 define approximate characteristic velocity v₀(z)=vⁿ(z) and take time derivative along this characteristic df/dt + δv⋅∂f/∂z = 0, with δv(z,t)=v(z,t)-v₀(z) for prudent choice of v₀, expect δv≪v so that explicit time integrator can be used without severe CFL condition</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/54a0773e1e5cda18c995dace7b4578db6eb599fb/moment_kinetics/src/time_advance.jl#L880-L887">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="moment_kinetics.time_advance.time_advance_no_splitting!-NTuple{29, Any}" href="#moment_kinetics.time_advance.time_advance_no_splitting!-NTuple{29, Any}"><code>moment_kinetics.time_advance.time_advance_no_splitting!</code></a> — <span class="docstring-category">Method</span></header><section><div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/54a0773e1e5cda18c995dace7b4578db6eb599fb/moment_kinetics/src/time_advance.jl#L1348">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="moment_kinetics.time_advance.time_advance_split_operators!-NTuple{18, Any}" href="#moment_kinetics.time_advance.time_advance_split_operators!-NTuple{18, Any}"><code>moment_kinetics.time_advance.time_advance_split_operators!</code></a> — <span class="docstring-category">Method</span></header><section><div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/54a0773e1e5cda18c995dace7b4578db6eb599fb/moment_kinetics/src/time_advance.jl#L1177">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="moment_kinetics.time_advance.update_derived_moments!-NTuple{13, Any}" href="#moment_kinetics.time_advance.update_derived_moments!-NTuple{13, Any}"><code>moment_kinetics.time_advance.update_derived_moments!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>update velocity moments that are calculable from the evolved charged pdf</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/54a0773e1e5cda18c995dace7b4578db6eb599fb/moment_kinetics/src/time_advance.jl#L1753-L1755">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="moment_kinetics.time_advance.update_derived_moments_neutral!-NTuple{8, Any}" href="#moment_kinetics.time_advance.update_derived_moments_neutral!-NTuple{8, Any}"><code>moment_kinetics.time_advance.update_derived_moments_neutral!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>update velocity moments that are calculable from the evolved neutral pdf</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/54a0773e1e5cda18c995dace7b4578db6eb599fb/moment_kinetics/src/time_advance.jl#L1813-L1815">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="moment_kinetics.time_advance.update_solution_vector!-NTuple{8, Any}" href="#moment_kinetics.time_advance.update_solution_vector!-NTuple{8, Any}"><code>moment_kinetics.time_advance.update_solution_vector!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>update the vector containing the pdf and any evolved moments of the pdf for use in the Runge-Kutta time advance</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mabarnes/moment_kinetics/blob/54a0773e1e5cda18c995dace7b4578db6eb599fb/moment_kinetics/src/time_advance.jl#L2178-L2181">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../zz_source_terms/">« <code>source_terms</code></a><a class="docs-footer-nextpage" href="../zz_type_definitions/"><code>type_definitions</code> »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Thursday 25 April 2024 14:51">Thursday 25 April 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
