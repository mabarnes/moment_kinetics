#runtime_plots = true
n_ion_species = 1
n_neutral_species = 1
electron_physics = "kinetic_electrons"
evolve_moments_density = true
evolve_moments_parallel_flow = true
evolve_moments_parallel_pressure = true
evolve_moments_conservation = true
recycling_fraction = 0.5
T_e = 1.0
T_wall = 0.1
initial_density1 = 1.0
initial_temperature1 = 1.0
z_IC_option1 = "sinusoid"
z_IC_density_amplitude1 = 0.1
z_IC_density_phase1 = 0.0
z_IC_upar_amplitude1 = 0.1
z_IC_upar_phase1 = 0.0
z_IC_temperature_amplitude1 = 0.1
z_IC_temperature_phase1 = 1.0
vpa_IC_option1 = "gaussian"
vpa_IC_density_amplitude1 = 1.0
vpa_IC_density_phase1 = 0.0
vpa_IC_upar_amplitude1 = 0.0
vpa_IC_upar_phase1 = 0.0
vpa_IC_temperature_amplitude1 = 0.0
vpa_IC_temperature_phase1 = 0.0
initial_density2 = 1.0
initial_temperature2 = 1.0
z_IC_option2 = "sinusoid"
z_IC_density_amplitude2 = 0.001
z_IC_density_phase2 = 0.0
z_IC_upar_amplitude2 = 0.0
z_IC_upar_phase2 = 0.0
z_IC_temperature_amplitude2 = 0.0
z_IC_temperature_phase2 = 0.0
vpa_IC_option2 = "gaussian"
vpa_IC_density_amplitude2 = 1.0
vpa_IC_density_phase2 = 0.0
vpa_IC_upar_amplitude2 = 0.0
vpa_IC_upar_phase2 = 0.0
vpa_IC_temperature_amplitude2 = 0.0
vpa_IC_temperature_phase2 = 0.0
charge_exchange_frequency = 0.75
ionization_frequency = 0.0
constant_ionization_rate = false
r_ngrid = 1
r_nelement = 1
z_ngrid = 5
z_nelement = 16
z_nelement_local = 2
z_bc = "periodic"
#z_discretization = "chebyshev_pseudospectral"
z_discretization = "gausslegendre_pseudospectral"
vpa_ngrid = 6
vpa_nelement = 31
vpa_L = 12.0
vpa_bc = "zero"
#vpa_discretization = "chebyshev_pseudospectral"
vpa_discretization = "gausslegendre_pseudospectral"
vpa_element_spacing_option = "coarse_tails"
vz_ngrid = 6
vz_nelement = 31
vz_L = 12.0
vz_bc = "zero"
#vz_discretization = "chebyshev_pseudospectral"
vz_discretization = "gausslegendre_pseudospectral"
vz_element_spacing_option = "coarse_tails"

[timestepping]
type = "PareschiRusso2(2,2,2)"
implicit_electron_advance = false
implicit_electron_ppar = true
implicit_ion_advance = false
implicit_vpa_advection = false
nstep = 500000
dt = 2.0e-4
#nwrite = 50
#nwrite_dfns = 50
nwrite = 5
nwrite_dfns = 5
steady_state_residual = true
converged_residual_value = 1.0e-3

[electron_timestepping]
nstep = 5000000
#nstep = 1
#dt = 2.0e-8
dt = 5.0e-5
maximum_dt = 1.0
nwrite = 10000
nwrite_dfns = 100000
#type = "SSPRK4"
type = "Fekete4(3)"
rtol = 1.0e-6
atol = 1.0e-14
minimum_dt = 1.0e-10
initialization_residual_value = 2.5
#converged_residual_value = 0.1 #1.0e-3
converged_residual_value = 1.0e-2
#debug_io = 10000
constraint_forcing_rate = 1.0e-4

[nonlinear_solver]
#nonlinear_max_iterations = 20 #100
nonlinear_max_iterations = 1000
rtol = 1.0e-8 #1.0e-5
atol = 1.0e-16
linear_restart = 5
preconditioner_update_interval = 100 #1000

[ion_numerical_dissipation]
vpa_dissipation_coefficient = 1.0e0
force_minimum_pdf_value = 0.0

[electron_numerical_dissipation]
vpa_dissipation_coefficient = 2.0
#vpa_dissipation_coefficient = 2.0e2
force_minimum_pdf_value = 0.0

[neutral_numerical_dissipation]
vz_dissipation_coefficient = 1.0e-1
force_minimum_pdf_value = 0.0

[krook_collisions]
use_krook = true

frequency_option = "reference_parameters"
nuee0 = 1000.0
nuei0 = 1000.0
